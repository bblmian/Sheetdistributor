{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\n// \nconst CFG_SN_COL_NAME = \"Wiz_Cfg_SN_Col\";\nconst CFG_AMT_COL_NAME = \"Wiz_Cfg_Amt_Col\";\nconst CFG_DATA_RANGE_NAME = \"Wiz_Cfg_Data_Range\";\nconst CFG_HEADER_ROW_NAME = \"Wiz_Cfg_Header_Row\";\n\n// \ninterface MainReportConfig {\n  dataRange: string; //  \"Sheet1!A1:E100\"\n  headerRow: number; // 1-based\n  snColumn: number; // S/N 0-based\n  amtColumn: number; // 0-based\n  sheetName: string; // \n}\n\n//  Excel  A-Z  AA-ZZ\nfunction getColumnName(columnIndex: number): string {\n  let result = \"\";\n  let index = columnIndex;\n  while (index >= 0) {\n    result = String.fromCharCode(65 + (index % 26)) + result;\n    index = Math.floor(index / 26) - 1;\n  }\n  return result;\n}\n\n//  Excel  \"A\" -> 0, \"Z\" -> 25, \"AA\" -> 26\nfunction getColumnIndexFromName(columnName: string): number {\n  let index = 0;\n  columnName = columnName.toUpperCase();\n  for (let i = 0; i < columnName.length; i++) {\n    index = index * 26 + (columnName.charCodeAt(i) - 64);\n  }\n  return index - 1;\n}\n\n//  NamedItem  \"=Sheet1!$A:$A\" -> \"A\"\nfunction parseColumnFromFormula(formula: string): string | null {\n  // =SheetName!$Column:$Column  =SheetName!Column:Column\n  const match = formula.match(/![\\$]?([A-Z]+)[\\$]?:[\\$]?[A-Z]+/i);\n  if (match && match[1]) {\n    return match[1].toUpperCase();\n  }\n  return null;\n}\n\n// \ninterface ReportInfo {\n  sheetName: string;\n  createTime: string;\n  rowCount: number;\n  totalAmount: number;\n}\n\n// \ninterface ColumnFilterSetting {\n  columnIndex: number;\n  columnName: string; //  \"A\", \"B\"\n  headerText: string; // \n  filterType: string; // \n  filterValues: string[]; // \n  isFiltered: boolean; // \n}\n\n// \ninterface FilterCondition {\n  id: string;\n  name: string;\n  createTime: string;\n  sheetName: string;\n  filterSettings: ColumnFilterSetting[]; // \n  config: MainReportConfig; // \n}\n\n//  Excel Add-in  localStorage \nlet reportsList: ReportInfo[] = [];\n\n// \nlet filterConditionsList: FilterCondition[] = [];\n\n// \nlet currentMainReportConfig: MainReportConfig | null = null;\n\n// \ninterface FilterFieldData {\n  columnIndex: number;\n  headerText: string;\n  allValues: string[]; // \n  selectedValues: Set<string>; // \n}\n\n// \nlet filterPanelFields: FilterFieldData[] = [];\n\n// \nfunction showMessage(message: string, isError: boolean = false): void {\n  const messageArea = document.getElementById(\"message-area\");\n  if (messageArea) {\n    messageArea.textContent = message;\n    messageArea.className = isError ? \"message-area error\" : \"message-area success\";\n  }\n  console.log(message);\n}\n\n// \nfunction showProgress(title: string, message: string): void {\n  const overlay = document.getElementById(\"progress-overlay\");\n  const titleEl = document.getElementById(\"progress-title\");\n  const messageEl = document.getElementById(\"progress-message\");\n  const barEl = document.getElementById(\"progress-bar\");\n  const detailEl = document.getElementById(\"progress-detail\");\n  \n  if (overlay && titleEl && messageEl && barEl && detailEl) {\n    titleEl.textContent = title;\n    messageEl.textContent = message;\n    barEl.style.width = \"0%\";\n    detailEl.textContent = \"\";\n    overlay.classList.add(\"show\");\n  }\n}\n\n// \nfunction updateProgress(current: number, total: number, detail?: string): void {\n  const barEl = document.getElementById(\"progress-bar\");\n  const detailEl = document.getElementById(\"progress-detail\");\n  \n  if (barEl && detailEl) {\n    const percent = total > 0 ? Math.round((current / total) * 100) : 0;\n    barEl.style.width = `${percent}%`;\n    detailEl.textContent = detail || `${current} / ${total}`;\n  }\n}\n\n// \nfunction hideProgress(): void {\n  const overlay = document.getElementById(\"progress-overlay\");\n  if (overlay) {\n    overlay.classList.remove(\"show\");\n  }\n}\n\n// \nfunction appendDebugLog(message: string): void {\n  const debugLog = document.getElementById(\"debug-log\");\n  if (debugLog) {\n    const logEntry = document.createElement(\"div\");\n    logEntry.textContent = message;\n    logEntry.style.marginBottom = \"2px\";\n    debugLog.appendChild(logEntry);\n    // \n    debugLog.scrollTop = debugLog.scrollHeight;\n  }\n  console.log(message);\n}\n\n// \nfunction generateFilterText(): string {\n  const filterItems: string[] = [];\n  \n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      const valuesArray = Array.from(field.selectedValues);\n      const valuesText = valuesArray.length > 5 \n        ? valuesArray.slice(0, 5).join(\"\") + `...${valuesArray.length}`\n        : valuesArray.join(\"\");\n      filterItems.push(`${field.headerText}${valuesText}`);\n    }\n  }\n  \n  if (filterItems.length === 0) {\n    return \"\";\n  }\n  \n  return filterItems.join(\"\\n\");\n}\n\n// \nfunction updateFilterTextDisplay(autoHide: boolean = false): void {\n  const container = document.getElementById(\"filter-text-container\");\n  const content = document.getElementById(\"filter-text-content\");\n  \n  if (!container || !content) return;\n  \n  const filterText = generateFilterText();\n  \n  if (filterText === \"\" && autoHide) {\n    container.style.display = \"none\";\n    return;\n  }\n  \n  // \n  container.style.display = \"block\";\n  \n  //  HTML \n  const htmlContent = filterText.split(\"\\n\").map(line => {\n    //   \n    const match = line.match(/(.+?)(.+)/);\n    if (match) {\n      return `<span class=\"field-name\">${match[1]}</span><span class=\"field-value\">${match[2]}</span>`;\n    }\n    return line;\n  }).join(\"<br>\");\n  \n  content.innerHTML = htmlContent;\n}\n\n// \nasync function copyFilterTextToClipboard(): Promise<boolean> {\n  const filterText = generateFilterText();\n  \n  if (filterText === \"\") {\n    return false;\n  }\n  \n  try {\n    await navigator.clipboard.writeText(filterText);\n    showCopySuccessHint();\n    return true;\n  } catch (error) {\n    console.error(\":\", error);\n    // \n    try {\n      const textArea = document.createElement(\"textarea\");\n      textArea.value = filterText;\n      textArea.style.position = \"fixed\";\n      textArea.style.left = \"-9999px\";\n      document.body.appendChild(textArea);\n      textArea.select();\n      document.execCommand(\"copy\");\n      document.body.removeChild(textArea);\n      showCopySuccessHint();\n      return true;\n    } catch (fallbackError) {\n      console.error(\":\", fallbackError);\n      return false;\n    }\n  }\n}\n\n// \nfunction showCopySuccessHint(): void {\n  const hint = document.getElementById(\"copy-success-hint\");\n  if (hint) {\n    hint.classList.add(\"show\");\n    setTimeout(() => {\n      hint.classList.remove(\"show\");\n    }, 2000);\n  }\n}\n\n// \nfunction bindFilterTextEvents(): void {\n  const content = document.getElementById(\"filter-text-content\");\n  if (content) {\n    content.addEventListener(\"click\", async () => {\n      await copyFilterTextToClipboard();\n    });\n  }\n}\n\n// \nfunction clearDebugLog(): void {\n  const debugLog = document.getElementById(\"debug-log\");\n  if (debugLog) {\n    debugLog.innerHTML = \"\";\n  }\n}\n\n// \nfunction cleanAmount(value: any): number {\n  if (value === null || value === undefined || value === \"\") {\n    return 0;\n  }\n  \n  // \n  if (typeof value === \"number\") {\n    return isNaN(value) ? 0 : value;\n  }\n  \n  // \n  let str = String(value).trim();\n  \n  // 0\n  if (str === \"\") {\n    return 0;\n  }\n  \n  //  RMBCNY \n  str = str.replace(/RMB|CNY|USD|EUR|GBP/gi, \"\");\n  \n  //  $\n  str = str.replace(/[$]/g, \"\");\n  \n  // \n  str = str.replace(/[,]/g, \"\");\n  \n  // \n  str = str.replace(/\\s+/g, \"\");\n  \n  // \n  const isNegative = str.startsWith(\"-\");\n  if (isNegative) {\n    str = str.substring(1);\n  }\n  \n  // \n  str = str.replace(/[^\\d.]/g, \"\");\n  \n  // \n  const dotIndex = str.indexOf(\".\");\n  if (dotIndex !== -1) {\n    str = str.substring(0, dotIndex + 1) + str.substring(dotIndex + 1).replace(/\\./g, \"\");\n  }\n  \n  // \n  const num = parseFloat(str);\n  const result = isNaN(num) ? 0 : (isNegative ? -num : num);\n  \n  return result;\n}\n\n// \nasync function setDataRange(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n      \n      // \n      const selection = context.workbook.getSelectedRange();\n      if (!selection) {\n        showMessage(\"\", true);\n        return;\n      }\n      \n      selection.load(\"address, rowIndex, columnIndex, rowCount, columnCount\");\n      await context.sync();\n      \n      // \n      let address = selection.address;\n      \n      // \n      let sheetNameInAddress = \"\";\n      if (address.includes(\"!\")) {\n        const parts = address.split(\"!\");\n        if (parts.length > 1) {\n          sheetNameInAddress = parts[0].replace(/^'|'$/g, \"\");\n          address = parts[1];\n        }\n      }\n      \n      //  $ \n      // \n      if (!address.includes(\"$\")) {\n        // \n        const startRow = selection.rowIndex + 1;\n        const startCol = selection.columnIndex;\n        const endRow = startRow + selection.rowCount - 1;\n        const endCol = startCol + selection.columnCount - 1;\n        \n        const startColName = getColumnName(startCol);\n        const endColName = getColumnName(endCol);\n        \n        address = `$${startColName}$${startRow}:$${endColName}$${endRow}`;\n      }\n      \n      // \n      const currentSheetName = sheet.name;\n      // \n      const sheetNameEscaped = currentSheetName.includes(\" \") || currentSheetName.includes(\"-\") || currentSheetName.includes(\"'\")\n        ? `'${currentSheetName.replace(/'/g, \"''\")}'` \n        : currentSheetName;\n      \n      const fullAddress = `${sheetNameEscaped}!${address}`;\n      \n      //  NamedItem\n      const namedItems = context.workbook.names;\n      \n      // \n      try {\n        const existingItem = namedItems.getItem(CFG_DATA_RANGE_NAME);\n        existingItem.delete();\n        await context.sync();\n      } catch (error) {\n        // \n      }\n      \n      //  NamedItem = \n      const formula = `=${fullAddress}`;\n      \n      // \n      appendDebugLog(` NamedItem: ${CFG_DATA_RANGE_NAME}`);\n      appendDebugLog(`: ${formula}`);\n      appendDebugLog(`: ${fullAddress}`);\n      \n      try {\n        namedItems.add(CFG_DATA_RANGE_NAME, formula);\n        await context.sync();\n      } catch (addError) {\n        console.error(\" NamedItem :\", addError);\n        appendDebugLog(`: ${addError.message}`);\n        throw addError;\n      }\n      \n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: fullAddress,\n          headerRow: 0,\n          snColumn: 0,\n          amtColumn: 0,\n          sheetName: currentSheetName\n        };\n      } else {\n        currentMainReportConfig.dataRange = fullAddress;\n        currentMainReportConfig.sheetName = currentSheetName;\n      }\n      \n      updateMainReportConfigDisplay();\n      showMessage(`: ${address}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function setHeaderRow(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n      \n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"rowIndex\");\n      \n      await context.sync();\n      \n      const rowIndex = selection.rowIndex + 1; //  1-based\n      \n      //  NamedItem\n      const namedItems = context.workbook.names;\n      try {\n        const existingItem = namedItems.getItem(CFG_HEADER_ROW_NAME);\n        existingItem.delete();\n        await context.sync();\n      } catch (error) {\n        // \n      }\n      \n      const rowAddress = `${sheet.name}!${rowIndex}:${rowIndex}`;\n      namedItems.add(CFG_HEADER_ROW_NAME, `=${rowAddress}`);\n      await context.sync();\n      \n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: rowIndex,\n          snColumn: 0,\n          amtColumn: 0,\n          sheetName: sheet.name\n        };\n      } else {\n        currentMainReportConfig.headerRow = rowIndex;\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n      \n      updateMainReportConfigDisplay();\n      showMessage(`:  ${rowIndex} `);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// SN\nasync function setColumnConfig(columnName: string, displayName: string): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n      \n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"address, columnIndex\");\n      \n      await context.sync();\n      \n      // \n      if (!selection.address) {\n        showMessage(` Excel ${displayName}`, true);\n        return;\n      }\n      \n      //  selection  columnIndex\n      const columnIndex = selection.columnIndex;\n      const columnNameStr = getColumnName(columnIndex);\n      \n      //  NamedItem\n      const namedItems = context.workbook.names;\n      \n      // \n      try {\n        const existingItem = namedItems.getItemOrNullObject(columnName);\n        await context.sync();\n        if (!existingItem.isNullObject) {\n          existingItem.delete();\n          await context.sync();\n        }\n      } catch (error) {\n        // \n        console.log(\" NamedItem :\", error);\n      }\n      \n      //  NamedItem\n      //  Excel \n      const cellAddress = `='${sheet.name}'!$${columnNameStr}$1`;\n      namedItems.add(columnName, cellAddress);\n      \n      await context.sync();\n      \n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: 0,\n          snColumn: columnName === CFG_SN_COL_NAME ? columnIndex : 0,\n          amtColumn: columnName === CFG_AMT_COL_NAME ? columnIndex : 0,\n          sheetName: sheet.name\n        };\n      } else {\n        if (columnName === CFG_SN_COL_NAME) {\n          currentMainReportConfig.snColumn = columnIndex;\n        } else if (columnName === CFG_AMT_COL_NAME) {\n          currentMainReportConfig.amtColumn = columnIndex;\n        }\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n      \n      showMessage(`${displayName} ${columnIndex + 1}  (${columnNameStr})`);\n      \n      // \n      updateMainReportConfigDisplay();\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`${displayName}: ${error.message}`, true);\n  }\n}\n\n// SN\n// \ninterface MergeCellInfo {\n  address: string;      //  \"A5:A6\"\n  startRow: number;     // 0-based\n  endRow: number;       // 0-based\n  columnIndex: number;  // \n}\n\nasync function setSnColumnWithMergeCheck(): Promise<void> {\n  try {\n    // \n    showMessage(\"...\", false);\n    \n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n      \n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"address, columnIndex\");\n      \n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex, columnCount, address\");\n      \n      await context.sync();\n      \n      const columnIndex = selection.columnIndex;\n      const columnNameStr = getColumnName(columnIndex);\n      const startRow = usedRange.rowIndex;\n      const rowCount = usedRange.rowCount;\n      const totalColumns = usedRange.columnCount;\n      \n      console.log(` ${columnNameStr} : ${startRow+1}${startRow+rowCount}`);\n      \n      // \n      if (rowCount > 500) {\n        showMessage(` ${rowCount} ...`, false);\n      }\n      \n      //  - \n      const columnRange = sheet.getRangeByIndexes(startRow, columnIndex, rowCount, 1);\n      columnRange.load(\"values\");\n      await context.sync();\n      \n      const values = columnRange.values;\n      console.log(` ${values.length} `);\n      \n      // =====  =====\n      //  null\n      //  API \n      \n      const mergedCellInfos: MergeCellInfo[] = [];\n      let i = 0;\n      \n      while (i < rowCount) {\n        const currentValue = values[i][0];\n        \n        //  null null\n        if (currentValue !== null && currentValue !== undefined) {\n          let consecutiveNulls = 0;\n          for (let k = i + 1; k < rowCount; k++) {\n            const nextValue = values[k][0];\n            if (nextValue === null) {\n              consecutiveNulls++;\n            } else {\n              break;\n            }\n          }\n          \n          if (consecutiveNulls > 0) {\n            // \n            const cellRowIndex = startRow + i;\n            const mergeRowCount = consecutiveNulls + 1;\n            const endRowIndex = cellRowIndex + mergeRowCount - 1;\n            const address = `${columnNameStr}${cellRowIndex + 1}:${columnNameStr}${endRowIndex + 1}`;\n            \n            console.log(`: ${address}, ${mergeRowCount}`);\n            \n            mergedCellInfos.push({\n              address: address,\n              startRow: cellRowIndex,\n              endRow: endRowIndex,\n              columnIndex: columnIndex\n            });\n            \n            i += mergeRowCount;\n          } else {\n            i++;\n          }\n        } else {\n          //  null null \n          i++;\n        }\n      }\n      \n      console.log(` ${mergedCellInfos.length} `);\n      \n      // \n      if (mergedCellInfos.length > 0) {\n        showMessage(` ${mergedCellInfos.length} `, false);\n        \n        // \n        const confirmHighlight = await showConfirmDialog(\n          ` ${columnIndex + 1}  (${columnNameStr})  ${mergedCellInfos.length} \\n\\n`\n        );\n        \n        if (confirmHighlight) {\n          // \n          for (const info of mergedCellInfos) {\n            const mergeRange = sheet.getRange(info.address);\n            mergeRange.format.fill.color = \"#FFFF00\";\n          }\n          await context.sync();\n          showMessage(` ${mergedCellInfos.length} `);\n        }\n        \n        // \n        const confirmMerge = await showConfirmDialog(\n          `\\n\\n\\n \\n \\n \\n \\n `\n        );\n        \n        if (confirmMerge) {\n          // \n          showProgress(\"\", ` ${mergedCellInfos.length} ...`);\n          \n          // \n          const sortedInfos = mergedCellInfos.sort((a, b) => b.startRow - a.startRow);\n          let deletedRows = 0;\n          const totalInfos = sortedInfos.length;\n          \n          // =====  =====\n          // \n          let minRow = Infinity;\n          let maxRow = 0;\n          for (const info of sortedInfos) {\n            minRow = Math.min(minRow, info.startRow);\n            maxRow = Math.max(maxRow, info.endRow);\n          }\n          \n          // \n          const allDataRange = sheet.getRangeByIndexes(minRow, 0, maxRow - minRow + 1, totalColumns);\n          allDataRange.load(\"values\");\n          await context.sync();\n          const allData = allDataRange.values;\n          \n          updateProgress(0, totalInfos, \"...\");\n          \n          // \n          interface MergeResult {\n            firstRowIndex: number;\n            mergedValues: (string | number | boolean | null)[];\n            rowsToDelete: number;\n          }\n          const mergeResults: MergeResult[] = [];\n          \n          // \n          for (let idx = 0; idx < sortedInfos.length; idx++) {\n            const info = sortedInfos[idx];\n            const rowsToMerge = info.endRow - info.startRow + 1;\n            if (rowsToMerge < 2) continue;\n            \n            const firstRowIndex = info.startRow;\n            const dataOffset = firstRowIndex - minRow;\n            \n            // \n            const mergedValues = allData[dataOffset].slice();\n            \n            // \n            for (let rowOffset = 1; rowOffset < rowsToMerge; rowOffset++) {\n              const currentDataOffset = dataOffset + rowOffset;\n              if (currentDataOffset >= allData.length) break;\n              \n              const currentRowValues = allData[currentDataOffset];\n              \n              for (let col = 0; col < totalColumns; col++) {\n                const firstVal = String(mergedValues[col] || \"\").trim();\n                const currentVal = String(currentRowValues[col] || \"\").trim();\n                \n                if (currentVal && currentVal !== firstVal) {\n                  if (firstVal) {\n                    mergedValues[col] = firstVal + \"\\n\" + currentVal;\n                  } else {\n                    mergedValues[col] = currentVal;\n                  }\n                }\n              }\n            }\n            \n            mergeResults.push({\n              firstRowIndex,\n              mergedValues,\n              rowsToDelete: rowsToMerge - 1\n            });\n          }\n          \n          // =====  =====\n          // \n          const BATCH_SIZE = 20;\n          \n          for (let batchStart = 0; batchStart < mergeResults.length; batchStart += BATCH_SIZE) {\n            const batchEnd = Math.min(batchStart + BATCH_SIZE, mergeResults.length);\n            const batchResults = mergeResults.slice(batchStart, batchEnd);\n            \n            updateProgress(batchStart, mergeResults.length, ` ${batchStart + 1}-${batchEnd}/${mergeResults.length}`);\n            \n            // 1. \n            for (const result of batchResults) {\n              const info = sortedInfos.find(i => i.startRow === result.firstRowIndex);\n              if (info) {\n                const mergeRange = sheet.getRange(info.address);\n                mergeRange.unmerge();\n              }\n            }\n            await context.sync();\n            \n            // 2. \n            for (const result of batchResults) {\n              const firstRowRange = sheet.getRangeByIndexes(result.firstRowIndex, 0, 1, totalColumns);\n              firstRowRange.values = [result.mergedValues];\n              firstRowRange.format.wrapText = true;\n              firstRowRange.format.fill.color = \"#F5F5F5\";\n            }\n            await context.sync();\n            \n            // 3. \n            for (const result of batchResults) {\n              for (let i = result.rowsToDelete; i > 0; i--) {\n                const rowToDelete = sheet.getRangeByIndexes(result.firstRowIndex + i, 0, 1, totalColumns);\n                rowToDelete.delete(Excel.DeleteShiftDirection.up);\n                deletedRows++;\n              }\n            }\n            await context.sync();\n          }\n          \n          // \n          hideProgress();\n          \n          showMessage(` ${mergedCellInfos.length}  ${deletedRows} `);\n        }\n      }\n      \n      // SN\n      const namedItems = context.workbook.names;\n      \n      try {\n        const existingItem = namedItems.getItem(CFG_SN_COL_NAME);\n        existingItem.delete();\n        await context.sync();\n      } catch (error) {\n        // \n      }\n      \n      const columnAddress = `='${sheet.name}'!$${columnNameStr}:$${columnNameStr}`;\n      namedItems.add(CFG_SN_COL_NAME, columnAddress);\n      \n      await context.sync();\n      \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: 0,\n          snColumn: columnIndex,\n          amtColumn: 0,\n          sheetName: sheet.name\n        };\n      } else {\n        currentMainReportConfig.snColumn = columnIndex;\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n      \n      const mergeInfo = mergedCellInfos.length > 0 ? ` ( ${mergedCellInfos.length} )` : \"\";\n      showMessage(` S/N  ${columnIndex + 1}  (${columnNameStr})${mergeInfo}`);\n      \n      updateMainReportConfigDisplay();\n    });\n  } catch (error) {\n    console.error(\"SN:\", error);\n    showMessage(` S/N : ${error.message}`, true);\n  }\n}\n\n// \nfunction updateMainReportConfigDisplay(): void {\n  // \n  const dataRangeEl = document.getElementById(\"data-range-info\");\n  if (dataRangeEl) {\n    if (currentMainReportConfig && currentMainReportConfig.dataRange) {\n      dataRangeEl.textContent = currentMainReportConfig.dataRange;\n      dataRangeEl.className = \"step-value clickable\";\n      dataRangeEl.title = \"\";\n    } else {\n      dataRangeEl.textContent = \"\";\n      dataRangeEl.className = \"step-value not-configured\";\n      dataRangeEl.title = \"\";\n    }\n  }\n  \n  // \n  const headerRowEl = document.getElementById(\"header-row-info\");\n  if (headerRowEl) {\n    if (currentMainReportConfig && currentMainReportConfig.headerRow > 0) {\n      headerRowEl.textContent = ` ${currentMainReportConfig.headerRow} `;\n      headerRowEl.className = \"step-value\";\n    } else {\n      headerRowEl.textContent = \"\";\n      headerRowEl.className = \"step-value not-configured\";\n    }\n  }\n  \n  //  S/N \n  const snColEl = document.getElementById(\"sn-col-info\");\n  if (snColEl) {\n    if (currentMainReportConfig && currentMainReportConfig.snColumn >= 0) {\n      const colName = getColumnName(currentMainReportConfig.snColumn);\n      snColEl.textContent = ` ${currentMainReportConfig.snColumn + 1}  (${colName})`;\n      snColEl.className = \"step-value\";\n    } else {\n      snColEl.textContent = \"\";\n      snColEl.className = \"step-value not-configured\";\n    }\n  }\n  \n  // \n  const amtColEl = document.getElementById(\"amt-col-info\");\n  if (amtColEl) {\n    if (currentMainReportConfig && currentMainReportConfig.amtColumn >= 0) {\n      const colName = getColumnName(currentMainReportConfig.amtColumn);\n      amtColEl.textContent = ` ${currentMainReportConfig.amtColumn + 1}  (${colName})`;\n      amtColEl.className = \"step-value\";\n    } else {\n      amtColEl.textContent = \"\";\n      amtColEl.className = \"step-value not-configured\";\n    }\n  }\n  \n  // \n  const enableFilterBtn = document.getElementById(\"btn-enable-filter\") as HTMLButtonElement;\n  if (enableFilterBtn) {\n    const isConfigComplete = currentMainReportConfig && \n      currentMainReportConfig.dataRange && \n      currentMainReportConfig.headerRow > 0 &&\n      currentMainReportConfig.snColumn >= 0 &&\n      currentMainReportConfig.amtColumn >= 0;\n    enableFilterBtn.disabled = !isConfigComplete;\n  }\n}\n\n// \nasync function updateColumnConfigDisplay(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      \n      //  S/N \n      const snInfoEl = document.getElementById(\"sn-col-info\");\n      try {\n        const snNamedItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        snNamedItem.load(\"formula\");\n        const snRange = snNamedItem.getRange();\n        snRange.load(\"columnIndex\");\n        await context.sync();\n        \n        const snColName = getColumnName(snRange.columnIndex);\n        if (snInfoEl) {\n          snInfoEl.textContent = ` ${snRange.columnIndex + 1}  (${snColName})`;\n          snInfoEl.className = \"config-value\";\n        }\n      } catch (error) {\n        if (snInfoEl) {\n          snInfoEl.textContent = \"\";\n          snInfoEl.className = \"config-value not-configured\";\n        }\n      }\n      \n      // \n      const amtInfoEl = document.getElementById(\"amt-col-info\");\n      try {\n        const amtNamedItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        amtNamedItem.load(\"formula\");\n        const amtRange = amtNamedItem.getRange();\n        amtRange.load(\"columnIndex\");\n        await context.sync();\n        \n        const amtColName = getColumnName(amtRange.columnIndex);\n        if (amtInfoEl) {\n          amtInfoEl.textContent = ` ${amtRange.columnIndex + 1}  (${amtColName})`;\n          amtInfoEl.className = \"config-value\";\n        }\n      } catch (error) {\n        if (amtInfoEl) {\n          amtInfoEl.textContent = \"\";\n          amtInfoEl.className = \"config-value not-configured\";\n        }\n      }\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nfunction updateReportsTable(): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n  \n  let html = \"\";\n  \n  // \n  if (currentMainReportConfig && currentMainReportConfig.sheetName) {\n    html += `\n      <tr class=\"main-report-row\">\n        <td>\n          <span class=\"main-report-link\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Home\" style=\"margin-right: 4px; font-size: 10px;\"></i>${currentMainReportConfig.sheetName}\n          </span>\n        </td>\n        <td><span class=\"main-report-badge\"></span></td>\n        <td></td>\n      </tr>\n    `;\n  }\n  \n  if (reportsList.length === 0 && !currentMainReportConfig?.sheetName) {\n    tbody.innerHTML = '<tr><td colspan=\"3\" class=\"no-reports\"></td></tr>';\n    return;\n  }\n  \n  html += reportsList.map((report, index) => {\n    const createTime = new Date(report.createTime).toLocaleString(\"zh-CN\", { \n      month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\" \n    });\n    return `\n      <tr>\n        <td>\n          <span class=\"report-name-display\" data-index=\"${index}\" data-sheet-name=\"${report.sheetName}\" title=\"\">${report.sheetName}</span>\n          <div class=\"report-name-edit-container\" style=\"display: none;\">\n            <input type=\"text\" class=\"report-name-input\" data-index=\"${index}\" value=\"${report.sheetName}\">\n            <i class=\"ms-Icon ms-Icon--ReturnKey edit-hint-icon\" title=\"\"></i>\n          </div>\n        </td>\n        <td>${createTime}</td>\n        <td>\n          <button class=\"icon-button-small danger\" data-index=\"${index}\" data-sheet-name=\"${report.sheetName}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Delete\"></i>\n          </button>\n        </td>\n      </tr>\n    `;\n  }).join(\"\");\n  \n  tbody.innerHTML = html;\n  \n  // \n  tbody.querySelectorAll(\".main-report-link\").forEach(link => {\n    link.addEventListener(\"click\", () => {\n      goToMainReport();\n    });\n  });\n  \n  // \n  tbody.querySelectorAll(\".report-name-display\").forEach(span => {\n    span.addEventListener(\"click\", (e) => {\n      const sheetName = (e.target as HTMLElement).getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        navigateToSheet(sheetName);\n      }\n    });\n    \n    // \n    span.addEventListener(\"dblclick\", (e) => {\n      const target = e.target as HTMLElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      startEditReportName(index);\n    });\n  });\n  \n  // \n  tbody.querySelectorAll(\".report-name-input\").forEach(input => {\n    // \n    input.addEventListener(\"keydown\", (e) => {\n      const keyEvent = e as KeyboardEvent;\n      if (keyEvent.key === \"Enter\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        confirmEditReportName(index, target.value);\n      } else if (keyEvent.key === \"Escape\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        cancelEditReportName(index);\n      }\n    });\n    \n    // \n    input.addEventListener(\"blur\", (e) => {\n      const target = e.target as HTMLInputElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      // \n      setTimeout(() => {\n        cancelEditReportName(index);\n      }, 200);\n    });\n  });\n  \n  // \n  tbody.querySelectorAll(\".icon-button-small.danger\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      //  currentTarget  target target \n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      const sheetName = btn.getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        deleteReport(index, sheetName);\n      }\n    });\n  });\n}\n\n// \nfunction startEditReportName(index: number): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n  \n  // \n  const displaySpan = tbody.querySelector(`.report-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".report-name-edit-container\") as HTMLElement;\n  const input = editContainer?.querySelector(\".report-name-input\") as HTMLInputElement;\n  \n  if (displaySpan && editContainer && input) {\n    displaySpan.style.display = \"none\";\n    editContainer.style.display = \"flex\";\n    input.focus();\n    input.select();\n  }\n}\n\n// \nfunction cancelEditReportName(index: number): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n  \n  const displaySpan = tbody.querySelector(`.report-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".report-name-edit-container\") as HTMLElement;\n  \n  if (displaySpan && editContainer) {\n    displaySpan.style.display = \"inline\";\n    editContainer.style.display = \"none\";\n  }\n}\n\n// \nasync function confirmEditReportName(index: number, newName: string): Promise<void> {\n  if (index < 0 || index >= reportsList.length) return;\n  \n  const oldName = reportsList[index].sheetName;\n  newName = newName.trim();\n  \n  if (!newName || newName === oldName) {\n    cancelEditReportName(index);\n    return;\n  }\n  \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(oldName);\n      sheet.name = newName;\n      await context.sync();\n      \n      // \n      reportsList[index].sheetName = newName;\n      \n      // \n      updateReportsTable();\n      \n      showMessage(`: ${newName}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n    cancelEditReportName(index);\n  }\n}\n\n// \nasync function navigateToSheet(sheetName: string): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(sheetName);\n      sheet.activate();\n      await context.sync();\n      showMessage(`: ${sheetName}`);\n    });\n  } catch (error) {\n    showMessage(`:  \"${sheetName}\"`, true);\n  }\n}\n\n// \nfunction showConfirmDialog(message: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    const overlay = document.getElementById(\"confirm-dialog\");\n    const messageEl = document.getElementById(\"confirm-dialog-message\");\n    const okButton = document.getElementById(\"confirm-dialog-ok\");\n    const cancelButton = document.getElementById(\"confirm-dialog-cancel\");\n    \n    if (!overlay || !messageEl || !okButton || !cancelButton) {\n      resolve(false);\n      return;\n    }\n    \n    messageEl.textContent = message;\n    overlay.classList.add(\"show\");\n    \n    const cleanup = () => {\n      overlay.classList.remove(\"show\");\n      okButton.removeEventListener(\"click\", onOk);\n      cancelButton.removeEventListener(\"click\", onCancel);\n    };\n    \n    const onOk = () => {\n      cleanup();\n      resolve(true);\n    };\n    \n    const onCancel = () => {\n      cleanup();\n      resolve(false);\n    };\n    \n    okButton.addEventListener(\"click\", onOk);\n    cancelButton.addEventListener(\"click\", onCancel);\n  });\n}\n\n// \nasync function deleteReport(index: number, sheetName: string): Promise<void> {\n  const confirmed = await showConfirmDialog(` \"${sheetName}\" `);\n  \n  if (!confirmed) {\n    return;\n  }\n  \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      try {\n        const sheet = workbook.worksheets.getItem(sheetName);\n        sheet.delete();\n        await context.sync();\n        \n        // \n        reportsList.splice(index, 1);\n        updateReportsTable();\n        showMessage(`: ${sheetName}`);\n      } catch (error) {\n        // \n        reportsList.splice(index, 1);\n        updateReportsTable();\n        showMessage(` \"${sheetName}\" `);\n      }\n    });\n  } catch (error) {\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction addReportToList(sheetName: string, rowCount: number, totalAmount: number): void {\n  const report: ReportInfo = {\n    sheetName: sheetName,\n    createTime: new Date().toISOString(),\n    rowCount: rowCount,\n    totalAmount: totalAmount\n  };\n  \n  reportsList.unshift(report); // \n  updateReportsTable();\n}\n\n\n// \nfunction updateFilterConditionsList(): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n  \n  if (filterConditionsList.length === 0) {\n    container.innerHTML = '<div class=\"no-filters\"></div>';\n    return;\n  }\n  \n  container.innerHTML = filterConditionsList.map((filter, index) => {\n    const createTime = new Date(filter.createTime).toLocaleString(\"zh-CN\", { \n      month: \"2-digit\", \n      day: \"2-digit\", \n      hour: \"2-digit\", \n      minute: \"2-digit\" \n    });\n    \n    // \n    const filterSummary = filter.filterSettings.map(f => f.headerText).join(\", \");\n    \n    return `\n      <div class=\"filter-condition-item\">\n        <div class=\"filter-condition-info\">\n          <span class=\"filter-name-display\" data-index=\"${index}\" title=\" | ${filterSummary}\">${filter.name}</span>\n          <div class=\"filter-name-edit-container\" style=\"display: none;\">\n            <input type=\"text\" class=\"filter-name-input\" data-index=\"${index}\" value=\"${filter.name}\">\n            <i class=\"ms-Icon ms-Icon--ReturnKey edit-hint-icon\" title=\"\"></i>\n          </div>\n          <span class=\"filter-condition-time\">${createTime}</span>\n        </div>\n        <div class=\"filter-condition-actions\">\n          <button class=\"icon-button-small apply-filter-btn\" data-index=\"${index}\" data-sheet-name=\"${filter.sheetName}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Play\"></i>\n          </button>\n          <button class=\"icon-button-small danger delete-filter-btn\" data-index=\"${index}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Delete\"></i>\n          </button>\n        </div>\n      </div>\n    `;\n  }).join(\"\");\n  \n  // \n  container.querySelectorAll(\".filter-name-display\").forEach(span => {\n    span.addEventListener(\"dblclick\", (e) => {\n      const target = e.target as HTMLElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      startEditFilterName(index);\n    });\n  });\n  \n  // \n  container.querySelectorAll(\".filter-name-input\").forEach(input => {\n    // \n    input.addEventListener(\"keydown\", (e) => {\n      const keyEvent = e as KeyboardEvent;\n      if (keyEvent.key === \"Enter\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        confirmEditFilterName(index, target.value);\n      } else if (keyEvent.key === \"Escape\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        cancelEditFilterName(index);\n      }\n    });\n    \n    // \n    input.addEventListener(\"blur\", (e) => {\n      const target = e.target as HTMLInputElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      setTimeout(() => {\n        cancelEditFilterName(index);\n      }, 200);\n    });\n  });\n  \n  // \n  container.querySelectorAll(\".apply-filter-btn\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      const sheetName = btn.getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        applyFilterCondition(index, sheetName);\n      }\n    });\n  });\n  \n  // \n  container.querySelectorAll(\".delete-filter-btn\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      deleteFilterCondition(index);\n    });\n  });\n}\n\n// \nfunction startEditFilterName(index: number): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n  \n  const displaySpan = container.querySelector(`.filter-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".filter-name-edit-container\") as HTMLElement;\n  const input = editContainer?.querySelector(\".filter-name-input\") as HTMLInputElement;\n  \n  if (displaySpan && editContainer && input) {\n    displaySpan.style.display = \"none\";\n    editContainer.style.display = \"flex\";\n    input.focus();\n    input.select();\n  }\n}\n\n// \nfunction cancelEditFilterName(index: number): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n  \n  const displaySpan = container.querySelector(`.filter-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".filter-name-edit-container\") as HTMLElement;\n  \n  if (displaySpan && editContainer) {\n    displaySpan.style.display = \"inline\";\n    editContainer.style.display = \"none\";\n  }\n}\n\n// \nfunction confirmEditFilterName(index: number, newName: string): void {\n  if (index < 0 || index >= filterConditionsList.length) return;\n  \n  newName = newName.trim();\n  const oldName = filterConditionsList[index].name;\n  \n  if (!newName || newName === oldName) {\n    cancelEditFilterName(index);\n    return;\n  }\n  \n  // \n  filterConditionsList[index].name = newName;\n  \n  // \n  updateFilterConditionsList();\n  \n  showMessage(`: ${newName}`);\n}\n\n// \nasync function applyFilterCondition(index: number, sheetName: string): Promise<void> {\n  if (index < 0 || index >= filterConditionsList.length) {\n    showMessage(\"\", true);\n    return;\n  }\n  \n  const filterCondition = filterConditionsList[index];\n  \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      \n      // \n      const sheet = workbook.worksheets.getItem(filterCondition.config.sheetName);\n      sheet.activate();\n      sheet.load(\"name\");\n      \n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"values, rowCount, columnCount, address, rowIndex\");\n      await context.sync();\n      \n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n      \n      // usedRange.rowIndex  0-based 0\n      const startRow = usedRange.rowIndex + 1; //  1-based Excel \n      const endRow = startRow + usedRange.rowCount - 1;\n      \n      // \n      currentMainReportConfig = {\n        dataRange: usedRange.address,\n        headerRow: startRow,\n        snColumn: filterCondition.config.snColumn,\n        amtColumn: filterCondition.config.amtColumn,\n        sheetName: sheet.name\n      };\n      \n      // \n      const headerRow = usedRange.values[0];\n      filterPanelFields = [];\n      \n      for (let colIdx = 0; colIdx < usedRange.columnCount; colIdx++) {\n        const headerText = headerRow[colIdx] ? String(headerRow[colIdx]) : getColumnName(colIdx);\n        const allValues = new Set<string>();\n        \n        for (let rowIdx = 1; rowIdx < usedRange.values.length; rowIdx++) {\n          const cellValue = usedRange.values[rowIdx][colIdx];\n          const valueStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n          if (valueStr !== \"\") {\n            allValues.add(valueStr);\n          }\n        }\n        \n        const sortedValues = Array.from(allValues).sort((a, b) => a.localeCompare(b, \"zh-CN\"));\n        \n        // \n        const savedFilter = filterCondition.filterSettings.find(f => f.columnIndex === colIdx);\n        \n        // \n        let selectedValues: Set<string>;\n        if (savedFilter && savedFilter.isFiltered) {\n          selectedValues = new Set<string>(savedFilter.filterValues.filter(v => allValues.has(v)));\n        } else {\n          selectedValues = new Set<string>(sortedValues);\n        }\n        \n        filterPanelFields.push({\n          columnIndex: colIdx,\n          headerText: headerText,\n          allValues: sortedValues,\n          selectedValues: selectedValues\n        });\n      }\n      \n      // \n      renderFilterPanel();\n      \n      // \n      const applyBtn = document.getElementById(\"btn-apply-filter\") as HTMLButtonElement;\n      const clearBtn = document.getElementById(\"btn-clear-filter\") as HTMLButtonElement;\n      const saveBtn = document.getElementById(\"btn-save-filter\") as HTMLButtonElement;\n      const generateBtn = document.getElementById(\"btn-generate\") as HTMLButtonElement;\n      const resetBtn = document.getElementById(\"btn-reset-filter\") as HTMLButtonElement;\n      if (applyBtn) applyBtn.disabled = false;\n      if (clearBtn) clearBtn.disabled = false;\n      if (saveBtn) saveBtn.disabled = false;\n      if (generateBtn) generateBtn.disabled = false;\n      if (resetBtn) resetBtn.disabled = false;\n      \n      // \n      const dataStartRow = startRow + 1;\n      for (let excelRow = dataStartRow; excelRow <= endRow; excelRow++) {\n        const row = sheet.getRange(`${excelRow}:${excelRow}`);\n        row.rowHidden = false;\n      }\n      await context.sync();\n      \n      //  - \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n      \n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n      \n      // \n      if (filterEntries.length === 0) {\n        updateCurrentFilterDisplay([]);\n        showMessage(\"\");\n        return;\n      }\n      \n      // \n      let hiddenCount = 0;\n      let visibleCount = 0;\n      \n      for (let valueIdx = 1; valueIdx < usedRange.values.length; valueIdx++) {\n        const rowData = usedRange.values[valueIdx];\n        const excelRowNum = startRow + valueIdx; //  Excel \n        let shouldHide = false;\n        \n        for (const filter of filterEntries) {\n          if (filter.colIdx < rowData.length) {\n            const cellValue = rowData[filter.colIdx];\n            const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n            \n            if (!filter.allowedValues.has(cellStr)) {\n              shouldHide = true;\n              break;\n            }\n          }\n        }\n        \n        if (shouldHide) {\n          const row = sheet.getRange(`${excelRowNum}:${excelRowNum}`);\n          row.rowHidden = true;\n          hiddenCount++;\n        } else {\n          visibleCount++;\n        }\n      }\n      \n      await context.sync();\n      \n      // \n      const filterSettings: ColumnFilterSetting[] = filterEntries.map(f => ({\n        columnIndex: f.colIdx,\n        columnName: getColumnName(f.colIdx),\n        headerText: f.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(f.allowedValues),\n        isFiltered: true\n      }));\n      \n      updateCurrentFilterDisplay(filterSettings);\n      \n      // \n      const filterSummary = filterEntries.map(f => `${f.headerText}(${f.allowedValues.size})`).join(\", \");\n      showMessage(`: ${filterSummary} | ${visibleCount}, ${hiddenCount}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    appendDebugLog(`: ${error.message}`);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction updateCurrentFilterDisplay(filterSettings: ColumnFilterSetting[]): void {\n  const container = document.getElementById(\"current-filter-display\");\n  if (!container) return;\n  \n  const activeFilters = filterSettings.filter(f => f.isFiltered);\n  \n  if (activeFilters.length === 0) {\n    container.innerHTML = '<div class=\"no-filters\"></div>';\n    return;\n  }\n  \n  container.innerHTML = `\n    <div class=\"current-filter-title\"></div>\n    <div class=\"current-filter-items\">\n      ${activeFilters.map(filter => `\n        <div class=\"current-filter-item\">\n          <span class=\"filter-field\">${filter.headerText}</span>\n          <span class=\"filter-separator\"></span>\n          <span class=\"filter-value\">${filter.filterValues.join(\", \")}</span>\n        </div>\n      `).join(\"\")}\n    </div>\n  `;\n}\n\n// \nfunction refreshCurrentFilterDisplay(): void {\n  const container = document.getElementById(\"current-filter-display\");\n  if (!container) return;\n  \n  // \n  const columnFilterSettings: ColumnFilterSetting[] = [];\n  \n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      const selectedValuesArray = Array.from(field.selectedValues);\n      \n      // 5\n      let displayValues: string[];\n      if (selectedValuesArray.length <= 5) {\n        displayValues = selectedValuesArray;\n      } else {\n        displayValues = selectedValuesArray.slice(0, 5);\n        displayValues.push(`... (${selectedValuesArray.length})`);\n      }\n      \n      columnFilterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: displayValues,\n        isFiltered: true\n      });\n    }\n  }\n  \n  // \n  if (columnFilterSettings.length > 0) {\n    updateCurrentFilterDisplay(columnFilterSettings);\n  } else if (filterPanelFields.length > 0) {\n    // \n    container.innerHTML = '<div class=\"no-filters\"></div>';\n  } else {\n    // \n    container.innerHTML = '<div class=\"no-filters\">\"\"</div>';\n  }\n}\n\n// \nfunction deleteFilterCondition(index: number): void {\n  if (index >= 0 && index < filterConditionsList.length) {\n    filterConditionsList.splice(index, 1);\n    updateFilterConditionsList();\n    showMessage(\"\");\n  }\n}\n\n// \nasync function enableFilter(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const activeSheet = workbook.worksheets.getActiveWorksheet();\n      activeSheet.load(\"name\");\n      \n      // \n      const usedRange = activeSheet.getUsedRange();\n      usedRange.load(\"values, rowCount, columnCount, address\");\n      await context.sync();\n      \n      if (!usedRange.values || usedRange.values.length < 2) {\n        showMessage(\"\", true);\n        return;\n      }\n      \n      // \n      const headerRow = usedRange.values[0];\n      \n      // \n      currentMainReportConfig = {\n        dataRange: usedRange.address,\n        headerRow: 1,\n        snColumn: currentMainReportConfig?.snColumn || 0,\n        amtColumn: currentMainReportConfig?.amtColumn || 0,\n        sheetName: activeSheet.name\n      };\n      \n      // \n      filterPanelFields = [];\n      \n      // \n      for (let colIdx = 0; colIdx < usedRange.columnCount; colIdx++) {\n        const headerText = headerRow[colIdx] ? String(headerRow[colIdx]) : getColumnName(colIdx);\n        const allValues = new Set<string>();\n        \n        // \n        for (let rowIdx = 1; rowIdx < usedRange.values.length; rowIdx++) {\n          const cellValue = usedRange.values[rowIdx][colIdx];\n          const valueStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n          if (valueStr !== \"\") {\n            allValues.add(valueStr);\n          }\n        }\n        \n        //  Set \n        const sortedValues = Array.from(allValues).sort((a, b) => a.localeCompare(b, \"zh-CN\"));\n        \n        filterPanelFields.push({\n          columnIndex: colIdx,\n          headerText: headerText,\n          allValues: sortedValues,\n          selectedValues: new Set<string>(sortedValues) // \n        });\n      }\n      \n      // \n      renderFilterPanel();\n      \n      // \n      const applyBtn = document.getElementById(\"btn-apply-filter\") as HTMLButtonElement;\n      const clearBtn = document.getElementById(\"btn-clear-filter\") as HTMLButtonElement;\n      const saveBtn = document.getElementById(\"btn-save-filter\") as HTMLButtonElement;\n      const generateBtn = document.getElementById(\"btn-generate\") as HTMLButtonElement;\n      const resetBtn = document.getElementById(\"btn-reset-filter\") as HTMLButtonElement;\n      if (applyBtn) applyBtn.disabled = false;\n      if (clearBtn) clearBtn.disabled = false;\n      if (saveBtn) saveBtn.disabled = false;\n      if (generateBtn) generateBtn.disabled = false;\n      if (resetBtn) resetBtn.disabled = false;\n      \n      // \n      updateMainReportConfigDisplay();\n      \n      showMessage(` ${filterPanelFields.length} `);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \n// \nlet activeFilterFieldIndex: number = -1;\n\nfunction renderFilterPanel(): void {\n  const panel = document.getElementById(\"filter-panel\");\n  if (!panel) return;\n  \n  if (filterPanelFields.length === 0) {\n    panel.innerHTML = '<div class=\"filter-panel-hint\">\"\"</div>';\n    return;\n  }\n  \n  // \n  let tagsHtml = '<div class=\"filter-tags-container\">';\n  \n  for (let i = 0; i < filterPanelFields.length; i++) {\n    const field = filterPanelFields[i];\n    const selectedCount = field.selectedValues.size;\n    const totalCount = field.allValues.length;\n    const isFiltered = selectedCount < totalCount;\n    const isActive = i === activeFilterFieldIndex;\n    \n    let tagClass = \"filter-tag\";\n    if (isFiltered) tagClass += \" filtered\";\n    if (isActive) tagClass += \" active\";\n    \n    tagsHtml += `\n      <div class=\"${tagClass}\" data-field-index=\"${i}\">\n        <span class=\"filter-tag-name\">${escapeHtml(field.headerText)}</span>\n        <span class=\"filter-tag-count\">${isFiltered ? selectedCount + '/' : ''}${totalCount}</span>\n      </div>\n    `;\n  }\n  \n  tagsHtml += '</div>';\n  \n  // \n  let dropdownHtml = '';\n  \n  if (activeFilterFieldIndex >= 0 && activeFilterFieldIndex < filterPanelFields.length) {\n    const field = filterPanelFields[activeFilterFieldIndex];\n    const fieldId = `filter-field-${activeFilterFieldIndex}`;\n    \n    dropdownHtml = `\n      <div class=\"filter-dropdown show\" data-field-index=\"${activeFilterFieldIndex}\">\n        <div class=\"filter-dropdown-header\">\n          <span class=\"filter-dropdown-title\">${escapeHtml(field.headerText)} </span>\n          <button class=\"filter-dropdown-close\" id=\"btn-close-dropdown\"></button>\n        </div>\n        <input type=\"text\" class=\"filter-field-search\" placeholder=\"...\" \n               id=\"${fieldId}-search\" data-field-index=\"${activeFilterFieldIndex}\">\n        <div class=\"filter-options-container\" id=\"${fieldId}-options\">\n    `;\n    \n    for (let j = 0; j < field.allValues.length; j++) {\n      const value = field.allValues[j];\n      const isSelected = field.selectedValues.has(value);\n      const displayValue = value.length > 40 ? value.substring(0, 40) + \"...\" : value;\n      \n      dropdownHtml += `\n        <div class=\"filter-option ${isSelected ? 'selected' : ''}\" \n             data-field-index=\"${activeFilterFieldIndex}\" data-value-index=\"${j}\" data-value=\"${escapeHtml(value)}\">\n          <input type=\"checkbox\" ${isSelected ? 'checked' : ''} \n                 id=\"${fieldId}-opt-${j}\" data-field-index=\"${activeFilterFieldIndex}\" data-value=\"${escapeHtml(value)}\">\n          <span class=\"filter-option-label\" title=\"${escapeHtml(value)}\">${escapeHtml(displayValue)}</span>\n        </div>\n      `;\n    }\n    \n    dropdownHtml += `\n        </div>\n        <div class=\"filter-select-actions\" id=\"${fieldId}-actions\">\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"all\"></button>\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"none\"></button>\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"invert\"></button>\n        </div>\n        <div class=\"filter-search-hint\" id=\"${fieldId}-search-hint\" style=\"display: none;\">\n          <i class=\"ms-Icon ms-Icon--Info\" aria-hidden=\"true\"></i>\n          <span></span>\n        </div>\n      </div>\n    `;\n  }\n  \n  panel.innerHTML = tagsHtml + dropdownHtml;\n  \n  //  panel \n}\n\n// HTML \nfunction escapeHtml(text: string): string {\n  const div = document.createElement(\"div\");\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n// \nlet filterPanelEventsBound = false;\n\n// \nfunction bindFilterPanelEvents(): void {\n  const panel = document.getElementById(\"filter-panel\");\n  if (!panel || filterPanelEventsBound) return;\n  \n  filterPanelEventsBound = true;\n  console.log(\"[] \");\n  \n  // \n  panel.addEventListener(\"click\", (e) => {\n    const target = e.target as HTMLElement;\n    \n    // 1.  - \n    const tagElement = target.closest(\".filter-tag\") as HTMLElement;\n    if (tagElement) {\n      const fieldIndex = parseInt(tagElement.getAttribute(\"data-field-index\") || \"-1\", 10);\n      \n      if (fieldIndex === activeFilterFieldIndex) {\n        activeFilterFieldIndex = -1;\n      } else {\n        activeFilterFieldIndex = fieldIndex;\n      }\n      \n      renderFilterPanel();\n      return;\n    }\n    \n    // 2. \n    if (target.id === \"btn-close-dropdown\" || target.closest(\"#btn-close-dropdown\")) {\n      activeFilterFieldIndex = -1;\n      renderFilterPanel();\n      return;\n    }\n    \n    // 3. //\n    const actionButton = target.closest(\".filter-select-action\") as HTMLElement;\n    if (actionButton) {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      const fieldIndex = parseInt(actionButton.getAttribute(\"data-field-index\") || \"0\", 10);\n      const action = actionButton.getAttribute(\"data-action\");\n      \n      console.log(`[] action=${action}, fieldIndex=${fieldIndex}`);\n      \n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        const field = filterPanelFields[fieldIndex];\n        \n        // \n        const searchInput = document.getElementById(`filter-field-${fieldIndex}-search`) as HTMLInputElement;\n        const searchText = searchInput ? searchInput.value.trim() : \"\";\n        const isSearchMode = searchText.length > 0;\n        \n        console.log(`[] isSearchMode=${isSearchMode}, searchText=\"${searchText}\"`);\n        console.log(`[]  selectedValues.size=${field.selectedValues.size}, allValues.length=${field.allValues.length}`);\n        \n        if (isSearchMode) {\n          // \n          const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n          const visibleValues: string[] = [];\n          if (optionsContainer) {\n            const options = optionsContainer.querySelectorAll(\".filter-option:not(.hidden)\");\n            options.forEach((option) => {\n              const valueIndexStr = option.getAttribute(\"data-value-index\");\n              const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n              const value = valueIndex >= 0 && valueIndex < field.allValues.length \n                ? field.allValues[valueIndex] \n                : option.getAttribute(\"data-value\") || \"\";\n              visibleValues.push(value);\n            });\n          }\n          \n          console.log(`[] : ${visibleValues.length}`);\n          \n          if (action === \"all\") {\n            for (const v of visibleValues) {\n              field.selectedValues.add(v);\n            }\n          } else if (action === \"none\") {\n            for (const v of visibleValues) {\n              field.selectedValues.delete(v);\n            }\n          } else if (action === \"invert\") {\n            for (const v of visibleValues) {\n              if (field.selectedValues.has(v)) {\n                field.selectedValues.delete(v);\n              } else {\n                field.selectedValues.add(v);\n              }\n            }\n          }\n        } else {\n          // \n          console.log(`[]  ${field.allValues.length} `);\n          \n          if (action === \"all\") {\n            field.selectedValues = new Set<string>(field.allValues);\n          } else if (action === \"none\") {\n            field.selectedValues = new Set<string>();\n          } else if (action === \"invert\") {\n            const newSelected = new Set<string>();\n            for (const v of field.allValues) {\n              if (!field.selectedValues.has(v)) {\n                newSelected.add(v);\n              }\n            }\n            console.log(`[]  ${field.selectedValues.size}  ${newSelected.size} `);\n            field.selectedValues = newSelected;\n          }\n        }\n        \n        console.log(`[]  selectedValues.size=${field.selectedValues.size}`);\n        \n        // \n        updateFieldOptions(fieldIndex);\n        // \n        updateTagCount(fieldIndex);\n      }\n      return;\n    }\n    \n    // 4. \n    const optionDiv = target.closest(\".filter-option\") as HTMLElement;\n    if (optionDiv && target.tagName !== \"INPUT\") {\n      const fieldIndex = parseInt(optionDiv.getAttribute(\"data-field-index\") || \"0\", 10);\n      const checkbox = optionDiv.querySelector(\"input[type='checkbox']\") as HTMLInputElement;\n      \n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length && checkbox) {\n        const field = filterPanelFields[fieldIndex];\n        \n        //  data-value-index \n        const valueIndexStr = optionDiv.getAttribute(\"data-value-index\");\n        const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n        const value = valueIndex >= 0 && valueIndex < field.allValues.length \n          ? field.allValues[valueIndex] \n          : optionDiv.getAttribute(\"data-value\") || \"\";\n        \n        // \n        const newChecked = !checkbox.checked;\n        checkbox.checked = newChecked;\n        \n        if (newChecked) {\n          field.selectedValues.add(value);\n        } else {\n          field.selectedValues.delete(value);\n        }\n        \n        //  selected \n        optionDiv.classList.toggle(\"selected\", newChecked);\n        \n        // \n        updateTagCount(fieldIndex);\n      }\n      return;\n    }\n  });\n  \n  // \n  panel.addEventListener(\"input\", (e) => {\n    const target = e.target as HTMLInputElement;\n    if (target.classList.contains(\"filter-field-search\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"0\", 10);\n      filterSearchOptions(fieldIndex, target.value);\n    }\n  });\n  \n  //  change \n  panel.addEventListener(\"change\", (e) => {\n    const target = e.target as HTMLInputElement;\n    if (target.type === \"checkbox\" && target.closest(\".filter-option\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"0\", 10);\n      \n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        const field = filterPanelFields[fieldIndex];\n        \n        //  data-value-index \n        const optionDiv = target.closest(\".filter-option\") as HTMLElement;\n        let value = target.getAttribute(\"data-value\") || \"\";\n        if (optionDiv) {\n          const valueIndexStr = optionDiv.getAttribute(\"data-value-index\");\n          const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n          if (valueIndex >= 0 && valueIndex < field.allValues.length) {\n            value = field.allValues[valueIndex];\n          }\n        }\n        \n        if (target.checked) {\n          field.selectedValues.add(value);\n        } else {\n          field.selectedValues.delete(value);\n        }\n        \n        //  selected \n        if (optionDiv) {\n          optionDiv.classList.toggle(\"selected\", target.checked);\n        }\n        \n        // \n        updateTagCount(fieldIndex);\n      }\n    }\n  });\n}\n\n// \nfunction updateTagCount(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  if (!field) return;\n  \n  const tag = document.querySelector(`.filter-tag[data-field-index=\"${fieldIndex}\"]`);\n  if (!tag) return;\n  \n  const selectedCount = field.selectedValues.size;\n  const totalCount = field.allValues.length;\n  const isFiltered = selectedCount < totalCount;\n  \n  // \n  tag.classList.toggle(\"filtered\", isFiltered);\n  \n  // \n  const countSpan = tag.querySelector(\".filter-tag-count\");\n  if (countSpan) {\n    countSpan.textContent = isFiltered ? `${selectedCount}/${totalCount}` : `${totalCount}`;\n  }\n}\n\n// \nfunction filterSearchOptions(fieldIndex: number, searchText: string): void {\n  const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n  const actionsContainer = document.getElementById(`filter-field-${fieldIndex}-actions`);\n  const searchHint = document.getElementById(`filter-field-${fieldIndex}-search-hint`);\n  if (!optionsContainer) return;\n  \n  const options = optionsContainer.querySelectorAll(\".filter-option\");\n  const searchLower = searchText.toLowerCase().trim();\n  const hasSearchText = searchLower.length > 0;\n  \n  let visibleCount = 0;\n  options.forEach((option) => {\n    const value = option.getAttribute(\"data-value\") || \"\";\n    const matches = value.toLowerCase().includes(searchLower);\n    option.classList.toggle(\"hidden\", !matches);\n    if (matches) visibleCount++;\n  });\n  \n  // \n  if (actionsContainer) {\n    actionsContainer.classList.toggle(\"search-mode\", hasSearchText);\n  }\n  if (searchHint) {\n    searchHint.style.display = hasSearchText ? \"flex\" : \"none\";\n    // \n    const hintSpan = searchHint.querySelector(\"span\");\n    if (hintSpan && hasSearchText) {\n      hintSpan.textContent = `${visibleCount} `;\n    }\n  }\n}\n\n// /\nfunction updateFieldOptions(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n  if (!optionsContainer || !field) return;\n  \n  const options = optionsContainer.querySelectorAll(\".filter-option\");\n  options.forEach((option) => {\n    //  data-value-index  HTML \n    const valueIndexStr = option.getAttribute(\"data-value-index\");\n    const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n    const value = valueIndex >= 0 && valueIndex < field.allValues.length \n      ? field.allValues[valueIndex] \n      : option.getAttribute(\"data-value\") || \"\";\n    \n    const isSelected = field.selectedValues.has(value);\n    const checkbox = option.querySelector(\"input[type='checkbox']\") as HTMLInputElement;\n    if (checkbox) {\n      checkbox.checked = isSelected;\n    }\n    option.classList.toggle(\"selected\", isSelected);\n  });\n  \n  console.log(`[updateFieldOptions] fieldIndex=${fieldIndex},  ${options.length} `);\n}\n\n// \nfunction updateFieldCountDisplay(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  const fieldGroup = document.querySelector(`[data-field-index=\"${fieldIndex}\"].filter-field-group`);\n  if (!fieldGroup || !field) return;\n  \n  const label = fieldGroup.querySelector(\".filter-field-label\");\n  if (label) {\n    const selectedCount = field.selectedValues.size;\n    const totalCount = field.allValues.length;\n    const isFiltered = selectedCount < totalCount;\n    \n    label.innerHTML = `\n      ${field.headerText} \n      <span style=\"font-weight: normal; color: ${isFiltered ? '#0078d4' : '#605e5c'};\">\n        (${selectedCount}/${totalCount})\n      </span>\n    `;\n  }\n}\n\n//  Excel\nasync function applyFilterFromPanel(): Promise<void> {\n  if (filterPanelFields.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n  \n  // \n  showMessage(\"...\", false);\n  \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      let targetSheet: Excel.Worksheet;\n      \n      if (currentMainReportConfig) {\n        targetSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n      } else {\n        targetSheet = workbook.worksheets.getActiveWorksheet();\n      }\n      \n      targetSheet.activate();\n      \n      // \n      const usedRange = targetSheet.getUsedRange();\n      usedRange.load(\"values, rowCount, rowIndex, columnCount\");\n      await context.sync();\n      \n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n      \n      const startRow = usedRange.rowIndex; // 0-based\n      const rowCount = usedRange.rowCount;\n      const columnCount = usedRange.columnCount;\n      \n      // \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n      \n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n      \n      // =====  =====\n      const rowVisibility: boolean[] = []; // true = , false = \n      rowVisibility.push(true); // \n      \n      let visibleCount = 0;\n      let hiddenCount = 0;\n      \n      // \n      for (let valueIdx = 1; valueIdx < usedRange.values.length; valueIdx++) {\n        const rowData = usedRange.values[valueIdx];\n        let shouldShow = true;\n        \n        if (filterEntries.length > 0) {\n          for (const filter of filterEntries) {\n            if (filter.colIdx < rowData.length) {\n              const cellValue = rowData[filter.colIdx];\n              const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n              \n              if (!filter.allowedValues.has(cellStr)) {\n                shouldShow = false;\n                break;\n              }\n            }\n          }\n        }\n        \n        rowVisibility.push(shouldShow);\n        if (shouldShow) {\n          visibleCount++;\n        } else {\n          hiddenCount++;\n        }\n      }\n      \n      // =====  =====\n      // \n      const allDataRowsStart = startRow + 2; // Excel \n      const allDataRowsEnd = startRow + rowCount;\n      if (allDataRowsEnd >= allDataRowsStart) {\n        const allDataRows = targetSheet.getRange(`${allDataRowsStart}:${allDataRowsEnd}`);\n        allDataRows.rowHidden = false;\n      }\n      await context.sync();\n      \n      // \n      // \n      let i = 1; // \n      let hiddenRangeCount = 0;\n      while (i < rowVisibility.length) {\n        if (!rowVisibility[i]) {\n          // \n          let endIdx = i;\n          \n          // \n          while (endIdx + 1 < rowVisibility.length && !rowVisibility[endIdx + 1]) {\n            endIdx++;\n          }\n          \n          // \n          const rangeStartRow = startRow + i + 1; // Excel  (1-based)\n          const rangeEndRow = startRow + endIdx + 1;\n          const range = targetSheet.getRange(`${rangeStartRow}:${rangeEndRow}`);\n          range.rowHidden = true;\n          hiddenRangeCount++;\n          \n          i = endIdx + 1;\n        } else {\n          i++;\n        }\n      }\n      \n      await context.sync();\n      \n      // \n      appendDebugLog(`:  ${hiddenRangeCount} ,  ${hiddenCount} `);\n      appendDebugLog(`: Excel  ${startRow + 1} ,  ${rowCount} `);\n      \n      // =====  =====\n      // \n      const dataRange = targetSheet.getRangeByIndexes(startRow + 1, 0, rowCount - 1, columnCount);\n      dataRange.format.rowHeight = 20; //  20 \n      await context.sync();\n      \n      // \n      const filterSettings: ColumnFilterSetting[] = filterEntries.map(f => ({\n        columnIndex: f.colIdx,\n        columnName: getColumnName(f.colIdx),\n        headerText: f.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(f.allowedValues),\n        isFiltered: true\n      }));\n      \n      updateCurrentFilterDisplay(filterSettings);\n      \n      // \n      updateFilterTextDisplay();\n      await copyFilterTextToClipboard();\n      \n      // \n      const filterSummary = filterEntries.map(f => {\n        const count = f.allowedValues.size;\n        return `${f.headerText}(${count})`;\n      }).join(\", \");\n      \n      showMessage(`: ${filterSummary} | ${visibleCount}, ${hiddenCount}`);\n      appendDebugLog(`: ${filterSummary}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function clearFilterFromPanel(): Promise<void> {\n  // \n  for (const field of filterPanelFields) {\n    field.selectedValues = new Set<string>(field.allValues);\n  }\n  \n  // \n  renderFilterPanel();\n  \n  // \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      let targetSheet: Excel.Worksheet;\n      \n      if (currentMainReportConfig) {\n        targetSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n      } else {\n        targetSheet = workbook.worksheets.getActiveWorksheet();\n      }\n      \n      const usedRange = targetSheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex, columnCount\");\n      await context.sync();\n      \n      // \n      const dataRowCount = usedRange.rowCount - 1;\n      if (dataRowCount > 0) {\n        const startRowNum = usedRange.rowIndex + 2; // Excel \n        const endRowNum = usedRange.rowIndex + usedRange.rowCount;\n        const allDataRows = targetSheet.getRange(`${startRowNum}:${endRowNum}`);\n        allDataRows.rowHidden = false;\n        \n        // \n        allDataRows.format.rowHeight = 20;\n      }\n      await context.sync();\n      \n      updateCurrentFilterDisplay([]);\n      \n      // \n      const filterTextContainer = document.getElementById(\"filter-text-container\");\n      if (filterTextContainer) {\n        filterTextContainer.style.display = \"none\";\n      }\n      \n      showMessage(\"\");\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction saveFilterFromPanel(): void {\n  if (filterPanelFields.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n  \n  // \n  const filterSettings: ColumnFilterSetting[] = [];\n  \n  for (const field of filterPanelFields) {\n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      filterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(field.selectedValues),\n        isFiltered: true\n      });\n    }\n  }\n  \n  if (filterSettings.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n  \n  // \n  const filterCondition: FilterCondition = {\n    id: `filter_${Date.now()}`,\n    name: `_${new Date().toLocaleString(\"zh-CN\", { month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\" })}`,\n    createTime: new Date().toISOString(),\n    sheetName: currentMainReportConfig?.sheetName || \"\",\n    filterSettings: filterSettings,\n    config: currentMainReportConfig ? { ...currentMainReportConfig } : {\n      dataRange: \"\",\n      headerRow: 1,\n      snColumn: 0,\n      amtColumn: 0,\n      sheetName: \"\"\n    }\n  };\n  \n  filterConditionsList.unshift(filterCondition);\n  updateFilterConditionsList();\n  \n  const filterSummary = filterSettings.map(f => `${f.headerText}(${f.filterValues.length})`).join(\", \");\n  showMessage(`: ${filterSummary}`);\n}\n\n// \nasync function saveCurrentFilterCondition(): Promise<void> {\n  // \n  const columnFilterSettings: ColumnFilterSetting[] = [];\n  \n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      columnFilterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(field.selectedValues),\n        isFiltered: true\n      });\n      \n      appendDebugLog(` - ${field.headerText}: ${field.selectedValues.size}/${field.allValues.length}`);\n    }\n  }\n  \n  // \n  if (columnFilterSettings.length === 0) {\n    appendDebugLog(\"\");\n    return;\n  }\n  \n  // \n  const filterCondition: FilterCondition = {\n    id: `filter_${Date.now()}`,\n    name: `_${new Date().toLocaleString(\"zh-CN\", { month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\" })}`,\n    createTime: new Date().toISOString(),\n    sheetName: currentMainReportConfig?.sheetName || \"\",\n    filterSettings: columnFilterSettings,\n    config: currentMainReportConfig ? { ...currentMainReportConfig } : {\n      dataRange: \"\",\n      headerRow: 1,\n      snColumn: 0,\n      amtColumn: 0,\n      sheetName: \"\"\n    }\n  };\n  \n  filterConditionsList.unshift(filterCondition);\n  updateFilterConditionsList();\n  refreshCurrentFilterDisplay();\n  \n  const filterCount = columnFilterSettings.length;\n  appendDebugLog(`: ${filterCount} `);\n}\n\n// \nasync function goToMainReport(): Promise<void> {\n  if (!currentMainReportConfig || !currentMainReportConfig.sheetName) {\n    showMessage(\"\", true);\n    return;\n  }\n  \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      sheet.activate();\n      \n      // \n      const firstCell = sheet.getRange(\"A1\");\n      firstCell.select();\n      \n      await context.sync();\n      showMessage(`: ${currentMainReportConfig!.sheetName}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function resetFilterAndGoToMainReport(): Promise<void> {\n  if (!currentMainReportConfig || !currentMainReportConfig.sheetName) {\n    showMessage(\"\", true);\n    return;\n  }\n  \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      sheet.activate();\n      \n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex\");\n      await context.sync();\n      \n      // \n      const dataRowCount = usedRange.rowCount - 1;\n      if (dataRowCount > 0) {\n        const startRowNum = usedRange.rowIndex + 2; // \n        const endRowNum = usedRange.rowIndex + usedRange.rowCount;\n        const allDataRows = sheet.getRange(`${startRowNum}:${endRowNum}`);\n        allDataRows.rowHidden = false;\n        \n        // \n        allDataRows.format.rowHeight = 20;\n      }\n      \n      // \n      const firstCell = sheet.getRange(\"A1\");\n      firstCell.select();\n      \n      await context.sync();\n      \n      // \n      for (const field of filterPanelFields) {\n        field.selectedValues = new Set<string>(field.allValues);\n      }\n      \n      // \n      activeFilterFieldIndex = -1;\n      renderFilterPanel();\n      refreshCurrentFilterDisplay();\n      \n      // \n      const filterTextContainer = document.getElementById(\"filter-text-container\");\n      if (filterTextContainer) {\n        filterTextContainer.style.display = \"none\";\n      }\n      \n      showMessage(\"\");\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function generateReport(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      \n      // \n      let sourceSheet: Excel.Worksheet;\n      let usingMainReport = false;\n      if (currentMainReportConfig && currentMainReportConfig.sheetName) {\n        sourceSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n        usingMainReport = true;\n      } else {\n        sourceSheet = workbook.worksheets.getActiveWorksheet();\n      }\n      sourceSheet.load(\"name\");\n      await context.sync();\n      \n      // \n      appendDebugLog(` - : \"${sourceSheet.name}\", : ${usingMainReport}`);\n      if (currentMainReportConfig) {\n        appendDebugLog(`  : sheetName=\"${currentMainReportConfig.sheetName}\"`);\n      }\n      \n      // \n      let snColIndex: number | null = null;\n      let amtColIndex: number | null = null;\n      let sourceSheetName: string = \"\"; // \n      \n      \n      try {\n        const snNamedItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        snNamedItem.load(\"name, formula\");\n        await context.sync();\n        \n        //  sync \n        sourceSheetName = sourceSheet.name;\n        \n        // 1 NamedItem  Range \n        const snRange = snNamedItem.getRange();\n        snRange.load(\"columnIndex, address, columnCount\");\n        await context.sync();\n        let snColIndexFromRange = snRange.columnIndex;\n        \n        // 2\n        const snColumnName = parseColumnFromFormula(snNamedItem.formula);\n        let snColIndexFromFormula: number | null = null;\n        if (snColumnName) {\n          snColIndexFromFormula = getColumnIndexFromName(snColumnName);\n        }\n        \n        // \n        snColIndex = snColIndexFromFormula !== null ? snColIndexFromFormula : snColIndexFromRange;\n        \n        //  S/N \n        appendDebugLog(`S/N  NamedItem: ${snNamedItem.name}`);\n        appendDebugLog(`  : ${snNamedItem.formula}`);\n        appendDebugLog(`  : ${snRange.address}`);\n        appendDebugLog(`   Range : ${snColIndexFromRange} ( ${getColumnName(snColIndexFromRange)})`);\n        if (snColumnName) {\n          appendDebugLog(`  : ${snColumnName}, : ${snColIndexFromFormula}`);\n        }\n        appendDebugLog(`  : ${snColIndex} ( ${getColumnName(snColIndex)})`);\n      } catch (error) {\n        showMessage(\":  S/N \\\" S/N \\\"\", true);\n        return;\n      }\n      \n      try {\n        const amtNamedItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        amtNamedItem.load(\"name, formula\");\n        await context.sync();\n        \n        // 1 NamedItem  Range \n        const amtRange = amtNamedItem.getRange();\n        amtRange.load(\"columnIndex, address, columnCount\");\n        await context.sync();\n        let amtColIndexFromRange = amtRange.columnIndex;\n        \n        // 2\n        const amtColumnName = parseColumnFromFormula(amtNamedItem.formula);\n        let amtColIndexFromFormula: number | null = null;\n        if (amtColumnName) {\n          amtColIndexFromFormula = getColumnIndexFromName(amtColumnName);\n        }\n        \n        // \n        amtColIndex = amtColIndexFromFormula !== null ? amtColIndexFromFormula : amtColIndexFromRange;\n        \n        // \n        appendDebugLog(` NamedItem: ${amtNamedItem.name}`);\n        appendDebugLog(`  : ${amtNamedItem.formula}`);\n        appendDebugLog(`  : ${amtRange.address}`);\n        appendDebugLog(`   Range : ${amtColIndexFromRange} ( ${getColumnName(amtColIndexFromRange)})`);\n        if (amtColumnName) {\n          appendDebugLog(`  : ${amtColumnName}, : ${amtColIndexFromFormula}`);\n        }\n        appendDebugLog(`  : ${amtColIndex} ( ${getColumnName(amtColIndex)})`);\n      } catch (error) {\n        showMessage(\": \\\"\\\"\", true);\n        return;\n      }\n      \n      //  Excel \n      const usedRange = sourceSheet.getUsedRange();\n      if (!usedRange) {\n        showMessage(\": \", true);\n        return;\n      }\n      \n      usedRange.load(\"rowCount, columnCount, address, values, rowIndex\");\n      \n      // \n      await context.sync();\n      \n      if (usedRange.rowCount === 0 || usedRange.columnCount === 0) {\n        showMessage(\": \", true);\n        return;\n      }\n      \n      const rowCount = usedRange.rowCount;\n      const columnCount = usedRange.columnCount;\n      \n      // \n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(`:  (: ${rowCount}, : ${columnCount})`, true);\n        return;\n      }\n      \n      // \n      clearDebugLog();\n      appendDebugLog(`...`);\n      appendDebugLog(`S/N : ${snColIndex}, : ${amtColIndex}`);\n      \n      // \n      if (snColIndex === amtColIndex) {\n        appendDebugLog(`: S/N `);\n      }\n      \n      // =====  filterPanelFields =====\n      // \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n      \n      appendDebugLog(`: ${filterEntries.length}`);\n      for (const filter of filterEntries) {\n        appendDebugLog(`  ${filter.headerText}: ${filter.allowedValues.size} `);\n      }\n      \n      // \n      const filteredRows: any[][] = [];\n      \n      //  columnCount \n      const normalizeRow = (rowData: any[]): any[] => {\n        if (!rowData || !Array.isArray(rowData)) {\n          return new Array(columnCount).fill(\"\");\n        }\n        if (rowData.length === columnCount) {\n          return rowData;\n        } else if (rowData.length < columnCount) {\n          return [...rowData, ...new Array(columnCount - rowData.length).fill(\"\")];\n        } else {\n          return rowData.slice(0, columnCount);\n        }\n      };\n      \n      // \n      if (usedRange.values.length > 0 && usedRange.values[0]) {\n        filteredRows.push(normalizeRow(usedRange.values[0]));\n      }\n      \n      // \n      let visibleRowCount = 0;\n      let hiddenRowCount = 0;\n      \n      for (let i = 1; i < usedRange.values.length; i++) {\n        const rowData = usedRange.values[i];\n        if (!rowData || !Array.isArray(rowData)) continue;\n        \n        // \n        let shouldInclude = true;\n        \n        if (filterEntries.length > 0) {\n          for (const filter of filterEntries) {\n            if (filter.colIdx < rowData.length) {\n              const cellValue = rowData[filter.colIdx];\n              const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n              \n              if (!filter.allowedValues.has(cellStr)) {\n                shouldInclude = false;\n                break;\n              }\n            }\n          }\n        }\n        \n        if (shouldInclude) {\n          filteredRows.push(normalizeRow(rowData));\n          visibleRowCount++;\n        } else {\n          hiddenRowCount++;\n        }\n      }\n      \n      appendDebugLog(`: ${rowCount}, : ${visibleRowCount}, : ${hiddenRowCount}`);\n      \n      const filteredCount = filteredRows.length - 1; // \n      \n      // \n      if (filteredCount === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n      appendDebugLog(`: ${filteredCount}`);\n      \n      //  filteredRows \n      let totalAmount = 0;\n      const amountValues: number[] = []; // \n      \n      for (let i = 1; i < filteredRows.length; i++) {\n        const rowData = filteredRows[i];\n        // Excel  = filteredRows  + 1 filteredRows[0] \n        const excelRowNumber = i + 1;\n        \n        if (rowData && Array.isArray(rowData) && amtColIndex !== null && amtColIndex >= 0 && amtColIndex < rowData.length) {\n          const amountValue = rowData[amtColIndex];\n          \n          //  S/N \n          const snValue = (snColIndex !== null && snColIndex >= 0 && snColIndex < rowData.length) ? rowData[snColIndex] : \"N/A\";\n          \n          // \n          if (amountValue !== null && amountValue !== undefined && amountValue !== \"\") {\n            const cleanedAmount = cleanAmount(amountValue);\n            totalAmount += cleanedAmount;\n            amountValues.push(cleanedAmount);\n            \n            // \n            const rawValueStr = typeof amountValue === \"string\" ? `\"${amountValue}\"` : String(amountValue);\n            \n            //  S/N \n            appendDebugLog(`Row ${excelRowNumber}: SN[${snColIndex}]=${snValue}, [${amtColIndex}]=${rawValueStr} -> Clean=${cleanedAmount.toFixed(2)}`);\n          } else {\n            // \n            appendDebugLog(`Row ${excelRowNumber}: SN[${snColIndex}]=${snValue}, [${amtColIndex}]=`);\n          }\n        } else {\n          appendDebugLog(`Row ${excelRowNumber}:  -  ${amtColIndex}  (: ${rowData ? rowData.length : 0})`);\n        }\n      }\n      \n      // \n      appendDebugLog(`---  ---`);\n      appendDebugLog(`: ${totalAmount.toFixed(2)}`);\n      appendDebugLog(`: [${amountValues.map(v => v.toFixed(2)).join(', ')}]`);\n      \n      // \n      const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\").slice(0, 19);\n      const newSheetName = `_${timestamp}`;\n      let newSheet: Excel.Worksheet;\n      \n      try {\n        newSheet = workbook.worksheets.add(newSheetName);\n      } catch (error) {\n        // \n        let counter = 1;\n        while (true) {\n          try {\n            newSheet = workbook.worksheets.add(`${newSheetName}_${counter}`);\n            break;\n          } catch (e) {\n            counter++;\n          }\n        }\n      }\n      \n      // \n      newSheet.load(\"name\");\n      \n      // \n      // \\n\n      let currentFilterText = \"\";\n      interface FilterDisplayItem {\n        fieldName: string;\n        values: string;\n      }\n      const filterDisplayItems: FilterDisplayItem[] = [];\n      \n      try {\n        // \n        for (const field of filterPanelFields) {\n          // \n          if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n            const selectedValuesArray = Array.from(field.selectedValues);\n            \n            // \n            let displayValues: string;\n            if (selectedValuesArray.length <= 5) {\n              displayValues = selectedValuesArray.join(\"; \");\n            } else {\n              displayValues = selectedValuesArray.slice(0, 5).join(\"; \") + `... (${selectedValuesArray.length})`;\n            }\n            \n            filterDisplayItems.push({\n              fieldName: field.headerText,\n              values: displayValues\n            });\n            appendDebugLog(` - ${field.headerText}: ${selectedValuesArray.length}/${field.allValues.length}`);\n          }\n        }\n        \n        if (filterDisplayItems.length > 0) {\n          // \\n\n          currentFilterText = filterDisplayItems.map(item => \n            `${item.fieldName}${item.values}`\n          ).join(\"\\n\");\n          appendDebugLog(`: ${currentFilterText}`);\n        } else {\n          appendDebugLog(\"\");\n        }\n      } catch (error) {\n        console.warn(\":\", error);\n        appendDebugLog(`: ${error.message}`);\n      }\n      \n      //  Dashboard  4  + \n      const filterRowCount = filterDisplayItems.length > 0 ? filterDisplayItems.length : 1;\n      const dashboardEndRow = 4 + filterRowCount + 1; // +1 for spacing row\n      const dataStartRow = dashboardEndRow + 1;\n      \n      //  Dashboard  - \n      const dashboardRange = newSheet.getRange(`A1:E${dashboardEndRow}`);\n      dashboardRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n      dashboardRange.format.horizontalAlignment = Excel.HorizontalAlignment.left;\n      dashboardRange.format.fill.color = \"#F5F5F5\"; // \n      dashboardRange.format.font.name = \"Arial\";\n      dashboardRange.format.font.size = 11;\n      dashboardRange.format.font.color = \"#323130\";\n      \n      //  Dashboard 3\n      const dashboardBaseData = [\n        [\" Dashboard\", \"\", \"\", \"\", \"\"],\n        [\"\", filteredCount.toString(), \"\", \"\", sourceSheetName],\n        [\"\", totalAmount.toFixed(2), \"\", \"\", new Date().toLocaleString(\"zh-CN\")]\n      ];\n      const dashboardBaseRange = newSheet.getRange(\"A1:E3\");\n      dashboardBaseRange.values = dashboardBaseData;\n      \n      //  Dashboard \n      const titleCell = newSheet.getRange(\"A1:E1\");\n      titleCell.merge();\n      titleCell.format.font.size = 14;\n      titleCell.format.font.bold = true;\n      titleCell.format.font.color = \"#0078d4\";\n      titleCell.format.horizontalAlignment = Excel.HorizontalAlignment.center;\n      \n      //  Dashboard A\n      const labelRange = newSheet.getRange(\"A2:A3\");\n      labelRange.format.font.bold = true;\n      labelRange.format.font.color = \"#323130\";\n      \n      //  Dashboard \n      const dataRangeDashboard = newSheet.getRange(\"B2:B3\");\n      dataRangeDashboard.format.font.color = \"#0078d4\";\n      dataRangeDashboard.format.font.bold = true;\n      \n      //  Dashboard \n      const rightLabelRange = newSheet.getRange(\"D2:D3\");\n      rightLabelRange.format.font.bold = true;\n      const rightDataRange = newSheet.getRange(\"E2:E3\");\n      rightDataRange.format.font.color = \"#323130\";\n      \n      // \n      const sourceSheetLinkCell = newSheet.getRange(\"E2\");\n      // \n      const configHeaderRow = currentMainReportConfig?.headerRow || 1;\n      const linkAddress = `'${sourceSheetName}'!A${configHeaderRow}`;\n      sourceSheetLinkCell.hyperlink = {\n        address: \"\",\n        documentReference: linkAddress,\n        screenTip: `: ${sourceSheetName}`,\n        textToDisplay: sourceSheetName\n      };\n      sourceSheetLinkCell.format.font.color = \"#0078d4\";\n      sourceSheetLinkCell.format.font.underline = Excel.RangeUnderlineStyle.single;\n      \n      // 4\n      // A = \"\"B = C = \n      if (filterDisplayItems.length > 0) {\n        for (let i = 0; i < filterDisplayItems.length; i++) {\n          const rowNum = 4 + i;\n          const item = filterDisplayItems[i];\n          \n          // A-E\n          const rowRange = newSheet.getRange(`A${rowNum}:E${rowNum}`);\n          if (i === 0) {\n            rowRange.values = [[\"\", `${item.fieldName}`, item.values, \"\", \"\"]];\n          } else {\n            rowRange.values = [[\"\", `${item.fieldName}`, item.values, \"\", \"\"]];\n          }\n          \n          // A \n          const labelCell = newSheet.getRange(`A${rowNum}`);\n          labelCell.format.font.bold = true;\n          labelCell.format.font.color = \"#323130\";\n          \n          // B \n          const fieldNameCell = newSheet.getRange(`B${rowNum}`);\n          fieldNameCell.format.font.color = \"#0d47a1\"; // \n          fieldNameCell.format.font.bold = true;\n          \n          // C \n          const valueCell = newSheet.getRange(`C${rowNum}`);\n          valueCell.format.font.color = \"#323130\";\n          valueCell.format.wrapText = true;\n        }\n      } else {\n        // \n        const noFilterRow = newSheet.getRange(\"A4:E4\");\n        noFilterRow.values = [[\"\", \"\", \"\", \"\", \"\"]];\n        \n        const noFilterLabelCell = newSheet.getRange(\"A4\");\n        noFilterLabelCell.format.font.bold = true;\n        noFilterLabelCell.format.font.color = \"#323130\";\n        \n        const noFilterValueCell = newSheet.getRange(\"B4\");\n        noFilterValueCell.format.font.color = \"#a19f9d\";\n        noFilterValueCell.format.font.italic = true;\n      }\n      \n      //  Dashboard \n      dashboardRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeTop\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeBottom\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeLeft\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeRight\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"InsideHorizontal\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"InsideHorizontal\").color = \"#E1E1E1\";\n      dashboardRange.format.borders.getItem(\"InsideVertical\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"InsideVertical\").color = \"#E1E1E1\";\n      \n      // \n      await context.sync();\n      \n      //  dataStartRow - \n      if (filteredRows.length > 0) {\n        const lastColumnName = getColumnName(columnCount - 1);\n        \n        // \n        appendDebugLog(`...`);\n        appendDebugLog(`: A${dataStartRow}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n        appendDebugLog(`filteredRows.length = ${filteredRows.length}`);\n        appendDebugLog(`columnCount = ${columnCount}`);\n        \n        // \n        for (let i = 0; i < filteredRows.length; i++) {\n          const rowLen = filteredRows[i] ? filteredRows[i].length : 0;\n          if (rowLen !== columnCount) {\n            appendDebugLog(`:  ${i}  (${rowLen})  columnCount (${columnCount}) `);\n          }\n        }\n        \n        // \n        const targetRowCount = filteredRows.length;\n        const targetColCount = columnCount;\n        appendDebugLog(`: ${targetRowCount}  x ${targetColCount} `);\n        \n        const dataRange = newSheet.getRange(`A${dataStartRow}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n        \n        try {\n          dataRange.values = filteredRows;\n        } catch (writeError) {\n          appendDebugLog(`: ${writeError.message}`);\n          // \n          appendDebugLog(`: ${JSON.stringify(filteredRows[0])}`);\n          if (filteredRows.length > 1) {\n            appendDebugLog(`: ${JSON.stringify(filteredRows[1])}`);\n          }\n          throw writeError;\n        }\n        \n        // \n        dataRange.format.font.name = \"Arial\";\n        dataRange.format.font.size = 11;\n        dataRange.format.font.color = \"#323130\";\n        dataRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n        dataRange.format.horizontalAlignment = Excel.HorizontalAlignment.left;\n        \n        // dataStartRow\n        const headerRange = newSheet.getRange(`A${dataStartRow}:${lastColumnName}${dataStartRow}`);\n        headerRange.format.fill.color = \"#0078d4\"; // \n        headerRange.format.font.bold = true;\n        headerRange.format.font.color = \"#FFFFFF\"; // \n        headerRange.format.font.size = 11;\n        headerRange.format.font.name = \"Arial\";\n        headerRange.format.horizontalAlignment = Excel.HorizontalAlignment.center;\n        headerRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n        \n        // \n        headerRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeTop\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeBottom\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeLeft\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeRight\").color = \"#005a9e\";\n        \n        // dataStartRow+1\n        if (filteredRows.length > 1) {\n          const dataRowsRange = newSheet.getRange(`A${dataStartRow + 1}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n          \n          // \n          dataRowsRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeTop\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeBottom\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeLeft\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeRight\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"InsideHorizontal\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"InsideHorizontal\").color = \"#F0F0F0\";\n          dataRowsRange.format.borders.getItem(\"InsideVertical\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"InsideVertical\").color = \"#F0F0F0\";\n          \n          // \n          const dataRowStart = dataStartRow + 1;\n          for (let i = dataRowStart; i <= dataStartRow + filteredRows.length - 1; i++) {\n            const rowRange = newSheet.getRange(`A${i}:${lastColumnName}${i}`);\n            if ((i - dataRowStart) % 2 === 0) {\n              // \n              rowRange.format.fill.color = \"#FAFAFA\";\n            } else {\n              // \n              rowRange.format.fill.color = \"#FFFFFF\";\n            }\n          }\n        }\n      }\n      \n      // \n      const usedRangeNew = newSheet.getUsedRange();\n      usedRangeNew.format.autofitColumns();\n      \n      // \n      const allRowsRange = newSheet.getUsedRange();\n      allRowsRange.format.rowHeight = 20; // \n      \n      // Dashboard \n      const dashboardRows = newSheet.getRange(`1:${dashboardEndRow}`);\n      dashboardRows.format.rowHeight = 22;\n      \n      // \n      newSheet.activate();\n      \n      await context.sync();\n      \n      //  newSheet.name \n      addReportToList(newSheet.name, filteredCount, totalAmount);\n      \n      // \n      await saveCurrentFilterCondition();\n      \n      showMessage(` ${filteredCount} : ${totalAmount.toFixed(2)}`);\n    });\n    \n    // \n    updateFilterTextDisplay();\n    await copyFilterTextToClipboard();\n    \n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function loadMainReportConfig(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      \n      // \n      try {\n        const dataRangeItem = workbook.names.getItem(CFG_DATA_RANGE_NAME);\n        dataRangeItem.load(\"formula\");\n        await context.sync();\n        \n        const rangeMatch = dataRangeItem.formula.match(/=([^!]+)!([^$]+)/);\n        if (rangeMatch) {\n          if (!currentMainReportConfig) {\n            currentMainReportConfig = {\n              dataRange: dataRangeItem.formula.replace(/^=/, \"\"),\n              headerRow: 0,\n              snColumn: 0,\n              amtColumn: 0,\n              sheetName: rangeMatch[1]\n            };\n          } else {\n            currentMainReportConfig.dataRange = dataRangeItem.formula.replace(/^=/, \"\");\n            currentMainReportConfig.sheetName = rangeMatch[1];\n          }\n        }\n      } catch (error) {\n        // \n      }\n      \n      // \n      try {\n        const headerRowItem = workbook.names.getItem(CFG_HEADER_ROW_NAME);\n        headerRowItem.load(\"formula\");\n        await context.sync();\n        \n        const rowMatch = headerRowItem.formula.match(/:(\\d+):/);\n        if (rowMatch && currentMainReportConfig) {\n          currentMainReportConfig.headerRow = parseInt(rowMatch[1]);\n        }\n      } catch (error) {\n        // \n      }\n      \n      //  S/N \n      try {\n        const snItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        const snRange = snItem.getRange();\n        snRange.load(\"columnIndex\");\n        await context.sync();\n        \n        if (currentMainReportConfig) {\n          currentMainReportConfig.snColumn = snRange.columnIndex;\n        }\n      } catch (error) {\n        // S/N \n      }\n      \n      // \n      try {\n        const amtItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        const amtRange = amtItem.getRange();\n        amtRange.load(\"columnIndex\");\n        await context.sync();\n        \n        if (currentMainReportConfig) {\n          currentMainReportConfig.amtColumn = amtRange.columnIndex;\n        }\n      } catch (error) {\n        // \n      }\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    // \n    document.getElementById(\"btn-set-data-range\")?.addEventListener(\"click\", () => {\n      setDataRange();\n    });\n    \n    document.getElementById(\"btn-set-header-row\")?.addEventListener(\"click\", () => {\n      setHeaderRow();\n    });\n    \n    document.getElementById(\"btn-set-sn\")?.addEventListener(\"click\", () => {\n      setSnColumnWithMergeCheck();\n    });\n    \n    document.getElementById(\"btn-set-amt\")?.addEventListener(\"click\", () => {\n      setColumnConfig(CFG_AMT_COL_NAME, \"\");\n    });\n    \n    document.getElementById(\"btn-enable-filter\")?.addEventListener(\"click\", () => {\n      enableFilter();\n    });\n    \n    document.getElementById(\"btn-generate\")?.addEventListener(\"click\", () => {\n      generateReport();\n    });\n    \n    // \n    document.getElementById(\"btn-apply-filter\")?.addEventListener(\"click\", () => {\n      applyFilterFromPanel();\n    });\n    \n    document.getElementById(\"btn-clear-filter\")?.addEventListener(\"click\", () => {\n      clearFilterFromPanel();\n    });\n    \n    document.getElementById(\"btn-save-filter\")?.addEventListener(\"click\", () => {\n      saveFilterFromPanel();\n    });\n    \n    // \n    document.getElementById(\"btn-reset-filter\")?.addEventListener(\"click\", () => {\n      resetFilterAndGoToMainReport();\n    });\n    \n    // \n    document.getElementById(\"data-range-info\")?.addEventListener(\"click\", () => {\n      goToMainReport();\n    });\n    \n    // \n    bindFilterPanelEvents();\n    \n    // \n    bindFilterTextEvents();\n    \n    // \n    loadMainReportConfig().then(() => {\n      updateMainReportConfigDisplay();\n      updateReportsTable();\n      updateFilterConditionsList();\n    });\n    \n    console.log(\"Excel Add-in \");\n  }\n});\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title></title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-Fabric ms-font-m\\\"> <div class=\\\"ms-Grid\\\" dir=\\\"ltr\\\"> <main class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <header class=\\\"app-header\\\"> <div class=\\\"header-content\\\"> <i class=\\\"ms-Icon ms-Icon--ExcelDocument header-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-l ms-fontWeight-semibold header-title\\\"></span> </div> </header> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--Settings section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <p class=\\\"ms-font-s section-hint\\\"></p> <div class=\\\"config-steps\\\"> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">1.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-data-range\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Table\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"data-range-info\\\" class=\\\"step-value clickable ms-font-s\\\" title=\\\"\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">2.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-header-row\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Header\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"header-row-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">3.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\">S/N </span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-sn\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--NumberField\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"> S/N </span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"sn-col-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">4.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-amt\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Money\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"amt-col-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> </div> <div class=\\\"config-actions\\\"> <button id=\\\"btn-enable-filter\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--FilterSolid\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> </div> </section> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--Filter section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <div id=\\\"filter-panel\\\" class=\\\"filter-panel\\\"> <div class=\\\"filter-panel-hint ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--Info\\\" aria-hidden=\\\"true\\\"></i> \\\"\\\" </div> </div> <div class=\\\"filter-actions\\\"> <button id=\\\"btn-reset-filter\\\" class=\\\"ms-Button ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Refresh\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-apply-filter\\\" class=\\\"ms-Button ms-Button--primary ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Filter\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-generate\\\" class=\\\"ms-Button ms-Button--icon btn-success\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--DocumentSet\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-save-filter\\\" class=\\\"ms-Button ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Save\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-clear-filter\\\" class=\\\"ms-Button ms-Button--icon btn-danger\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Cancel\\\" aria-hidden=\\\"true\\\"></i></span> </button> </div> <div id=\\\"current-filter-display\\\" class=\\\"current-filter-display\\\"> <div class=\\\"no-filters ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--Info\\\" aria-hidden=\\\"true\\\"></i>  </div> </div> <div class=\\\"subsection-header\\\"> <i class=\\\"ms-Icon ms-Icon--FavoriteList\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div id=\\\"filter-conditions-list\\\" class=\\\"filter-conditions-list\\\"> <div class=\\\"no-filters ms-font-s\\\"></div> </div> </div> </section> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--ReportDocument section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Table\\\" id=\\\"reports-table-container\\\"> <table id=\\\"reports-table\\\" class=\\\"reports-table\\\"> <thead> <tr> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> </tr> </thead> <tbody id=\\\"reports-table-body\\\"> <tr> <td colspan=\\\"3\\\" class=\\\"no-reports ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--DocumentSearch\\\" aria-hidden=\\\"true\\\"></i>  </td> </tr> </tbody> </table> </div> </div> </section> <div id=\\\"message-area\\\" class=\\\"message-area ms-font-s\\\"></div> <div id=\\\"filter-text-container\\\" class=\\\"filter-text-container\\\" style=\\\"display:none\\\"> <div class=\\\"filter-text-header\\\"> <i class=\\\"ms-Icon ms-Icon--Copy\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> <span id=\\\"copy-success-hint\\\" class=\\\"copy-success-hint ms-font-xs\\\">!</span> </div> <div id=\\\"filter-text-content\\\" class=\\\"filter-text-content ms-font-s\\\" title=\\\"\\\"></div> </div> <div id=\\\"debug-log\\\" class=\\\"debug-log ms-font-xs\\\"></div> </div> </main> </div> <div id=\\\"confirm-dialog\\\" class=\\\"ms-Dialog confirm-dialog-overlay\\\"> <div class=\\\"ms-Dialog-main confirm-dialog\\\"> <div class=\\\"ms-Dialog-header confirm-dialog-header\\\"> <p class=\\\"ms-Dialog-title ms-font-l ms-fontWeight-semibold\\\"> <i class=\\\"ms-Icon ms-Icon--Warning\\\" aria-hidden=\\\"true\\\"></i>  </p> </div> <div class=\\\"ms-Dialog-inner\\\"> <div class=\\\"ms-Dialog-content confirm-dialog-body\\\"> <p id=\\\"confirm-dialog-message\\\" class=\\\"ms-font-m\\\"></p> </div> <div class=\\\"ms-Dialog-actions confirm-dialog-footer\\\"> <button id=\\\"confirm-dialog-cancel\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\"></span> </button> <button id=\\\"confirm-dialog-ok\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\"></span> </button> </div> </div> </div> </div> <div id=\\\"progress-overlay\\\" class=\\\"ms-Dialog progress-overlay\\\"> <div class=\\\"ms-Dialog-main progress-dialog\\\"> <div class=\\\"ms-Dialog-header progress-header\\\"> <i class=\\\"ms-Icon ms-Icon--Processing spinning-icon\\\" aria-hidden=\\\"true\\\"></i> <span id=\\\"progress-title\\\" class=\\\"ms-font-l ms-fontWeight-semibold\\\">...</span> </div> <div class=\\\"ms-Dialog-inner progress-body\\\"> <p id=\\\"progress-message\\\" class=\\\"ms-font-m\\\">...</p> <div class=\\\"progress-bar-container\\\"> <div id=\\\"progress-bar\\\" class=\\\"progress-bar\\\"></div> </div> <p id=\\\"progress-detail\\\" class=\\\"progress-detail ms-font-s\\\">0 / 0</p> </div> </div> </div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CFG_SN_COL_NAME","CFG_AMT_COL_NAME","CFG_DATA_RANGE_NAME","CFG_HEADER_ROW_NAME","getColumnName","columnIndex","result","index","String","fromCharCode","Math","floor","getColumnIndexFromName","columnName","charCodeAt","parseColumnFromFormula","formula","match","reportsList","filterConditionsList","currentMainReportConfig","filterPanelFields","showMessage","message","isError","messageArea","getElementById","textContent","className","console","log","showProgress","title","overlay","titleEl","messageEl","barEl","detailEl","style","width","classList","add","updateProgress","current","total","detail","percent","round","concat","hideProgress","remove","appendDebugLog","debugLog","logEntry","createElement","marginBottom","appendChild","scrollTop","scrollHeight","generateFilterText","filterItems","_i","_filterPanelFields","field","selectedValues","size","allValues","valuesArray","Array","from","valuesText","slice","join","push","headerText","updateFilterTextDisplay","autoHide","container","content","filterText","display","htmlContent","split","map","line","innerHTML","copyFilterTextToClipboard","_copyFilterTextToClipboard","_callee2","textArea","_t","_t2","_context2","navigator","clipboard","writeText","showCopySuccessHint","error","position","left","body","select","execCommand","removeChild","hint","setTimeout","clearDebugLog","cleanAmount","isNaN","str","trim","isNegative","startsWith","substring","dotIndex","indexOf","num","parseFloat","_setDataRange","_callee4","_t5","_context4","Excel","run","_ref2","_callee3","context","sheet","selection","address","parts","startRow","startCol","endRow","endCol","startColName","endColName","currentSheetName","sheetNameEscaped","fullAddress","namedItems","_t4","_context3","workbook","worksheets","getActiveWorksheet","load","getSelectedRange","sync","includes","rowIndex","rowCount","columnCount","name","names","getItem","delete","dataRange","sheetName","headerRow","snColumn","amtColumn","updateMainReportConfigDisplay","_x0","_setHeaderRow","_callee6","_t7","_context6","_ref3","_callee5","rowAddress","_context5","_x1","_setColumnConfig","_callee8","_t9","_context8","_ref4","_callee7","columnNameStr","existingItem","cellAddress","_t8","_context7","getItemOrNullObject","isNullObject","_x10","_setSnColumnWithMergeCheck","_callee0","_t10","_context1","_ref5","_callee9","usedRange","totalColumns","columnRange","values","mergedCellInfos","consecutiveNulls","k","cellRowIndex","mergeRowCount","endRowIndex","_iterator5","_step5","info","sortedInfos","deletedRows","totalInfos","minRow","maxRow","_iterator6","_step6","_info2","allDataRange","allData","mergeResults","idx","_info","rowsToMerge","firstRowIndex","dataOffset","mergedValues","rowOffset","currentDataOffset","currentRowValues","col","firstVal","currentVal","BATCH_SIZE","batchStart","batchEnd","batchResults","_iterator7","_step7","_loop","_iterator8","_step8","firstRowRange","_iterator9","_step9","_result","_i4","columnAddress","mergeInfo","_t0","_context0","getUsedRange","getRangeByIndexes","showConfirmDialog","_createForOfIteratorHelper","s","getRange","format","fill","color","err","sort","Infinity","min","max","rowsToDelete","_context9","find","unmerge","_regeneratorValues","wrapText","DeleteShiftDirection","up","_x11","dataRangeEl","headerRowEl","snColEl","colName","amtColEl","enableFilterBtn","isConfigComplete","disabled","updateReportsTable","_currentMainReportCon","tbody","html","report","createTime","Date","toLocaleString","month","day","hour","minute","querySelectorAll","forEach","link","addEventListener","goToMainReport","span","target","getAttribute","_x5","_navigateToSheet","navigateToSheet","_displaySpan$parentEl","displaySpan","querySelector","editContainer","parentElement","input","focus","startEditReportName","parseInt","keyEvent","key","_x3","_x4","_confirmEditReportName","confirmEditReportName","cancelEditReportName","button","btn","currentTarget","_x6","_x7","_deleteReport","deleteReport","_displaySpan$parentEl2","_callee12","newName","oldName","_t14","_context13","_ref7","_callee11","_context12","_x13","_callee14","_context15","_ref8","_callee13","_context14","activate","_x14","okButton","cancelButton","cleanup","removeEventListener","onOk","onCancel","_callee16","_t17","_context17","_ref9","_callee15","_context16","splice","_x15","addReportToList","totalAmount","toISOString","unshift","updateFilterConditionsList","filter","filterSummary","filterSettings","_displaySpan$parentEl3","startEditFilterName","cancelEditFilterName","confirmEditFilterName","_x8","_x9","_applyFilterCondition","applyFilterCondition","_displaySpan$parentEl4","_callee18","filterCondition","_t19","_context20","_ref0","_callee17","_loop2","colIdx","applyBtn","clearBtn","saveBtn","generateBtn","resetBtn","excelRow","filterEntries","_i5","_filterPanelFields4","hiddenCount","visibleCount","valueIdx","rowData","excelRowNum","shouldHide","_iterator0","_step0","cellValue","cellStr","_t18","_context19","config","rowIdx","_cellValue","valueStr","sortedValues","savedFilter","_context18","Set","localeCompare","isFiltered","filterValues","has","renderFilterPanel","rowHidden","allowedValues","updateCurrentFilterDisplay","filterType","_x16","activeFilters","refreshCurrentFilterDisplay","columnFilterSettings","_i2","_filterPanelFields2","selectedValuesArray","displayValues","_enableFilter","_callee20","_t20","_context22","_ref1","_callee19","_currentMainReportCon3","_currentMainReportCon4","activeSheet","_context21","_x17","activeFilterFieldIndex","panel","tagsHtml","selectedCount","totalCount","tagClass","escapeHtml","dropdownHtml","fieldId","j","isSelected","displayValue","text","div","filterPanelEventsBound","updateTagCount","fieldIndex","tag","toggle","countSpan","_applyFilterFromPanel","_callee22","_t22","_context24","_ref10","_callee21","targetSheet","_iterator1","_step1","rowVisibility","shouldShow","_iterator10","_step10","allDataRowsStart","allDataRowsEnd","hiddenRangeCount","endIdx","rangeStartRow","rangeEndRow","_t21","_context23","rowHeight","count","_x18","_clearFilterFromPanel","_callee24","_iterator11","_step11","_t23","_context26","_ref11","_callee23","startRowNum","endRowNum","allDataRows","filterTextContainer","_context25","_x19","saveCurrentFilterCondition","_saveCurrentFilterCondition","_callee25","_currentMainReportCon5","_iterator12","_step12","filterCount","_context27","id","now","_objectSpread","_goToMainReport","_callee27","_t24","_context29","_ref12","_callee26","_context28","_x20","_resetFilterAndGoToMainReport","_callee29","_t25","_context31","_ref13","_callee28","_iterator13","_step13","_context30","_x21","_generateReport","_callee31","_t32","_context33","_ref14","_callee30","_currentMainReportCon6","sourceSheet","usingMainReport","snColIndex","amtColIndex","sourceSheetName","snNamedItem","snRange","snColIndexFromRange","snColumnName","snColIndexFromFormula","amtNamedItem","amtRange","amtColIndexFromRange","amtColumnName","amtColIndexFromFormula","_iterator14","_step14","_field3","_i6","_filterEntries","filteredRows","normalizeRow","visibleRowCount","hiddenRowCount","shouldInclude","_iterator15","_step15","_filter","filteredCount","amountValues","_i7","_rowData","excelRowNumber","amountValue","snValue","cleanedAmount","rawValueStr","timestamp","newSheetName","newSheet","counter","currentFilterText","filterDisplayItems","_iterator16","_step16","filterRowCount","dashboardEndRow","dataStartRow","dashboardRange","dashboardBaseData","titleCell","labelRange","dataRangeDashboard","sourceSheetLinkCell","configHeaderRow","linkAddress","_i8","rowNum","item","labelCell","fieldNameCell","valueCell","noFilterLabelCell","noFilterValueCell","lastColumnName","_i9","rowLen","targetRowCount","targetColCount","headerRange","dataRowsRange","dataRowStart","_i0","_t28","_t31","_context32","isArray","_toConsumableArray","toFixed","fieldName","warn","verticalAlignment","VerticalAlignment","center","horizontalAlignment","HorizontalAlignment","font","toString","merge","bold","hyperlink","documentReference","screenTip","textToDisplay","underline","RangeUnderlineStyle","single","italic","borders","BorderLineStyle","continuous","JSON","stringify","autofitColumns","_x22","_loadMainReportConfig","_callee33","_t37","_context35","_ref15","_callee32","dataRangeItem","rangeMatch","headerRowItem","rowMatch","snItem","amtItem","_context34","_x23","Office","onReady","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB0","_document$getElementB1","host","HostType","setDataRange","setHeaderRow","setSnColumnWithMergeCheck","_x","_x2","setColumnConfig","enableFilter","generateReport","applyFilterFromPanel","clearFilterFromPanel","_currentMainReportCon2","_i3","_filterPanelFields3","saveFilterFromPanel","resetFilterAndGoToMainReport","tagElement","closest","actionButton","preventDefault","stopPropagation","action","searchInput","searchText","isSearchMode","optionsContainer","visibleValues","option","valueIndexStr","valueIndex","_step","_iterator","_step2","_iterator2","_step3","_iterator3","_step4","newSelected","_iterator4","options","checkbox","checked","updateFieldOptions","optionDiv","newChecked","contains","actionsContainer","searchHint","searchLower","toLowerCase","hasSearchText","matches","hintSpan","filterSearchOptions","type","_callee","_context","loadMainReportConfig","URL"],"ignoreList":[],"sourceRoot":""}