{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\n// \nconst CFG_SN_COL_NAME = \"Wiz_Cfg_SN_Col\";\nconst CFG_AMT_COL_NAME = \"Wiz_Cfg_Amt_Col\";\nconst CFG_DATA_RANGE_NAME = \"Wiz_Cfg_Data_Range\";\nconst CFG_HEADER_ROW_NAME = \"Wiz_Cfg_Header_Row\";\n\n// \ninterface MainReportConfig {\n  dataRange: string; //  \"Sheet1!A1:E100\"\n  headerRow: number; // 1-based\n  snColumn: number; // S/N 0-based\n  amtColumn: number; // 0-based\n  sheetName: string; // \n}\n\n//  Excel  A-Z  AA-ZZ\nfunction getColumnName(columnIndex: number): string {\n  let result = \"\";\n  let index = columnIndex;\n  while (index >= 0) {\n    result = String.fromCharCode(65 + (index % 26)) + result;\n    index = Math.floor(index / 26) - 1;\n  }\n  return result;\n}\n\n//  Excel  \"A\" -> 0, \"Z\" -> 25, \"AA\" -> 26\nfunction getColumnIndexFromName(columnName: string): number {\n  let index = 0;\n  columnName = columnName.toUpperCase();\n  for (let i = 0; i < columnName.length; i++) {\n    index = index * 26 + (columnName.charCodeAt(i) - 64);\n  }\n  return index - 1;\n}\n\n//  NamedItem  \"=Sheet1!$A:$A\" -> \"A\"\nfunction parseColumnFromFormula(formula: string): string | null {\n  // =SheetName!$Column:$Column  =SheetName!Column:Column\n  const match = formula.match(/![\\$]?([A-Z]+)[\\$]?:[\\$]?[A-Z]+/i);\n  if (match && match[1]) {\n    return match[1].toUpperCase();\n  }\n  return null;\n}\n\n// \ninterface ReportInfo {\n  sheetName: string;\n  createTime: string;\n  rowCount: number;\n  totalAmount: number;\n}\n\n// \ninterface ColumnFilterSetting {\n  columnIndex: number;\n  columnName: string; //  \"A\", \"B\"\n  headerText: string; // \n  filterType: string; // \n  filterValues: string[]; // \n  isFiltered: boolean; // \n}\n\n// \ninterface FilterCondition {\n  id: string;\n  name: string;\n  createTime: string;\n  sheetName: string;\n  filterSettings: ColumnFilterSetting[]; // \n  config: MainReportConfig; // \n}\n\n//  Excel Add-in  localStorage \nlet reportsList: ReportInfo[] = [];\n\n// \nlet filterConditionsList: FilterCondition[] = [];\n\n// \nlet currentMainReportConfig: MainReportConfig | null = null;\n\n// \ntype TimeDimension = \"year\" | \"month\" | \"day\" | \"all\";\n\n// \ninterface FilterFieldData {\n  columnIndex: number;\n  headerText: string;\n  allValues: string[]; // \n  selectedValues: Set<string>; // \n  isTimeField: boolean; // \n  timeDimension: TimeDimension; // \n  timeValues?: { year: string[]; month: string[]; day: string[] }; // \n}\n\n// \nlet filterPanelFields: FilterFieldData[] = [];\n\n// \ninterface FilterStatistics {\n  filteredRowCount: number;   // \n  totalAmount: number;        // \n  isValid: boolean;           // \n}\n\n// \nlet currentFilterStatistics: FilterStatistics = {\n  filteredRowCount: 0,\n  totalAmount: 0,\n  isValid: false\n};\n\n// \nfunction showMessage(message: string, isError: boolean = false): void {\n  const messageArea = document.getElementById(\"message-area\");\n  if (messageArea) {\n    messageArea.textContent = message;\n    messageArea.className = isError ? \"message-area error\" : \"message-area success\";\n  }\n  console.log(message);\n}\n\n// \nfunction showProgress(title: string, message: string): void {\n  const overlay = document.getElementById(\"progress-overlay\");\n  const titleEl = document.getElementById(\"progress-title\");\n  const messageEl = document.getElementById(\"progress-message\");\n  const barEl = document.getElementById(\"progress-bar\");\n  const detailEl = document.getElementById(\"progress-detail\");\n\n  if (overlay && titleEl && messageEl && barEl && detailEl) {\n    titleEl.textContent = title;\n    messageEl.textContent = message;\n    barEl.style.width = \"0%\";\n    detailEl.textContent = \"\";\n    overlay.classList.add(\"show\");\n  }\n}\n\n// \nfunction updateProgress(current: number, total: number, detail?: string): void {\n  const barEl = document.getElementById(\"progress-bar\");\n  const detailEl = document.getElementById(\"progress-detail\");\n\n  if (barEl && detailEl) {\n    const percent = total > 0 ? Math.round((current / total) * 100) : 0;\n    barEl.style.width = `${percent}%`;\n    detailEl.textContent = detail || `${current} / ${total}`;\n  }\n}\n\n// \nfunction hideProgress(): void {\n  const overlay = document.getElementById(\"progress-overlay\");\n  if (overlay) {\n    overlay.classList.remove(\"show\");\n  }\n}\n\n// \nfunction appendDebugLog(message: string): void {\n  const debugLog = document.getElementById(\"debug-log\");\n  if (debugLog) {\n    const logEntry = document.createElement(\"div\");\n    logEntry.textContent = message;\n    logEntry.style.marginBottom = \"2px\";\n    debugLog.appendChild(logEntry);\n    // \n    debugLog.scrollTop = debugLog.scrollHeight;\n  }\n  console.log(message);\n}\n\n// \nfunction generateFilterText(): string {\n  const filterItems: string[] = [];\n\n  // \n  if (currentFilterStatistics.isValid) {\n    filterItems.push(`${currentFilterStatistics.filteredRowCount}`);\n    filterItems.push(`${currentFilterStatistics.totalAmount.toFixed(2)}`);\n    filterItems.push(\"\"); // \n  }\n\n  // \n  let hasFilter = false;\n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      const valuesArray = Array.from(field.selectedValues);\n      const valuesText = valuesArray.length > 5\n        ? valuesArray.slice(0, 5).join(\"\") + `...${valuesArray.length}`\n        : valuesArray.join(\"\");\n      filterItems.push(`${field.headerText}${valuesText}`);\n      hasFilter = true;\n    }\n  }\n\n  if (!hasFilter && !currentFilterStatistics.isValid) {\n    return \"\";\n  }\n\n  return filterItems.join(\"\\n\");\n}\n\n// \nfunction updateFilterTextDisplay(autoHide: boolean = false): void {\n  const container = document.getElementById(\"filter-text-container\");\n  const content = document.getElementById(\"filter-text-content\");\n\n  if (!container || !content) return;\n\n  const filterText = generateFilterText();\n\n  if (filterText === \"\" && autoHide) {\n    container.style.display = \"none\";\n    return;\n  }\n\n  // \n  container.style.display = \"block\";\n\n  //  HTML \n  const htmlContent = filterText.split(\"\\n\").map(line => {\n    // \n    if (line.trim() === \"\") {\n      return \"<hr class='filter-text-divider'>\";\n    }\n\n    //   \n    if (line.startsWith(\"\")) {\n      const value = line.replace(\"\", \"\");\n      return `<span class=\"stat-label\"></span><span class=\"stat-value\">${value}</span>`;\n    }\n    if (line.startsWith(\"\")) {\n      const value = line.replace(\"\", \"\");\n      return `<span class=\"stat-label\"></span><span class=\"stat-value\">${value}</span>`;\n    }\n\n    //   \n    const match = line.match(/(.+?)(.+)/);\n    if (match) {\n      return `<span class=\"field-name\">${match[1]}</span><span class=\"field-value\">${match[2]}</span>`;\n    }\n    return line;\n  }).join(\"<br>\");\n\n  content.innerHTML = htmlContent;\n}\n\n// \nasync function copyFilterTextToClipboard(): Promise<boolean> {\n  const filterText = generateFilterText();\n\n  if (filterText === \"\") {\n    return false;\n  }\n\n  try {\n    await navigator.clipboard.writeText(filterText);\n    showCopySuccessHint();\n    return true;\n  } catch (error) {\n    console.error(\":\", error);\n    // \n    try {\n      const textArea = document.createElement(\"textarea\");\n      textArea.value = filterText;\n      textArea.style.position = \"fixed\";\n      textArea.style.left = \"-9999px\";\n      document.body.appendChild(textArea);\n      textArea.select();\n      document.execCommand(\"copy\");\n      document.body.removeChild(textArea);\n      showCopySuccessHint();\n      return true;\n    } catch (fallbackError) {\n      console.error(\":\", fallbackError);\n      return false;\n    }\n  }\n}\n\n// \nfunction showCopySuccessHint(): void {\n  const hint = document.getElementById(\"copy-success-hint\");\n  if (hint) {\n    hint.classList.add(\"show\");\n    setTimeout(() => {\n      hint.classList.remove(\"show\");\n    }, 2000);\n  }\n}\n\n// \nfunction bindFilterTextEvents(): void {\n  const content = document.getElementById(\"filter-text-content\");\n  if (content) {\n    content.addEventListener(\"click\", async () => {\n      await copyFilterTextToClipboard();\n    });\n  }\n}\n\n// \nfunction clearDebugLog(): void {\n  const debugLog = document.getElementById(\"debug-log\");\n  if (debugLog) {\n    debugLog.innerHTML = \"\";\n  }\n}\n\n// \nfunction cleanAmount(value: any): number {\n  if (value === null || value === undefined || value === \"\") {\n    return 0;\n  }\n\n  // \n  if (typeof value === \"number\") {\n    return isNaN(value) ? 0 : value;\n  }\n\n  // \n  let str = String(value).trim();\n\n  // 0\n  if (str === \"\") {\n    return 0;\n  }\n\n  //  RMBCNY \n  str = str.replace(/RMB|CNY|USD|EUR|GBP/gi, \"\");\n\n  //  $\n  str = str.replace(/[$]/g, \"\");\n\n  // \n  str = str.replace(/[,]/g, \"\");\n\n  // \n  str = str.replace(/\\s+/g, \"\");\n\n  // \n  const isNegative = str.startsWith(\"-\");\n  if (isNegative) {\n    str = str.substring(1);\n  }\n\n  // \n  str = str.replace(/[^\\d.]/g, \"\");\n\n  // \n  const dotIndex = str.indexOf(\".\");\n  if (dotIndex !== -1) {\n    str = str.substring(0, dotIndex + 1) + str.substring(dotIndex + 1).replace(/\\./g, \"\");\n  }\n\n  // \n  const num = parseFloat(str);\n  const result = isNaN(num) ? 0 : (isNegative ? -num : num);\n\n  return result;\n}\n\n// \n// \nasync function setDataRange(): Promise<void> {\n  try {\n    // \n    showMessage(\"...\", false);\n    appendDebugLog(\" setDataRange\");\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      if (!selection) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      selection.load(\"address, rowIndex, columnIndex, rowCount, columnCount\");\n      await context.sync();\n\n      // \n      let address = selection.address;\n      appendDebugLog(`: ${address}`);\n\n      // \n      let sheetNameInAddress = \"\";\n      if (address.includes(\"!\")) {\n        const parts = address.split(\"!\");\n        if (parts.length > 1) {\n          sheetNameInAddress = parts[0].replace(/^'|'$/g, \"\");\n          address = parts[1];\n        }\n      }\n\n      //  $ \n      // \n      if (!address.includes(\"$\")) {\n        // \n        const startRow = selection.rowIndex + 1;\n        const startCol = selection.columnIndex;\n        const endRow = startRow + selection.rowCount - 1;\n        const endCol = startCol + selection.columnCount - 1;\n\n        const startColName = getColumnName(startCol);\n        const endColName = getColumnName(endCol);\n\n        address = `$${startColName}$${startRow}:$${endColName}$${endRow}`;\n        appendDebugLog(`: ${address}`);\n      }\n\n      // \n      const currentSheetName = sheet.name;\n      appendDebugLog(`Sheet: [${currentSheetName}]`);\n\n      // Sheet\n      const sheetNameEscaped = `'${currentSheetName.replace(/'/g, \"''\")}'`;\n\n      appendDebugLog(`Sheet: [${sheetNameEscaped}]`);\n\n      const fullAddress = `${sheetNameEscaped}!${address}`;\n\n      //  NamedItem\n      const namedItems = context.workbook.names;\n\n      // \n      try {\n        //  getItem  getItemOrNullObject catch \n        const existingItem = namedItems.getItem(CFG_DATA_RANGE_NAME);\n        // \n        existingItem.load(\"name\");\n        await context.sync();\n\n        appendDebugLog(`: ${CFG_DATA_RANGE_NAME}`);\n        existingItem.delete();\n        await context.sync();\n        appendDebugLog(``);\n      } catch (error) {\n        // ItemNotFound \n        if (error.code !== \"ItemNotFound\") {\n          appendDebugLog(`404: ${error.code} - ${error.message}`);\n        } else {\n          appendDebugLog(` (ItemNotFound)`);\n        }\n      }\n\n      //  NamedItem = \n      const formula = `=${fullAddress}`;\n\n      // \n      appendDebugLog(`===  NamedItem ===`);\n      appendDebugLog(`Name: ${CFG_DATA_RANGE_NAME}`);\n      appendDebugLog(`Formula: ${formula}`);\n      appendDebugLog(`RefersTo: ${fullAddress}`);\n\n      try {\n        namedItems.add(CFG_DATA_RANGE_NAME, formula);\n        await context.sync();\n        appendDebugLog(`!`);\n      } catch (addError) {\n        console.error(\" NamedItem :\", addError);\n        // \n        const debugInfo = JSON.stringify(addError, Object.getOwnPropertyNames(addError));\n        appendDebugLog(` : ${debugInfo}`);\n\n        let errorMsg = addError.message;\n        if (addError.code) {\n          errorMsg = `[${addError.code}] ${errorMsg}`;\n        }\n        throw new Error(errorMsg);\n      }\n\n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: fullAddress,\n          headerRow: 0,\n          snColumn: 0,\n          amtColumn: 0,\n          sheetName: currentSheetName\n        };\n      } else {\n        currentMainReportConfig.dataRange = fullAddress;\n        currentMainReportConfig.sheetName = currentSheetName;\n      }\n\n      updateMainReportConfigDisplay();\n      showMessage(`: ${address}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    // \n    showMessage(`: ${error.message}`, true);\n    appendDebugLog(`CRITICAL: ${error.message}`);\n  }\n}\n\n// \nasync function setHeaderRow(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"rowIndex\");\n\n      await context.sync();\n\n      const rowIndex = selection.rowIndex + 1; //  1-based\n\n      //  NamedItem\n      const namedItems = context.workbook.names;\n      try {\n        const existingItem = namedItems.getItem(CFG_HEADER_ROW_NAME);\n        existingItem.delete();\n        await context.sync();\n      } catch (error) {\n        // \n      }\n\n      const rowAddress = `${sheet.name}!${rowIndex}:${rowIndex}`;\n      namedItems.add(CFG_HEADER_ROW_NAME, `=${rowAddress}`);\n      await context.sync();\n\n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: rowIndex,\n          snColumn: 0,\n          amtColumn: 0,\n          sheetName: sheet.name\n        };\n      } else {\n        currentMainReportConfig.headerRow = rowIndex;\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n\n      updateMainReportConfigDisplay();\n      showMessage(`:  ${rowIndex} `);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// SN\nasync function setColumnConfig(columnName: string, displayName: string): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"address, columnIndex\");\n\n      await context.sync();\n\n      // \n      if (!selection.address) {\n        showMessage(` Excel ${displayName}`, true);\n        return;\n      }\n\n      //  selection  columnIndex\n      const columnIndex = selection.columnIndex;\n      const columnNameStr = getColumnName(columnIndex);\n\n      //  NamedItem\n      const namedItems = context.workbook.names;\n\n      // \n      try {\n        const existingItem = namedItems.getItemOrNullObject(columnName);\n        await context.sync();\n        if (!existingItem.isNullObject) {\n          existingItem.delete();\n          await context.sync();\n        }\n      } catch (error) {\n        // \n        console.log(\" NamedItem :\", error);\n      }\n\n      //  NamedItem\n      //  Excel \n      const cellAddress = `='${sheet.name}'!$${columnNameStr}$1`;\n      namedItems.add(columnName, cellAddress);\n\n      await context.sync();\n\n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: 0,\n          snColumn: columnName === CFG_SN_COL_NAME ? columnIndex : 0,\n          amtColumn: columnName === CFG_AMT_COL_NAME ? columnIndex : 0,\n          sheetName: sheet.name\n        };\n      } else {\n        if (columnName === CFG_SN_COL_NAME) {\n          currentMainReportConfig.snColumn = columnIndex;\n        } else if (columnName === CFG_AMT_COL_NAME) {\n          currentMainReportConfig.amtColumn = columnIndex;\n        }\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n\n      showMessage(`${displayName} ${columnIndex + 1}  (${columnNameStr})`);\n\n      // \n      updateMainReportConfigDisplay();\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`${displayName}: ${error.message}`, true);\n  }\n}\n\n// SN\n// \ninterface MergeCellInfo {\n  address: string;      //  \"A5:A6\"\n  startRow: number;     // 0-based\n  endRow: number;       // 0-based\n  columnIndex: number;  // \n}\n\nasync function setSnColumnWithMergeCheck(): Promise<void> {\n  try {\n    // \n    showProgress(\"\", \"...\");\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"address, columnIndex\");\n\n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex, columnCount, address\");\n\n      await context.sync();\n\n      const columnIndex = selection.columnIndex;\n      const columnNameStr = getColumnName(columnIndex);\n      const startRow = usedRange.rowIndex;\n      const rowCount = usedRange.rowCount;\n      const totalColumns = usedRange.columnCount;\n\n      console.log(` ${columnNameStr} : ${startRow + 1}${startRow + rowCount}`);\n\n      // \n      updateProgress(10, 100, ` ${columnIndex + 1}  (${columnNameStr}) ${rowCount} ...`);\n\n      //  - \n      const columnRange = sheet.getRangeByIndexes(startRow, columnIndex, rowCount, 1);\n      columnRange.load(\"values\");\n      await context.sync();\n\n      const values = columnRange.values;\n      console.log(` ${values.length} `);\n\n      // \n      updateProgress(30, 100, `...`);\n\n      // =====  Excel API  =====\n      const mergedCellInfos: MergeCellInfo[] = [];\n\n      // 1 getMergedAreasOrNullObject \n      updateProgress(40, 100, \" API ...\");\n\n      try {\n        const mergedAreas = columnRange.getMergedAreasOrNullObject();\n        mergedAreas.load(\"isNullObject, areaCount\");\n        await context.sync();\n\n        if (!mergedAreas.isNullObject && mergedAreas.areaCount > 0) {\n          // \n          mergedAreas.load(\"areas\");\n          await context.sync();\n\n          const areas = mergedAreas.areas;\n          areas.load(\"items\");\n          await context.sync();\n\n          for (let j = 0; j < areas.items.length; j++) {\n            const area = areas.items[j];\n            area.load(\"rowCount, address, rowIndex, columnIndex\");\n          }\n          await context.sync();\n\n          for (let j = 0; j < areas.items.length; j++) {\n            const area = areas.items[j];\n            if (area.rowCount > 1 && area.columnIndex === columnIndex) {\n              mergedCellInfos.push({\n                address: area.address,\n                startRow: area.rowIndex,\n                endRow: area.rowIndex + area.rowCount - 1,\n                columnIndex: columnIndex\n              });\n              console.log(`API : ${area.address}, ${area.rowCount}`);\n            }\n          }\n        }\n      } catch (apiError) {\n        console.log(\"API :\", apiError);\n      }\n\n      // 2 API \n      if (mergedCellInfos.length === 0) {\n        updateProgress(50, 100, \"...\");\n\n        //  null \n        let i = 0;\n\n        while (i < rowCount) {\n          const currentValue = values[i][0];\n\n          //  null \n          let consecutiveEmpty = 0;\n          for (let k = i + 1; k < rowCount; k++) {\n            const nextValue = values[k][0];\n            // null  undefined \n            if (nextValue === null || nextValue === undefined || nextValue === \"\") {\n              consecutiveEmpty++;\n            } else {\n              break;\n            }\n          }\n\n          // \n          if (consecutiveEmpty > 0 && currentValue !== null && currentValue !== undefined && currentValue !== \"\") {\n            const cellRowIndex = startRow + i;\n            const mergeRowCount = consecutiveEmpty + 1;\n            const endRowIndex = cellRowIndex + mergeRowCount - 1;\n            const address = `${columnNameStr}${cellRowIndex + 1}:${columnNameStr}${endRowIndex + 1}`;\n\n            console.log(`: ${address}, ${mergeRowCount}`);\n\n            mergedCellInfos.push({\n              address: address,\n              startRow: cellRowIndex,\n              endRow: endRowIndex,\n              columnIndex: columnIndex\n            });\n\n            i += mergeRowCount;\n          } else {\n            i++;\n          }\n        }\n      }\n\n      console.log(` ${mergedCellInfos.length} `);\n\n      // \n      updateProgress(80, 100, ` ${mergedCellInfos.length} `);\n\n      // \n      hideProgress();\n\n      // \n      if (mergedCellInfos.length > 0) {\n        showMessage(` ${mergedCellInfos.length} `, false);\n\n        // \n        const confirmHighlight = await showConfirmDialog(\n          ` ${columnIndex + 1}  (${columnNameStr})  ${mergedCellInfos.length} \\n\\n`\n        );\n\n        if (confirmHighlight) {\n          // \n          for (const info of mergedCellInfos) {\n            const mergeRange = sheet.getRange(info.address);\n            mergeRange.format.fill.color = \"#FFFF00\";\n          }\n          await context.sync();\n          showMessage(` ${mergedCellInfos.length} `);\n        }\n\n        // \n        const confirmMerge = await showConfirmDialog(\n          `\\n\\n\\n \\n \\n \\n \\n `\n        );\n\n        if (confirmMerge) {\n          // \n          showProgress(\"\", ` ${mergedCellInfos.length} ...`);\n\n          // \n          const sortedInfos = mergedCellInfos.sort((a, b) => b.startRow - a.startRow);\n          let deletedRows = 0;\n          const totalInfos = sortedInfos.length;\n\n          // =====  =====\n          // \n          let minRow = Infinity;\n          let maxRow = 0;\n          for (const info of sortedInfos) {\n            minRow = Math.min(minRow, info.startRow);\n            maxRow = Math.max(maxRow, info.endRow);\n          }\n\n          // \n          const allDataRange = sheet.getRangeByIndexes(minRow, 0, maxRow - minRow + 1, totalColumns);\n          allDataRange.load(\"values\");\n          await context.sync();\n          const allData = allDataRange.values;\n\n          updateProgress(0, totalInfos, \"...\");\n\n          // \n          interface MergeResult {\n            firstRowIndex: number;\n            mergedValues: (string | number | boolean | null)[];\n            rowsToDelete: number;\n          }\n          const mergeResults: MergeResult[] = [];\n\n          // \n          for (let idx = 0; idx < sortedInfos.length; idx++) {\n            const info = sortedInfos[idx];\n            const rowsToMerge = info.endRow - info.startRow + 1;\n            if (rowsToMerge < 2) continue;\n\n            const firstRowIndex = info.startRow;\n            const dataOffset = firstRowIndex - minRow;\n\n            // \n            const mergedValues = allData[dataOffset].slice();\n\n            // \n            for (let rowOffset = 1; rowOffset < rowsToMerge; rowOffset++) {\n              const currentDataOffset = dataOffset + rowOffset;\n              if (currentDataOffset >= allData.length) break;\n\n              const currentRowValues = allData[currentDataOffset];\n\n              for (let col = 0; col < totalColumns; col++) {\n                const firstVal = String(mergedValues[col] || \"\").trim();\n                const currentVal = String(currentRowValues[col] || \"\").trim();\n\n                if (currentVal && currentVal !== firstVal) {\n                  if (firstVal) {\n                    mergedValues[col] = firstVal + \"\\n\" + currentVal;\n                  } else {\n                    mergedValues[col] = currentVal;\n                  }\n                }\n              }\n            }\n\n            mergeResults.push({\n              firstRowIndex,\n              mergedValues,\n              rowsToDelete: rowsToMerge - 1\n            });\n          }\n\n          // =====  =====\n          // \n          const BATCH_SIZE = 20;\n\n          for (let batchStart = 0; batchStart < mergeResults.length; batchStart += BATCH_SIZE) {\n            const batchEnd = Math.min(batchStart + BATCH_SIZE, mergeResults.length);\n            const batchResults = mergeResults.slice(batchStart, batchEnd);\n\n            updateProgress(batchStart, mergeResults.length, ` ${batchStart + 1}-${batchEnd}/${mergeResults.length}`);\n\n            // 1. \n            for (const result of batchResults) {\n              const info = sortedInfos.find(i => i.startRow === result.firstRowIndex);\n              if (info) {\n                const mergeRange = sheet.getRange(info.address);\n                mergeRange.unmerge();\n              }\n            }\n            await context.sync();\n\n            // 2. \n            for (const result of batchResults) {\n              const firstRowRange = sheet.getRangeByIndexes(result.firstRowIndex, 0, 1, totalColumns);\n              firstRowRange.values = [result.mergedValues];\n              firstRowRange.format.wrapText = true;\n              firstRowRange.format.fill.color = \"#F5F5F5\";\n            }\n            await context.sync();\n\n            // 3. \n            for (const result of batchResults) {\n              for (let i = result.rowsToDelete; i > 0; i--) {\n                const rowToDelete = sheet.getRangeByIndexes(result.firstRowIndex + i, 0, 1, totalColumns);\n                rowToDelete.delete(Excel.DeleteShiftDirection.up);\n                deletedRows++;\n              }\n            }\n            await context.sync();\n          }\n\n          // \n          hideProgress();\n\n          showMessage(` ${mergedCellInfos.length}  ${deletedRows} `);\n        }\n      } else {\n        // \n        showMessage(` ${columnIndex + 1}  (${columnNameStr})  ${rowCount} `, false);\n      }\n\n      // SN\n      const namedItems = context.workbook.names;\n\n      try {\n        const existingItem = namedItems.getItem(CFG_SN_COL_NAME);\n        existingItem.delete();\n        await context.sync();\n      } catch (error) {\n        // \n      }\n\n      const columnAddress = `='${sheet.name}'!$${columnNameStr}:$${columnNameStr}`;\n      namedItems.add(CFG_SN_COL_NAME, columnAddress);\n\n      await context.sync();\n\n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: 0,\n          snColumn: columnIndex,\n          amtColumn: 0,\n          sheetName: sheet.name\n        };\n      } else {\n        currentMainReportConfig.snColumn = columnIndex;\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n\n      const mergeInfo = mergedCellInfos.length > 0 ? ` ( ${mergedCellInfos.length} )` : \"\";\n      showMessage(` S/N  ${columnIndex + 1}  (${columnNameStr})${mergeInfo}`);\n\n      updateMainReportConfigDisplay();\n    });\n  } catch (error) {\n    console.error(\"SN:\", error);\n    hideProgress(); // \n    showMessage(` S/N : ${error.message}`, true);\n  }\n}\n\n// \nfunction updateMainReportConfigDisplay(): void {\n  // \n  const dataRangeEl = document.getElementById(\"data-range-info\");\n  if (dataRangeEl) {\n    if (currentMainReportConfig && currentMainReportConfig.dataRange) {\n      dataRangeEl.textContent = currentMainReportConfig.dataRange;\n      dataRangeEl.className = \"step-value clickable\";\n      dataRangeEl.title = \"\";\n    } else {\n      dataRangeEl.textContent = \"\";\n      dataRangeEl.className = \"step-value not-configured\";\n      dataRangeEl.title = \"\";\n    }\n  }\n\n  // \n  const headerRowEl = document.getElementById(\"header-row-info\");\n  if (headerRowEl) {\n    if (currentMainReportConfig && currentMainReportConfig.headerRow > 0) {\n      headerRowEl.textContent = ` ${currentMainReportConfig.headerRow} `;\n      headerRowEl.className = \"step-value\";\n    } else {\n      headerRowEl.textContent = \"\";\n      headerRowEl.className = \"step-value not-configured\";\n    }\n  }\n\n  //  S/N \n  const snColEl = document.getElementById(\"sn-col-info\");\n  if (snColEl) {\n    if (currentMainReportConfig && currentMainReportConfig.snColumn >= 0) {\n      const colName = getColumnName(currentMainReportConfig.snColumn);\n      snColEl.textContent = ` ${currentMainReportConfig.snColumn + 1}  (${colName})`;\n      snColEl.className = \"step-value\";\n    } else {\n      snColEl.textContent = \"\";\n      snColEl.className = \"step-value not-configured\";\n    }\n  }\n\n  // \n  const amtColEl = document.getElementById(\"amt-col-info\");\n  if (amtColEl) {\n    if (currentMainReportConfig && currentMainReportConfig.amtColumn >= 0) {\n      const colName = getColumnName(currentMainReportConfig.amtColumn);\n      amtColEl.textContent = ` ${currentMainReportConfig.amtColumn + 1}  (${colName})`;\n      amtColEl.className = \"step-value\";\n    } else {\n      amtColEl.textContent = \"\";\n      amtColEl.className = \"step-value not-configured\";\n    }\n  }\n\n  // \n  const enableFilterBtn = document.getElementById(\"btn-enable-filter\") as HTMLButtonElement;\n  if (enableFilterBtn) {\n    const isConfigComplete = currentMainReportConfig &&\n      currentMainReportConfig.dataRange &&\n      currentMainReportConfig.headerRow > 0 &&\n      currentMainReportConfig.snColumn >= 0 &&\n      currentMainReportConfig.amtColumn >= 0;\n    enableFilterBtn.disabled = !isConfigComplete;\n  }\n}\n\n// \nasync function updateColumnConfigDisplay(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      //  S/N \n      const snInfoEl = document.getElementById(\"sn-col-info\");\n      try {\n        const snNamedItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        snNamedItem.load(\"formula\");\n        const snRange = snNamedItem.getRange();\n        snRange.load(\"columnIndex\");\n        await context.sync();\n\n        const snColName = getColumnName(snRange.columnIndex);\n        if (snInfoEl) {\n          snInfoEl.textContent = ` ${snRange.columnIndex + 1}  (${snColName})`;\n          snInfoEl.className = \"config-value\";\n        }\n      } catch (error) {\n        if (snInfoEl) {\n          snInfoEl.textContent = \"\";\n          snInfoEl.className = \"config-value not-configured\";\n        }\n      }\n\n      // \n      const amtInfoEl = document.getElementById(\"amt-col-info\");\n      try {\n        const amtNamedItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        amtNamedItem.load(\"formula\");\n        const amtRange = amtNamedItem.getRange();\n        amtRange.load(\"columnIndex\");\n        await context.sync();\n\n        const amtColName = getColumnName(amtRange.columnIndex);\n        if (amtInfoEl) {\n          amtInfoEl.textContent = ` ${amtRange.columnIndex + 1}  (${amtColName})`;\n          amtInfoEl.className = \"config-value\";\n        }\n      } catch (error) {\n        if (amtInfoEl) {\n          amtInfoEl.textContent = \"\";\n          amtInfoEl.className = \"config-value not-configured\";\n        }\n      }\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nfunction updateReportsTable(): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n\n  let html = \"\";\n\n  // \n  if (currentMainReportConfig && currentMainReportConfig.sheetName) {\n    html += `\n      <tr class=\"main-report-row\">\n        <td>\n          <span class=\"main-report-link\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Home\" style=\"margin-right: 4px; font-size: 10px;\"></i>${currentMainReportConfig.sheetName}\n          </span>\n        </td>\n        <td><span class=\"main-report-badge\"></span></td>\n        <td></td>\n      </tr>\n    `;\n  }\n\n  if (reportsList.length === 0 && !currentMainReportConfig?.sheetName) {\n    tbody.innerHTML = '<tr><td colspan=\"3\" class=\"no-reports\"></td></tr>';\n    return;\n  }\n\n  html += reportsList.map((report, index) => {\n    const createTime = new Date(report.createTime).toLocaleString(\"zh-CN\", {\n      month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\"\n    });\n    return `\n      <tr>\n        <td>\n          <span class=\"report-name-display\" data-index=\"${index}\" data-sheet-name=\"${report.sheetName}\" title=\"\">${report.sheetName}</span>\n          <div class=\"report-name-edit-container\" style=\"display: none;\">\n            <input type=\"text\" class=\"report-name-input\" data-index=\"${index}\" value=\"${report.sheetName}\">\n            <i class=\"ms-Icon ms-Icon--ReturnKey edit-hint-icon\" title=\"\"></i>\n          </div>\n        </td>\n        <td>${createTime}</td>\n        <td>\n          <button class=\"icon-button-small danger\" data-index=\"${index}\" data-sheet-name=\"${report.sheetName}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Delete\"></i>\n          </button>\n        </td>\n      </tr>\n    `;\n  }).join(\"\");\n\n  tbody.innerHTML = html;\n\n  // \n  tbody.querySelectorAll(\".main-report-link\").forEach(link => {\n    link.addEventListener(\"click\", () => {\n      goToMainReport();\n    });\n  });\n\n  // \n  tbody.querySelectorAll(\".report-name-display\").forEach(span => {\n    span.addEventListener(\"click\", (e) => {\n      const sheetName = (e.target as HTMLElement).getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        navigateToSheet(sheetName);\n      }\n    });\n\n    // \n    span.addEventListener(\"dblclick\", (e) => {\n      const target = e.target as HTMLElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      startEditReportName(index);\n    });\n  });\n\n  // \n  tbody.querySelectorAll(\".report-name-input\").forEach(input => {\n    // \n    input.addEventListener(\"keydown\", (e) => {\n      const keyEvent = e as KeyboardEvent;\n      if (keyEvent.key === \"Enter\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        confirmEditReportName(index, target.value);\n      } else if (keyEvent.key === \"Escape\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        cancelEditReportName(index);\n      }\n    });\n\n    // \n    input.addEventListener(\"blur\", (e) => {\n      const target = e.target as HTMLInputElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      // \n      setTimeout(() => {\n        cancelEditReportName(index);\n      }, 200);\n    });\n  });\n\n  // \n  tbody.querySelectorAll(\".icon-button-small.danger\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      //  currentTarget  target target \n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      const sheetName = btn.getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        deleteReport(index, sheetName);\n      }\n    });\n  });\n}\n\n// \nfunction startEditReportName(index: number): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n\n  // \n  const displaySpan = tbody.querySelector(`.report-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".report-name-edit-container\") as HTMLElement;\n  const input = editContainer?.querySelector(\".report-name-input\") as HTMLInputElement;\n\n  if (displaySpan && editContainer && input) {\n    displaySpan.style.display = \"none\";\n    editContainer.style.display = \"flex\";\n    input.focus();\n    input.select();\n  }\n}\n\n// \nfunction cancelEditReportName(index: number): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n\n  const displaySpan = tbody.querySelector(`.report-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".report-name-edit-container\") as HTMLElement;\n\n  if (displaySpan && editContainer) {\n    displaySpan.style.display = \"inline\";\n    editContainer.style.display = \"none\";\n  }\n}\n\n// \nasync function confirmEditReportName(index: number, newName: string): Promise<void> {\n  if (index < 0 || index >= reportsList.length) return;\n\n  const oldName = reportsList[index].sheetName;\n  newName = newName.trim();\n\n  if (!newName || newName === oldName) {\n    cancelEditReportName(index);\n    return;\n  }\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(oldName);\n\n      //  sheet \n      sheet.name = newName;\n\n      // A1 \n      const titleCell = sheet.getRange(\"A1\");\n      titleCell.values = [[newName]];\n\n      await context.sync();\n\n      // \n      reportsList[index].sheetName = newName;\n\n      // \n      updateReportsTable();\n\n      showMessage(`: ${newName}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n    cancelEditReportName(index);\n  }\n}\n\n// \nasync function navigateToSheet(sheetName: string): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(sheetName);\n      sheet.activate();\n      await context.sync();\n      showMessage(`: ${sheetName}`);\n    });\n  } catch (error) {\n    showMessage(`:  \"${sheetName}\"`, true);\n  }\n}\n\n// \nfunction showConfirmDialog(message: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    const overlay = document.getElementById(\"confirm-dialog\");\n    const messageEl = document.getElementById(\"confirm-dialog-message\");\n    const okButton = document.getElementById(\"confirm-dialog-ok\");\n    const cancelButton = document.getElementById(\"confirm-dialog-cancel\");\n\n    if (!overlay || !messageEl || !okButton || !cancelButton) {\n      resolve(false);\n      return;\n    }\n\n    messageEl.textContent = message;\n    overlay.classList.add(\"show\");\n\n    const cleanup = () => {\n      overlay.classList.remove(\"show\");\n      okButton.removeEventListener(\"click\", onOk);\n      cancelButton.removeEventListener(\"click\", onCancel);\n    };\n\n    const onOk = () => {\n      cleanup();\n      resolve(true);\n    };\n\n    const onCancel = () => {\n      cleanup();\n      resolve(false);\n    };\n\n    okButton.addEventListener(\"click\", onOk);\n    cancelButton.addEventListener(\"click\", onCancel);\n  });\n}\n\n// \nasync function deleteReport(index: number, sheetName: string): Promise<void> {\n  const confirmed = await showConfirmDialog(` \"${sheetName}\" `);\n\n  if (!confirmed) {\n    return;\n  }\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      try {\n        const sheet = workbook.worksheets.getItem(sheetName);\n        sheet.delete();\n        await context.sync();\n\n        // \n        reportsList.splice(index, 1);\n        updateReportsTable();\n        showMessage(`: ${sheetName}`);\n      } catch (error) {\n        // \n        reportsList.splice(index, 1);\n        updateReportsTable();\n        showMessage(` \"${sheetName}\" `);\n      }\n    });\n  } catch (error) {\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction addReportToList(sheetName: string, rowCount: number, totalAmount: number): void {\n  const report: ReportInfo = {\n    sheetName: sheetName,\n    createTime: new Date().toISOString(),\n    rowCount: rowCount,\n    totalAmount: totalAmount\n  };\n\n  reportsList.unshift(report); // \n  updateReportsTable();\n}\n\n\n// \nfunction updateFilterConditionsList(): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n\n  if (filterConditionsList.length === 0) {\n    container.innerHTML = '<div class=\"no-filters\"></div>';\n    return;\n  }\n\n  container.innerHTML = filterConditionsList.map((filter, index) => {\n    const createTime = new Date(filter.createTime).toLocaleString(\"zh-CN\", {\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    });\n\n    // \n    const filterSummary = filter.filterSettings.map(f => f.headerText).join(\", \");\n\n    return `\n      <div class=\"filter-condition-item\">\n        <div class=\"filter-condition-info\">\n          <span class=\"filter-name-display\" data-index=\"${index}\" title=\" | ${filterSummary}\">${filter.name}</span>\n          <div class=\"filter-name-edit-container\" style=\"display: none;\">\n            <input type=\"text\" class=\"filter-name-input\" data-index=\"${index}\" value=\"${filter.name}\">\n            <i class=\"ms-Icon ms-Icon--ReturnKey edit-hint-icon\" title=\"\"></i>\n          </div>\n          <span class=\"filter-condition-time\">${createTime}</span>\n        </div>\n        <div class=\"filter-condition-actions\">\n          <button class=\"icon-button-small apply-filter-btn\" data-index=\"${index}\" data-sheet-name=\"${filter.sheetName}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Play\"></i>\n          </button>\n          <button class=\"icon-button-small danger delete-filter-btn\" data-index=\"${index}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Delete\"></i>\n          </button>\n        </div>\n      </div>\n    `;\n  }).join(\"\");\n\n  // \n  container.querySelectorAll(\".filter-name-display\").forEach(span => {\n    span.addEventListener(\"dblclick\", (e) => {\n      const target = e.target as HTMLElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      startEditFilterName(index);\n    });\n  });\n\n  // \n  container.querySelectorAll(\".filter-name-input\").forEach(input => {\n    // \n    input.addEventListener(\"keydown\", (e) => {\n      const keyEvent = e as KeyboardEvent;\n      if (keyEvent.key === \"Enter\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        confirmEditFilterName(index, target.value);\n      } else if (keyEvent.key === \"Escape\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        cancelEditFilterName(index);\n      }\n    });\n\n    // \n    input.addEventListener(\"blur\", (e) => {\n      const target = e.target as HTMLInputElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      setTimeout(() => {\n        cancelEditFilterName(index);\n      }, 200);\n    });\n  });\n\n  // \n  container.querySelectorAll(\".apply-filter-btn\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      const sheetName = btn.getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        applyFilterCondition(index, sheetName);\n      }\n    });\n  });\n\n  // \n  container.querySelectorAll(\".delete-filter-btn\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      deleteFilterCondition(index);\n    });\n  });\n}\n\n// \nfunction startEditFilterName(index: number): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n\n  const displaySpan = container.querySelector(`.filter-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".filter-name-edit-container\") as HTMLElement;\n  const input = editContainer?.querySelector(\".filter-name-input\") as HTMLInputElement;\n\n  if (displaySpan && editContainer && input) {\n    displaySpan.style.display = \"none\";\n    editContainer.style.display = \"flex\";\n    input.focus();\n    input.select();\n  }\n}\n\n// \nfunction cancelEditFilterName(index: number): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n\n  const displaySpan = container.querySelector(`.filter-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".filter-name-edit-container\") as HTMLElement;\n\n  if (displaySpan && editContainer) {\n    displaySpan.style.display = \"inline\";\n    editContainer.style.display = \"none\";\n  }\n}\n\n// \nfunction confirmEditFilterName(index: number, newName: string): void {\n  if (index < 0 || index >= filterConditionsList.length) return;\n\n  newName = newName.trim();\n  const oldName = filterConditionsList[index].name;\n\n  if (!newName || newName === oldName) {\n    cancelEditFilterName(index);\n    return;\n  }\n\n  // \n  filterConditionsList[index].name = newName;\n\n  // \n  updateFilterConditionsList();\n\n  showMessage(`: ${newName}`);\n}\n\n// \nasync function applyFilterCondition(index: number, sheetName: string): Promise<void> {\n  if (index < 0 || index >= filterConditionsList.length) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  const filterCondition = filterConditionsList[index];\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      // \n      const sheet = workbook.worksheets.getItem(filterCondition.config.sheetName);\n      sheet.activate();\n      sheet.load(\"name\");\n\n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"values, rowCount, columnCount, address, rowIndex\");\n      await context.sync();\n\n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      // usedRange.rowIndex  0-based 0\n      const startRow = usedRange.rowIndex + 1; //  1-based Excel \n      const endRow = startRow + usedRange.rowCount - 1;\n\n      // \n      currentMainReportConfig = {\n        dataRange: usedRange.address,\n        headerRow: startRow,\n        snColumn: filterCondition.config.snColumn,\n        amtColumn: filterCondition.config.amtColumn,\n        sheetName: sheet.name\n      };\n\n      // \n      const headerRow = usedRange.values[0];\n      filterPanelFields = [];\n\n      for (let colIdx = 0; colIdx < usedRange.columnCount; colIdx++) {\n        const headerText = headerRow[colIdx] ? String(headerRow[colIdx]) : getColumnName(colIdx);\n        const allValues = new Set<string>();\n\n        for (let rowIdx = 1; rowIdx < usedRange.values.length; rowIdx++) {\n          const cellValue = usedRange.values[rowIdx][colIdx];\n          const valueStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n          if (valueStr !== \"\") {\n            allValues.add(valueStr);\n          }\n        }\n\n        const sortedValues = Array.from(allValues).sort((a, b) => a.localeCompare(b, \"zh-CN\"));\n\n        // \n        const savedFilter = filterCondition.filterSettings.find(f => f.columnIndex === colIdx);\n\n        // \n        let selectedValues: Set<string>;\n        if (savedFilter && savedFilter.isFiltered) {\n          selectedValues = new Set<string>(savedFilter.filterValues.filter(v => allValues.has(v)));\n        } else {\n          selectedValues = new Set<string>(sortedValues);\n        }\n\n        filterPanelFields.push({\n          columnIndex: colIdx,\n          headerText: headerText,\n          allValues: sortedValues,\n          selectedValues: selectedValues,\n          isTimeField: false,\n          timeDimension: \"all\"\n        });\n      }\n\n      // \n      renderFilterPanel();\n\n      // \n      const applyBtn = document.getElementById(\"btn-apply-filter\") as HTMLButtonElement;\n      const clearBtn = document.getElementById(\"btn-clear-filter\") as HTMLButtonElement;\n      const saveBtn = document.getElementById(\"btn-save-filter\") as HTMLButtonElement;\n      const generateBtn = document.getElementById(\"btn-generate\") as HTMLButtonElement;\n      const resetBtn = document.getElementById(\"btn-reset-filter\") as HTMLButtonElement;\n      if (applyBtn) applyBtn.disabled = false;\n      if (clearBtn) clearBtn.disabled = false;\n      if (saveBtn) saveBtn.disabled = false;\n      if (generateBtn) generateBtn.disabled = false;\n      if (resetBtn) resetBtn.disabled = false;\n\n      // \n      const dataStartRow = startRow + 1;\n      for (let excelRow = dataStartRow; excelRow <= endRow; excelRow++) {\n        const row = sheet.getRange(`${excelRow}:${excelRow}`);\n        row.rowHidden = false;\n      }\n      await context.sync();\n\n      //  - \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n\n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n\n      // \n      if (filterEntries.length === 0) {\n        updateCurrentFilterDisplay([]);\n        showMessage(\"\");\n        return;\n      }\n\n      // \n      let hiddenCount = 0;\n      let visibleCount = 0;\n\n      for (let valueIdx = 1; valueIdx < usedRange.values.length; valueIdx++) {\n        const rowData = usedRange.values[valueIdx];\n        const excelRowNum = startRow + valueIdx; //  Excel \n        let shouldHide = false;\n\n        for (const filter of filterEntries) {\n          if (filter.colIdx < rowData.length) {\n            const cellValue = rowData[filter.colIdx];\n            const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n\n            if (!filter.allowedValues.has(cellStr)) {\n              shouldHide = true;\n              break;\n            }\n          }\n        }\n\n        if (shouldHide) {\n          const row = sheet.getRange(`${excelRowNum}:${excelRowNum}`);\n          row.rowHidden = true;\n          hiddenCount++;\n        } else {\n          visibleCount++;\n        }\n      }\n\n      await context.sync();\n\n      // \n      const filterSettings: ColumnFilterSetting[] = filterEntries.map(f => ({\n        columnIndex: f.colIdx,\n        columnName: getColumnName(f.colIdx),\n        headerText: f.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(f.allowedValues),\n        isFiltered: true\n      }));\n\n      updateCurrentFilterDisplay(filterSettings);\n\n      // \n      const filterSummary = filterEntries.map(f => `${f.headerText}(${f.allowedValues.size})`).join(\", \");\n      showMessage(`: ${filterSummary} | ${visibleCount}, ${hiddenCount}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    appendDebugLog(`: ${error.message}`);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction updateCurrentFilterDisplay(filterSettings: ColumnFilterSetting[]): void {\n  const container = document.getElementById(\"current-filter-display\");\n  if (!container) return;\n\n  const activeFilters = filterSettings.filter(f => f.isFiltered);\n\n  if (activeFilters.length === 0) {\n    container.innerHTML = '<div class=\"no-filters\"></div>';\n    return;\n  }\n\n  //  HTML\n  const filterItemsHtml = activeFilters.map((filter, index) => {\n    const values = filter.filterValues;\n    const totalCount = values.length;\n    const MAX_DISPLAY = 3; // 3\n\n    if (totalCount <= MAX_DISPLAY) {\n      // \n      return `\n        <div class=\"current-filter-item\">\n          <span class=\"filter-field\">${filter.headerText}</span>\n          <span class=\"filter-separator\"></span>\n          <span class=\"filter-value\">${values.join(\"\")}</span>\n        </div>\n      `;\n    } else {\n      //  + \"xxx\"\n      const displayValues = values.slice(0, MAX_DISPLAY);\n      const remainingCount = totalCount;\n      const filterId = `filter-expand-${index}`;\n\n      return `\n        <div class=\"current-filter-item\">\n          <span class=\"filter-field\">${filter.headerText}</span>\n          <span class=\"filter-separator\"></span>\n          <span class=\"filter-value-collapsed\" id=\"${filterId}-collapsed\">\n            ${displayValues.join(\"\")}\n            <a href=\"javascript:void(0)\" class=\"filter-expand-link\" onclick=\"expandFilterValues('${filterId}', ${index})\">${remainingCount}</a>\n          </span>\n          <span class=\"filter-value-expanded\" id=\"${filterId}-expanded\" style=\"display: none;\">\n            ${values.join(\"\")}\n            <a href=\"javascript:void(0)\" class=\"filter-collapse-link\" onclick=\"collapseFilterValues('${filterId}')\"></a>\n          </span>\n        </div>\n      `;\n    }\n  }).join(\"\");\n\n  container.innerHTML = `\n    <div class=\"current-filter-title\"></div>\n    <div class=\"current-filter-items\">\n      ${filterItemsHtml}\n    </div>\n  `;\n}\n\n// \nfunction expandFilterValues(filterId: string, _filterIndex: number): void {\n  const collapsedEl = document.getElementById(`${filterId}-collapsed`);\n  const expandedEl = document.getElementById(`${filterId}-expanded`);\n\n  if (collapsedEl && expandedEl) {\n    collapsedEl.style.display = \"none\";\n    expandedEl.style.display = \"inline\";\n  }\n}\n\n// \nfunction collapseFilterValues(filterId: string): void {\n  const collapsedEl = document.getElementById(`${filterId}-collapsed`);\n  const expandedEl = document.getElementById(`${filterId}-expanded`);\n\n  if (collapsedEl && expandedEl) {\n    collapsedEl.style.display = \"inline\";\n    expandedEl.style.display = \"none\";\n  }\n}\n\n//  onclick \n(window as any).expandFilterValues = expandFilterValues;\n(window as any).collapseFilterValues = collapseFilterValues;\n\n// \nfunction refreshCurrentFilterDisplay(): void {\n  const container = document.getElementById(\"current-filter-display\");\n  if (!container) return;\n\n  // \n  const columnFilterSettings: ColumnFilterSetting[] = [];\n\n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      const selectedValuesArray = Array.from(field.selectedValues);\n\n      //  updateCurrentFilterDisplay \n      columnFilterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: selectedValuesArray,  // \n        isFiltered: true\n      });\n    }\n  }\n\n  // \n  if (columnFilterSettings.length > 0) {\n    updateCurrentFilterDisplay(columnFilterSettings);\n  } else if (filterPanelFields.length > 0) {\n    // \n    container.innerHTML = '<div class=\"no-filters\"></div>';\n  } else {\n    // \n    container.innerHTML = '<div class=\"no-filters\">\"\"</div>';\n  }\n}\n\n// \nfunction deleteFilterCondition(index: number): void {\n  if (index >= 0 && index < filterConditionsList.length) {\n    filterConditionsList.splice(index, 1);\n    updateFilterConditionsList();\n    showMessage(\"\");\n  }\n}\n\n// \nasync function enableFilter(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const activeSheet = workbook.worksheets.getActiveWorksheet();\n      activeSheet.load(\"name\");\n\n      // \n      const usedRange = activeSheet.getUsedRange();\n      usedRange.load(\"values, rowCount, columnCount, address\");\n      await context.sync();\n\n      if (!usedRange.values || usedRange.values.length < 2) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      // \n      const headerRow = usedRange.values[0];\n\n      // \n      currentMainReportConfig = {\n        dataRange: usedRange.address,\n        headerRow: 1,\n        snColumn: currentMainReportConfig?.snColumn || 0,\n        amtColumn: currentMainReportConfig?.amtColumn || 0,\n        sheetName: activeSheet.name\n      };\n\n      // \n      filterPanelFields = [];\n\n      // \n      for (let colIdx = 0; colIdx < usedRange.columnCount; colIdx++) {\n        const headerText = headerRow[colIdx] ? String(headerRow[colIdx]) : getColumnName(colIdx);\n        const allValues = new Set<string>();\n\n        // \n        for (let rowIdx = 1; rowIdx < usedRange.values.length; rowIdx++) {\n          const cellValue = usedRange.values[rowIdx][colIdx];\n          const valueStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n          if (valueStr !== \"\") {\n            allValues.add(valueStr);\n          }\n        }\n\n        //  Set \n        const sortedValues = Array.from(allValues).sort((a, b) => a.localeCompare(b, \"zh-CN\"));\n\n        filterPanelFields.push({\n          columnIndex: colIdx,\n          headerText: headerText,\n          allValues: sortedValues,\n          selectedValues: new Set<string>(sortedValues), // \n          isTimeField: false,\n          timeDimension: \"all\"\n        });\n      }\n\n      // \n      renderFilterPanel();\n\n      // \n      const applyBtn = document.getElementById(\"btn-apply-filter\") as HTMLButtonElement;\n      const clearBtn = document.getElementById(\"btn-clear-filter\") as HTMLButtonElement;\n      const saveBtn = document.getElementById(\"btn-save-filter\") as HTMLButtonElement;\n      const generateBtn = document.getElementById(\"btn-generate\") as HTMLButtonElement;\n      const resetBtn = document.getElementById(\"btn-reset-filter\") as HTMLButtonElement;\n      if (applyBtn) applyBtn.disabled = false;\n      if (clearBtn) clearBtn.disabled = false;\n      if (saveBtn) saveBtn.disabled = false;\n      if (generateBtn) generateBtn.disabled = false;\n      if (resetBtn) resetBtn.disabled = false;\n\n      // \n      updateMainReportConfigDisplay();\n\n      showMessage(` ${filterPanelFields.length} `);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \n// \nlet activeFilterFieldIndex: number = -1;\n\nfunction renderFilterPanel(): void {\n  const panel = document.getElementById(\"filter-panel\");\n  if (!panel) return;\n\n  if (filterPanelFields.length === 0) {\n    panel.innerHTML = '<div class=\"filter-panel-hint\">\"\"</div>';\n    return;\n  }\n\n  // \n  let tagsHtml = '<div class=\"filter-tags-container\">';\n\n  for (let i = 0; i < filterPanelFields.length; i++) {\n    const field = filterPanelFields[i];\n    const selectedCount = field.selectedValues.size;\n    const totalCount = field.allValues.length;\n    const isFiltered = selectedCount < totalCount;\n    const isActive = i === activeFilterFieldIndex;\n\n    let tagClass = \"filter-tag\";\n    if (isFiltered) tagClass += \" filtered\";\n    if (isActive) tagClass += \" active\";\n    if (field.isTimeField) tagClass += \" time-field\";\n\n    tagsHtml += `\n      <div class=\"${tagClass}\" data-field-index=\"${i}\">\n        <span class=\"filter-tag-name\">${escapeHtml(field.headerText)}</span>\n        <span class=\"filter-tag-count\">${isFiltered ? selectedCount + '/' : ''}${totalCount}</span>\n        <span class=\"time-field-toggle ${field.isTimeField ? 'active' : ''}\" \n              data-field-index=\"${i}\" title=\"\">T</span>\n      </div>\n    `;\n  }\n\n  tagsHtml += '</div>';\n\n  // \n  let dropdownHtml = '';\n\n  if (activeFilterFieldIndex >= 0 && activeFilterFieldIndex < filterPanelFields.length) {\n    const field = filterPanelFields[activeFilterFieldIndex];\n    const fieldId = `filter-field-${activeFilterFieldIndex}`;\n\n    // \n    let timeDimensionHtml = '';\n    if (field.isTimeField) {\n      timeDimensionHtml = `\n        <div class=\"time-dimension-selector\">\n          <span class=\"time-dimension-label\"></span>\n          <select class=\"time-dimension-select\" id=\"${fieldId}-dimension\" data-field-index=\"${activeFilterFieldIndex}\">\n            <option value=\"all\" ${field.timeDimension === 'all' ? 'selected' : ''}></option>\n            <option value=\"year\" ${field.timeDimension === 'year' ? 'selected' : ''}></option>\n            <option value=\"month\" ${field.timeDimension === 'month' ? 'selected' : ''}></option>\n            <option value=\"day\" ${field.timeDimension === 'day' ? 'selected' : ''}></option>\n          </select>\n        </div>\n      `;\n    }\n\n    dropdownHtml = `\n      <div class=\"filter-dropdown show\" data-field-index=\"${activeFilterFieldIndex}\">\n        <div class=\"filter-dropdown-header\">\n          <span class=\"filter-dropdown-title\">${escapeHtml(field.headerText)} </span>\n          <button class=\"filter-dropdown-close\" id=\"btn-close-dropdown\"></button>\n        </div>\n        ${timeDimensionHtml}\n        <input type=\"text\" class=\"filter-field-search\" placeholder=\"...\" \n               id=\"${fieldId}-search\" data-field-index=\"${activeFilterFieldIndex}\">\n        <div class=\"filter-options-container\" id=\"${fieldId}-options\">\n    `;\n\n    // \n    let displayValues: string[] = field.allValues;\n    if (field.isTimeField && field.timeDimension !== 'all' && field.timeValues) {\n      displayValues = field.timeValues[field.timeDimension] || field.allValues;\n    }\n\n    for (let j = 0; j < displayValues.length; j++) {\n      const value = displayValues[j];\n      const isSelected = field.selectedValues.has(value);\n      const displayValue = value.length > 40 ? value.substring(0, 40) + \"...\" : value;\n\n      dropdownHtml += `\n        <div class=\"filter-option ${isSelected ? 'selected' : ''}\" \n             data-field-index=\"${activeFilterFieldIndex}\" data-value-index=\"${j}\" data-value=\"${escapeHtml(value)}\">\n          <input type=\"checkbox\" ${isSelected ? 'checked' : ''} \n                 id=\"${fieldId}-opt-${j}\" data-field-index=\"${activeFilterFieldIndex}\" data-value=\"${escapeHtml(value)}\">\n          <span class=\"filter-option-label\" title=\"${escapeHtml(value)}\">${escapeHtml(displayValue)}</span>\n        </div>\n      `;\n    }\n\n    dropdownHtml += `\n        </div>\n        <div class=\"filter-select-actions\" id=\"${fieldId}-actions\">\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"all\"></button>\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"none\"></button>\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"invert\"></button>\n        </div>\n        <div class=\"filter-search-hint\" id=\"${fieldId}-search-hint\" style=\"display: none;\">\n          <i class=\"ms-Icon ms-Icon--Info\" aria-hidden=\"true\"></i>\n          <span></span>\n        </div>\n      </div>\n    `;\n  }\n\n  panel.innerHTML = tagsHtml + dropdownHtml;\n\n  //  panel \n}\n\n// HTML \nfunction escapeHtml(text: string): string {\n  const div = document.createElement(\"div\");\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n// ========================================\n// \n// ========================================\n\n// \nasync function toggleTimeField(fieldIndex: number): Promise<void> {\n  if (fieldIndex < 0 || fieldIndex >= filterPanelFields.length) return;\n\n  const field = filterPanelFields[fieldIndex];\n  field.isTimeField = !field.isTimeField;\n\n  if (field.isTimeField) {\n    // \n    showMessage(`\"${field.headerText}\"`);\n    await checkTimeFieldFormat(fieldIndex);\n  } else {\n    // \n    field.timeDimension = \"all\";\n    field.timeValues = undefined;\n    showMessage(`\"${field.headerText}\"`);\n  }\n\n  renderFilterPanel();\n}\n\n// \nasync function checkTimeFieldFormat(fieldIndex: number): Promise<void> {\n  if (fieldIndex < 0 || fieldIndex >= filterPanelFields.length) return;\n\n  const field = filterPanelFields[fieldIndex];\n  if (!currentMainReportConfig) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  showProgress(\"\", \"...\");\n\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"values, rowCount\");\n      await context.sync();\n\n      const colIndex = field.columnIndex;\n      const rowCount = usedRange.rowCount;\n\n      let standardCount = 0;\n      let nonStandardCount = 0;\n      const nonStandardRows: number[] = [];\n      const nonStandardValues: string[] = [];\n\n      // \n      for (let i = 1; i < rowCount; i++) { // \n        const cellValue = usedRange.values[i][colIndex];\n\n        // \n        if (i % 100 === 0) {\n          updateProgress(i, rowCount, ` ${i}/${rowCount} `);\n        }\n\n        if (cellValue === null || cellValue === undefined || cellValue === \"\") {\n          continue;\n        }\n\n        const isStandard = isStandardDateFormat(cellValue);\n        if (isStandard) {\n          standardCount++;\n        } else {\n          nonStandardCount++;\n          if (nonStandardRows.length < 10) { // 10\n            nonStandardRows.push(i + 1); // Excel \n            nonStandardValues.push(String(cellValue));\n          }\n        }\n      }\n\n      updateProgress(rowCount, rowCount, \"\");\n      hideProgress();\n\n      // \n      calculateTimeValues(fieldIndex, usedRange.values, colIndex);\n\n      // \n      if (nonStandardCount === 0) {\n        showMessage(`\"${field.headerText}\" ${standardCount} `);\n      } else {\n        // \n        const examples = nonStandardValues.slice(0, 3).join(\"\");\n        const confirmMsg = `\"${field.headerText}\" ${nonStandardCount} ${examples}...\\n`;\n\n        if (confirm(confirmMsg)) {\n          await convertTimeFormat(fieldIndex, usedRange, sheet, context);\n        } else {\n          showMessage(` ${nonStandardCount} `);\n        }\n      }\n    });\n  } catch (error) {\n    hideProgress();\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction isStandardDateFormat(value: any): boolean {\n  if (value === null || value === undefined || value === \"\") {\n    return true; // \n  }\n\n  // Excel \n  if (typeof value === \"number\") {\n    return true;\n  }\n\n  const str = String(value).trim();\n\n  // \n  const standardPatterns = [\n    /^\\d{4}[-/]\\d{1,2}[-/]\\d{1,2}$/,  // 2024-01-15  2024/01/15\n    /^\\d{4}[-/]\\d{1,2}[-/]\\d{1,2}\\s+\\d{1,2}:\\d{2}(:\\d{2})?$/,  // 2024-01-15 10:30  2024-01-15 10:30:00\n    /^\\d{1,2}[-/]\\d{1,2}[-/]\\d{4}$/,  // 01-15-2024  01/15/2024\n    /^\\d{4}\\d{1,2}\\d{1,2}$/,    // 2024115\n  ];\n\n  for (const pattern of standardPatterns) {\n    if (pattern.test(str)) {\n      return true;\n    }\n  }\n\n  // \n  const date = new Date(str);\n  if (!isNaN(date.getTime())) {\n    return true;\n  }\n\n  return false;\n}\n\n// \nasync function convertTimeFormat(\n  fieldIndex: number,\n  usedRange: Excel.Range,\n  sheet: Excel.Worksheet,\n  context: Excel.RequestContext\n): Promise<void> {\n  const field = filterPanelFields[fieldIndex];\n  const colIndex = field.columnIndex;\n  const colName = getColumnName(colIndex);\n\n  showProgress(\"\", \"...\");\n\n  let convertedCount = 0;\n  const rowCount = usedRange.values.length;\n\n  for (let i = 1; i < rowCount; i++) { // \n    const cellValue = usedRange.values[i][colIndex];\n\n    if (i % 50 === 0) {\n      updateProgress(i, rowCount, ` ${i}/${rowCount} `);\n    }\n\n    if (cellValue === null || cellValue === undefined || cellValue === \"\") {\n      continue;\n    }\n\n    if (!isStandardDateFormat(cellValue)) {\n      // \n      const converted = tryConvertToDate(cellValue);\n      if (converted) {\n        const excelRow = i + 1; // Excel \n        const cellAddress = `${colName}${excelRow}`;\n        const cell = sheet.getRange(cellAddress);\n        cell.values = [[converted]];\n        cell.format.font.color = \"#7b1fa2\"; // \n        convertedCount++;\n      }\n    }\n  }\n\n  await context.sync();\n\n  updateProgress(rowCount, rowCount, \"\");\n  hideProgress();\n\n  // \n  await recalculateTimeValues(fieldIndex);\n\n  showMessage(` ${convertedCount} `);\n}\n\n// \nfunction tryConvertToDate(value: any): string | null {\n  const str = String(value).trim();\n\n  // \n  // 1: 20240115 -> 2024-01-15\n  if (/^\\d{8}$/.test(str)) {\n    return `${str.slice(0, 4)}-${str.slice(4, 6)}-${str.slice(6, 8)}`;\n  }\n\n  // 2: 2024.01.15 -> 2024-01-15\n  if (/^\\d{4}\\.\\d{1,2}\\.\\d{1,2}$/.test(str)) {\n    return str.replace(/\\./g, \"-\");\n  }\n\n  // 3: 15-01-2024 (--) -> 2024-01-15\n  const dmyMatch = str.match(/^(\\d{1,2})[-/](\\d{1,2})[-/](\\d{4})$/);\n  if (dmyMatch) {\n    const [, day, month, year] = dmyMatch;\n    return `${year}-${month.padStart(2, \"0\")}-${day.padStart(2, \"0\")}`;\n  }\n\n  // 4: 2024115 -> 2024-01-15\n  const cnMatch = str.match(/^(\\d{4})(\\d{1,2})(\\d{1,2})?$/);\n  if (cnMatch) {\n    const [, year, month, day] = cnMatch;\n    return `${year}-${month.padStart(2, \"0\")}-${day.padStart(2, \"0\")}`;\n  }\n\n  // 5: Jan 15, 2024  January 15, 2024 -> 2024-01-15\n  const enMonths: { [key: string]: string } = {\n    \"jan\": \"01\", \"january\": \"01\",\n    \"feb\": \"02\", \"february\": \"02\",\n    \"mar\": \"03\", \"march\": \"03\",\n    \"apr\": \"04\", \"april\": \"04\",\n    \"may\": \"05\",\n    \"jun\": \"06\", \"june\": \"06\",\n    \"jul\": \"07\", \"july\": \"07\",\n    \"aug\": \"08\", \"august\": \"08\",\n    \"sep\": \"09\", \"september\": \"09\",\n    \"oct\": \"10\", \"october\": \"10\",\n    \"nov\": \"11\", \"november\": \"11\",\n    \"dec\": \"12\", \"december\": \"12\"\n  };\n\n  const enMatch = str.toLowerCase().match(/^([a-z]+)\\s+(\\d{1,2}),?\\s+(\\d{4})$/);\n  if (enMatch) {\n    const [, monthStr, day, year] = enMatch;\n    const month = enMonths[monthStr];\n    if (month) {\n      return `${year}-${month}-${day.padStart(2, \"0\")}`;\n    }\n  }\n\n  //  Date \n  const date = new Date(str);\n  if (!isNaN(date.getTime())) {\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, \"0\");\n    const day = String(date.getDate()).padStart(2, \"0\");\n    return `${year}-${month}-${day}`;\n  }\n\n  return null;\n}\n\n// \nfunction calculateTimeValues(fieldIndex: number, values: any[][], colIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n\n  const years = new Set<string>();\n  const months = new Set<string>();\n  const days = new Set<string>();\n\n  for (let i = 1; i < values.length; i++) {\n    const cellValue = values[i][colIndex];\n    if (cellValue === null || cellValue === undefined || cellValue === \"\") {\n      continue;\n    }\n\n    const dateInfo = extractDateInfo(cellValue);\n    if (dateInfo) {\n      years.add(dateInfo.year);\n      months.add(dateInfo.yearMonth);\n      days.add(dateInfo.date);\n    }\n  }\n\n  field.timeValues = {\n    year: Array.from(years).sort(),\n    month: Array.from(months).sort(),\n    day: Array.from(days).sort()\n  };\n}\n\n// \nfunction extractDateInfo(value: any): { year: string; yearMonth: string; date: string } | null {\n  let date: Date | null = null;\n\n  if (typeof value === \"number\") {\n    // Excel \n    date = excelDateToJSDate(value);\n  } else {\n    const str = String(value).trim();\n    date = new Date(str);\n\n    // \n    if (isNaN(date.getTime())) {\n      //  YYYYMMDD \n      if (/^\\d{8}$/.test(str)) {\n        const y = parseInt(str.slice(0, 4));\n        const m = parseInt(str.slice(4, 6)) - 1;\n        const d = parseInt(str.slice(6, 8));\n        date = new Date(y, m, d);\n      }\n    }\n  }\n\n  if (!date || isNaN(date.getTime())) {\n    return null;\n  }\n\n  const year = String(date.getFullYear());\n  const month = String(date.getMonth() + 1).padStart(2, \"0\");\n  const day = String(date.getDate()).padStart(2, \"0\");\n\n  return {\n    year: year,\n    yearMonth: `${year}-${month}`,\n    date: `${year}-${month}-${day}`\n  };\n}\n\n// Excel  JS Date\nfunction excelDateToJSDate(excelDate: number): Date {\n  // Excel  1900-01-01  1\n  //  Excel  1900 \n  const excelEpoch = new Date(1899, 11, 30); // 1899-12-30\n  const msPerDay = 24 * 60 * 60 * 1000;\n  return new Date(excelEpoch.getTime() + excelDate * msPerDay);\n}\n\n// \nasync function recalculateTimeValues(fieldIndex: number): Promise<void> {\n  if (!currentMainReportConfig) return;\n\n  const field = filterPanelFields[fieldIndex];\n\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"values\");\n      await context.sync();\n\n      calculateTimeValues(fieldIndex, usedRange.values, field.columnIndex);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nfunction changeTimeDimension(fieldIndex: number, dimension: TimeDimension): void {\n  if (fieldIndex < 0 || fieldIndex >= filterPanelFields.length) return;\n\n  const field = filterPanelFields[fieldIndex];\n  field.timeDimension = dimension;\n\n  //  selectedValues\n  if (dimension === \"all\") {\n    // \n    field.selectedValues = new Set<string>(field.allValues);\n  } else if (field.timeValues && field.timeValues[dimension]) {\n    // \n    field.selectedValues = new Set<string>(field.timeValues[dimension]);\n  }\n\n  renderFilterPanel();\n  showMessage(`\"${field.headerText}\"${getDimensionLabel(dimension)}`);\n}\n\n// \nfunction getDimensionLabel(dimension: TimeDimension): string {\n  switch (dimension) {\n    case \"year\": return \"\";\n    case \"month\": return \"\";\n    case \"day\": return \"\";\n    default: return \"\";\n  }\n}\n\n// ========================================\n// \n// ========================================\n\n// \nlet filterPanelEventsBound = false;\n\n// \nfunction bindFilterPanelEvents(): void {\n  const panel = document.getElementById(\"filter-panel\");\n  if (!panel || filterPanelEventsBound) return;\n\n  filterPanelEventsBound = true;\n  console.log(\"[] \");\n\n  // \n  panel.addEventListener(\"click\", (e) => {\n    const target = e.target as HTMLElement;\n\n    // 0. T - \n    if (target.classList.contains(\"time-field-toggle\")) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"-1\", 10);\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        toggleTimeField(fieldIndex);\n      }\n      return;\n    }\n\n    // 1.  - \n    const tagElement = target.closest(\".filter-tag\") as HTMLElement;\n    if (tagElement && !target.classList.contains(\"time-field-toggle\")) {\n      const fieldIndex = parseInt(tagElement.getAttribute(\"data-field-index\") || \"-1\", 10);\n\n      if (fieldIndex === activeFilterFieldIndex) {\n        activeFilterFieldIndex = -1;\n      } else {\n        activeFilterFieldIndex = fieldIndex;\n\n        // \n        if (filterPanelFields[fieldIndex].isTimeField) {\n          checkTimeFieldFormat(fieldIndex);\n        }\n      }\n\n      renderFilterPanel();\n      return;\n    }\n\n    // 2. \n    if (target.id === \"btn-close-dropdown\" || target.closest(\"#btn-close-dropdown\")) {\n      activeFilterFieldIndex = -1;\n      renderFilterPanel();\n      return;\n    }\n\n    // 3. //\n    const actionButton = target.closest(\".filter-select-action\") as HTMLElement;\n    if (actionButton) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const fieldIndex = parseInt(actionButton.getAttribute(\"data-field-index\") || \"0\", 10);\n      const action = actionButton.getAttribute(\"data-action\");\n\n      console.log(`[] action=${action}, fieldIndex=${fieldIndex}`);\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        const field = filterPanelFields[fieldIndex];\n\n        // \n        const searchInput = document.getElementById(`filter-field-${fieldIndex}-search`) as HTMLInputElement;\n        const searchText = searchInput ? searchInput.value.trim() : \"\";\n        const isSearchMode = searchText.length > 0;\n\n        console.log(`[] isSearchMode=${isSearchMode}, searchText=\"${searchText}\"`);\n        console.log(`[]  selectedValues.size=${field.selectedValues.size}, allValues.length=${field.allValues.length}`);\n\n        if (isSearchMode) {\n          // \n          const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n          const visibleValues: string[] = [];\n          if (optionsContainer) {\n            const options = optionsContainer.querySelectorAll(\".filter-option:not(.hidden)\");\n            options.forEach((option) => {\n              const valueIndexStr = option.getAttribute(\"data-value-index\");\n              const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n              const value = valueIndex >= 0 && valueIndex < field.allValues.length\n                ? field.allValues[valueIndex]\n                : option.getAttribute(\"data-value\") || \"\";\n              visibleValues.push(value);\n            });\n          }\n\n          console.log(`[] : ${visibleValues.length}`);\n\n          if (action === \"all\") {\n            for (const v of visibleValues) {\n              field.selectedValues.add(v);\n            }\n          } else if (action === \"none\") {\n            for (const v of visibleValues) {\n              field.selectedValues.delete(v);\n            }\n          } else if (action === \"invert\") {\n            for (const v of visibleValues) {\n              if (field.selectedValues.has(v)) {\n                field.selectedValues.delete(v);\n              } else {\n                field.selectedValues.add(v);\n              }\n            }\n          }\n        } else {\n          // \n          console.log(`[]  ${field.allValues.length} `);\n\n          if (action === \"all\") {\n            field.selectedValues = new Set<string>(field.allValues);\n          } else if (action === \"none\") {\n            field.selectedValues = new Set<string>();\n          } else if (action === \"invert\") {\n            const newSelected = new Set<string>();\n            for (const v of field.allValues) {\n              if (!field.selectedValues.has(v)) {\n                newSelected.add(v);\n              }\n            }\n            console.log(`[]  ${field.selectedValues.size}  ${newSelected.size} `);\n            field.selectedValues = newSelected;\n          }\n        }\n\n        console.log(`[]  selectedValues.size=${field.selectedValues.size}`);\n\n        // \n        updateFieldOptions(fieldIndex);\n        // \n        updateTagCount(fieldIndex);\n      }\n      return;\n    }\n\n    // 4. \n    const optionDiv = target.closest(\".filter-option\") as HTMLElement;\n    if (optionDiv && target.tagName !== \"INPUT\") {\n      const fieldIndex = parseInt(optionDiv.getAttribute(\"data-field-index\") || \"0\", 10);\n      const checkbox = optionDiv.querySelector(\"input[type='checkbox']\") as HTMLInputElement;\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length && checkbox) {\n        const field = filterPanelFields[fieldIndex];\n\n        //  data-value-index \n        const valueIndexStr = optionDiv.getAttribute(\"data-value-index\");\n        const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n        const value = valueIndex >= 0 && valueIndex < field.allValues.length\n          ? field.allValues[valueIndex]\n          : optionDiv.getAttribute(\"data-value\") || \"\";\n\n        // \n        const newChecked = !checkbox.checked;\n        checkbox.checked = newChecked;\n\n        if (newChecked) {\n          field.selectedValues.add(value);\n        } else {\n          field.selectedValues.delete(value);\n        }\n\n        //  selected \n        optionDiv.classList.toggle(\"selected\", newChecked);\n\n        // \n        updateTagCount(fieldIndex);\n      }\n      return;\n    }\n  });\n\n  // \n  panel.addEventListener(\"input\", (e) => {\n    const target = e.target as HTMLInputElement;\n    if (target.classList.contains(\"filter-field-search\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"0\", 10);\n      filterSearchOptions(fieldIndex, target.value);\n    }\n  });\n\n  //  change \n  panel.addEventListener(\"change\", (e) => {\n    const target = e.target as HTMLInputElement;\n    if (target.type === \"checkbox\" && target.closest(\".filter-option\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"0\", 10);\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        const field = filterPanelFields[fieldIndex];\n\n        //  data-value-index \n        const optionDiv = target.closest(\".filter-option\") as HTMLElement;\n        let value = target.getAttribute(\"data-value\") || \"\";\n        if (optionDiv) {\n          const valueIndexStr = optionDiv.getAttribute(\"data-value-index\");\n          const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n          if (valueIndex >= 0 && valueIndex < field.allValues.length) {\n            value = field.allValues[valueIndex];\n          }\n        }\n\n        if (target.checked) {\n          field.selectedValues.add(value);\n        } else {\n          field.selectedValues.delete(value);\n        }\n\n        //  selected \n        if (optionDiv) {\n          optionDiv.classList.toggle(\"selected\", target.checked);\n        }\n\n        // \n        updateTagCount(fieldIndex);\n      }\n    }\n\n    //  change \n    if (target.classList.contains(\"time-dimension-select\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"-1\", 10);\n      const selectEl = target as unknown as HTMLSelectElement;\n      const dimension = selectEl.value as TimeDimension;\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        changeTimeDimension(fieldIndex, dimension);\n      }\n    }\n  });\n}\n\n// \nfunction updateTagCount(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  if (!field) return;\n\n  const tag = document.querySelector(`.filter-tag[data-field-index=\"${fieldIndex}\"]`);\n  if (!tag) return;\n\n  const selectedCount = field.selectedValues.size;\n  const totalCount = field.allValues.length;\n  const isFiltered = selectedCount < totalCount;\n\n  // \n  tag.classList.toggle(\"filtered\", isFiltered);\n\n  // \n  const countSpan = tag.querySelector(\".filter-tag-count\");\n  if (countSpan) {\n    countSpan.textContent = isFiltered ? `${selectedCount}/${totalCount}` : `${totalCount}`;\n  }\n}\n\n// \nfunction filterSearchOptions(fieldIndex: number, searchText: string): void {\n  const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n  const actionsContainer = document.getElementById(`filter-field-${fieldIndex}-actions`);\n  const searchHint = document.getElementById(`filter-field-${fieldIndex}-search-hint`);\n  if (!optionsContainer) return;\n\n  const options = optionsContainer.querySelectorAll(\".filter-option\");\n  const searchLower = searchText.toLowerCase().trim();\n  const hasSearchText = searchLower.length > 0;\n\n  let visibleCount = 0;\n  options.forEach((option) => {\n    const value = option.getAttribute(\"data-value\") || \"\";\n    const matches = value.toLowerCase().includes(searchLower);\n    option.classList.toggle(\"hidden\", !matches);\n    if (matches) visibleCount++;\n  });\n\n  // \n  if (actionsContainer) {\n    actionsContainer.classList.toggle(\"search-mode\", hasSearchText);\n  }\n  if (searchHint) {\n    searchHint.style.display = hasSearchText ? \"flex\" : \"none\";\n    // \n    const hintSpan = searchHint.querySelector(\"span\");\n    if (hintSpan && hasSearchText) {\n      hintSpan.textContent = `${visibleCount} `;\n    }\n  }\n}\n\n// /\nfunction updateFieldOptions(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n  if (!optionsContainer || !field) return;\n\n  const options = optionsContainer.querySelectorAll(\".filter-option\");\n  options.forEach((option) => {\n    //  data-value-index  HTML \n    const valueIndexStr = option.getAttribute(\"data-value-index\");\n    const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n    const value = valueIndex >= 0 && valueIndex < field.allValues.length\n      ? field.allValues[valueIndex]\n      : option.getAttribute(\"data-value\") || \"\";\n\n    const isSelected = field.selectedValues.has(value);\n    const checkbox = option.querySelector(\"input[type='checkbox']\") as HTMLInputElement;\n    if (checkbox) {\n      checkbox.checked = isSelected;\n    }\n    option.classList.toggle(\"selected\", isSelected);\n  });\n\n  console.log(`[updateFieldOptions] fieldIndex=${fieldIndex},  ${options.length} `);\n}\n\n// \nfunction updateFieldCountDisplay(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  const fieldGroup = document.querySelector(`[data-field-index=\"${fieldIndex}\"].filter-field-group`);\n  if (!fieldGroup || !field) return;\n\n  const label = fieldGroup.querySelector(\".filter-field-label\");\n  if (label) {\n    const selectedCount = field.selectedValues.size;\n    const totalCount = field.allValues.length;\n    const isFiltered = selectedCount < totalCount;\n\n    label.innerHTML = `\n      ${field.headerText} \n      <span style=\"font-weight: normal; color: ${isFiltered ? '#0078d4' : '#605e5c'};\">\n        (${selectedCount}/${totalCount})\n      </span>\n    `;\n  }\n}\n\n//  Excel\nasync function applyFilterFromPanel(): Promise<void> {\n  if (filterPanelFields.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  showMessage(\"...\", false);\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      let targetSheet: Excel.Worksheet;\n\n      if (currentMainReportConfig) {\n        targetSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n      } else {\n        targetSheet = workbook.worksheets.getActiveWorksheet();\n      }\n\n      targetSheet.activate();\n\n      // \n      const usedRange = targetSheet.getUsedRange();\n      usedRange.load(\"values, rowCount, rowIndex, columnCount\");\n      await context.sync();\n\n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      const startRow = usedRange.rowIndex; // 0-based\n      const rowCount = usedRange.rowCount;\n      const columnCount = usedRange.columnCount;\n\n      // \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n\n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n\n      // =====  =====\n      const rowVisibility: boolean[] = []; // true = , false = \n      rowVisibility.push(true); // \n\n      let visibleCount = 0;\n      let hiddenCount = 0;\n      let totalAmount = 0; // \n\n      // \n      const amtColIndex = currentMainReportConfig?.amtColumn ?? -1;\n\n      // \n      for (let valueIdx = 1; valueIdx < usedRange.values.length; valueIdx++) {\n        const rowData = usedRange.values[valueIdx];\n        let shouldShow = true;\n\n        if (filterEntries.length > 0) {\n          for (const filter of filterEntries) {\n            if (filter.colIdx < rowData.length) {\n              const cellValue = rowData[filter.colIdx];\n              const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n\n              if (!filter.allowedValues.has(cellStr)) {\n                shouldShow = false;\n                break;\n              }\n            }\n          }\n        }\n\n        rowVisibility.push(shouldShow);\n        if (shouldShow) {\n          visibleCount++;\n          // \n          if (amtColIndex >= 0 && amtColIndex < rowData.length) {\n            const amountValue = rowData[amtColIndex];\n            totalAmount += cleanAmount(amountValue);\n          }\n        } else {\n          hiddenCount++;\n        }\n      }\n\n      // \n      currentFilterStatistics = {\n        filteredRowCount: visibleCount,\n        totalAmount: totalAmount,\n        isValid: true\n      };\n\n      // =====  =====\n      // \n      const allDataRowsStart = startRow + 2; // Excel \n      const allDataRowsEnd = startRow + rowCount;\n      if (allDataRowsEnd >= allDataRowsStart) {\n        const allDataRows = targetSheet.getRange(`${allDataRowsStart}:${allDataRowsEnd}`);\n        allDataRows.rowHidden = false;\n      }\n      await context.sync();\n\n      // \n      // \n      let i = 1; // \n      let hiddenRangeCount = 0;\n      while (i < rowVisibility.length) {\n        if (!rowVisibility[i]) {\n          // \n          let endIdx = i;\n\n          // \n          while (endIdx + 1 < rowVisibility.length && !rowVisibility[endIdx + 1]) {\n            endIdx++;\n          }\n\n          // \n          const rangeStartRow = startRow + i + 1; // Excel  (1-based)\n          const rangeEndRow = startRow + endIdx + 1;\n          const range = targetSheet.getRange(`${rangeStartRow}:${rangeEndRow}`);\n          range.rowHidden = true;\n          hiddenRangeCount++;\n\n          i = endIdx + 1;\n        } else {\n          i++;\n        }\n      }\n\n      await context.sync();\n\n      // \n      appendDebugLog(`:  ${hiddenRangeCount} ,  ${hiddenCount} `);\n      appendDebugLog(`: Excel  ${startRow + 1} ,  ${rowCount} `);\n\n      // =====  =====\n      // \n      const dataRange = targetSheet.getRangeByIndexes(startRow + 1, 0, rowCount - 1, columnCount);\n      dataRange.format.rowHeight = 20; //  20 \n      await context.sync();\n\n      // \n      const filterSettings: ColumnFilterSetting[] = filterEntries.map(f => ({\n        columnIndex: f.colIdx,\n        columnName: getColumnName(f.colIdx),\n        headerText: f.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(f.allowedValues),\n        isFiltered: true\n      }));\n\n      updateCurrentFilterDisplay(filterSettings);\n\n      // \n      updateFilterTextDisplay();\n      await copyFilterTextToClipboard();\n\n      // \n      const filterSummary = filterEntries.map(f => {\n        const count = f.allowedValues.size;\n        return `${f.headerText}(${count})`;\n      }).join(\", \");\n\n      showMessage(`: ${filterSummary} | ${visibleCount}, ${hiddenCount}`);\n      appendDebugLog(`: ${filterSummary}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function clearFilterFromPanel(): Promise<void> {\n  // \n  for (const field of filterPanelFields) {\n    field.selectedValues = new Set<string>(field.allValues);\n  }\n\n  // \n  currentFilterStatistics = {\n    filteredRowCount: 0,\n    totalAmount: 0,\n    isValid: false\n  };\n\n  // \n  renderFilterPanel();\n\n  // \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      let targetSheet: Excel.Worksheet;\n\n      if (currentMainReportConfig) {\n        targetSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n      } else {\n        targetSheet = workbook.worksheets.getActiveWorksheet();\n      }\n\n      const usedRange = targetSheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex, columnCount\");\n      await context.sync();\n\n      // \n      const dataRowCount = usedRange.rowCount - 1;\n      if (dataRowCount > 0) {\n        const startRowNum = usedRange.rowIndex + 2; // Excel \n        const endRowNum = usedRange.rowIndex + usedRange.rowCount;\n        const allDataRows = targetSheet.getRange(`${startRowNum}:${endRowNum}`);\n        allDataRows.rowHidden = false;\n\n        // \n        allDataRows.format.rowHeight = 20;\n      }\n      await context.sync();\n\n      updateCurrentFilterDisplay([]);\n\n      // \n      const filterTextContainer = document.getElementById(\"filter-text-container\");\n      if (filterTextContainer) {\n        filterTextContainer.style.display = \"none\";\n      }\n\n      showMessage(\"\");\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction saveFilterFromPanel(): void {\n  if (filterPanelFields.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  const filterSettings: ColumnFilterSetting[] = [];\n\n  for (const field of filterPanelFields) {\n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      filterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(field.selectedValues),\n        isFiltered: true\n      });\n    }\n  }\n\n  if (filterSettings.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  const filterCondition: FilterCondition = {\n    id: `filter_${Date.now()}`,\n    name: `_${new Date().toLocaleString(\"zh-CN\", { month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\" })}`,\n    createTime: new Date().toISOString(),\n    sheetName: currentMainReportConfig?.sheetName || \"\",\n    filterSettings: filterSettings,\n    config: currentMainReportConfig ? { ...currentMainReportConfig } : {\n      dataRange: \"\",\n      headerRow: 1,\n      snColumn: 0,\n      amtColumn: 0,\n      sheetName: \"\"\n    }\n  };\n\n  filterConditionsList.unshift(filterCondition);\n  updateFilterConditionsList();\n\n  const filterSummary = filterSettings.map(f => `${f.headerText}(${f.filterValues.length})`).join(\", \");\n  showMessage(`: ${filterSummary}`);\n}\n\n// \nasync function saveCurrentFilterCondition(): Promise<void> {\n  // \n  const columnFilterSettings: ColumnFilterSetting[] = [];\n\n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      columnFilterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(field.selectedValues),\n        isFiltered: true\n      });\n\n      appendDebugLog(` - ${field.headerText}: ${field.selectedValues.size}/${field.allValues.length}`);\n    }\n  }\n\n  // \n  if (columnFilterSettings.length === 0) {\n    appendDebugLog(\"\");\n    return;\n  }\n\n  // \n  const filterCondition: FilterCondition = {\n    id: `filter_${Date.now()}`,\n    name: `_${new Date().toLocaleString(\"zh-CN\", { month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\" })}`,\n    createTime: new Date().toISOString(),\n    sheetName: currentMainReportConfig?.sheetName || \"\",\n    filterSettings: columnFilterSettings,\n    config: currentMainReportConfig ? { ...currentMainReportConfig } : {\n      dataRange: \"\",\n      headerRow: 1,\n      snColumn: 0,\n      amtColumn: 0,\n      sheetName: \"\"\n    }\n  };\n\n  filterConditionsList.unshift(filterCondition);\n  updateFilterConditionsList();\n  refreshCurrentFilterDisplay();\n\n  const filterCount = columnFilterSettings.length;\n  appendDebugLog(`: ${filterCount} `);\n}\n\n// \nasync function goToMainReport(): Promise<void> {\n  if (!currentMainReportConfig || !currentMainReportConfig.sheetName) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      sheet.activate();\n\n      // \n      const firstCell = sheet.getRange(\"A1\");\n      firstCell.select();\n\n      await context.sync();\n      showMessage(`: ${currentMainReportConfig!.sheetName}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function resetFilterAndGoToMainReport(): Promise<void> {\n  if (!currentMainReportConfig || !currentMainReportConfig.sheetName) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  currentFilterStatistics = {\n    filteredRowCount: 0,\n    totalAmount: 0,\n    isValid: false\n  };\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      sheet.activate();\n\n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex\");\n      await context.sync();\n\n      // \n      const dataRowCount = usedRange.rowCount - 1;\n      if (dataRowCount > 0) {\n        const startRowNum = usedRange.rowIndex + 2; // \n        const endRowNum = usedRange.rowIndex + usedRange.rowCount;\n        const allDataRows = sheet.getRange(`${startRowNum}:${endRowNum}`);\n        allDataRows.rowHidden = false;\n\n        // \n        allDataRows.format.rowHeight = 20;\n      }\n\n      // \n      const firstCell = sheet.getRange(\"A1\");\n      firstCell.select();\n\n      await context.sync();\n\n      // \n      for (const field of filterPanelFields) {\n        field.selectedValues = new Set<string>(field.allValues);\n      }\n\n      // \n      activeFilterFieldIndex = -1;\n      renderFilterPanel();\n      refreshCurrentFilterDisplay();\n\n      // \n      const filterTextContainer = document.getElementById(\"filter-text-container\");\n      if (filterTextContainer) {\n        filterTextContainer.style.display = \"none\";\n      }\n\n      showMessage(\"\");\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function generateReport(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      // \n      let sourceSheet: Excel.Worksheet;\n      let usingMainReport = false;\n      if (currentMainReportConfig && currentMainReportConfig.sheetName) {\n        sourceSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n        usingMainReport = true;\n      } else {\n        sourceSheet = workbook.worksheets.getActiveWorksheet();\n      }\n      sourceSheet.load(\"name\");\n      await context.sync();\n\n      // \n      appendDebugLog(` - : \"${sourceSheet.name}\", : ${usingMainReport}`);\n      if (currentMainReportConfig) {\n        appendDebugLog(`  : sheetName=\"${currentMainReportConfig.sheetName}\"`);\n      }\n\n      // \n      let snColIndex: number | null = null;\n      let amtColIndex: number | null = null;\n      let sourceSheetName: string = \"\"; // \n\n\n      try {\n        const snNamedItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        snNamedItem.load(\"name, formula\");\n        await context.sync();\n\n        //  sync \n        sourceSheetName = sourceSheet.name;\n\n        // 1 NamedItem  Range \n        const snRange = snNamedItem.getRange();\n        snRange.load(\"columnIndex, address, columnCount\");\n        await context.sync();\n        let snColIndexFromRange = snRange.columnIndex;\n\n        // 2\n        const snColumnName = parseColumnFromFormula(snNamedItem.formula);\n        let snColIndexFromFormula: number | null = null;\n        if (snColumnName) {\n          snColIndexFromFormula = getColumnIndexFromName(snColumnName);\n        }\n\n        // \n        snColIndex = snColIndexFromFormula !== null ? snColIndexFromFormula : snColIndexFromRange;\n\n        //  S/N \n        appendDebugLog(`S/N  NamedItem: ${snNamedItem.name}`);\n        appendDebugLog(`  : ${snNamedItem.formula}`);\n        appendDebugLog(`  : ${snRange.address}`);\n        appendDebugLog(`   Range : ${snColIndexFromRange} ( ${getColumnName(snColIndexFromRange)})`);\n        if (snColumnName) {\n          appendDebugLog(`  : ${snColumnName}, : ${snColIndexFromFormula}`);\n        }\n        appendDebugLog(`  : ${snColIndex} ( ${getColumnName(snColIndex)})`);\n      } catch (error) {\n        showMessage(\":  S/N \\\" S/N \\\"\", true);\n        return;\n      }\n\n      try {\n        const amtNamedItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        amtNamedItem.load(\"name, formula\");\n        await context.sync();\n\n        // 1 NamedItem  Range \n        const amtRange = amtNamedItem.getRange();\n        amtRange.load(\"columnIndex, address, columnCount\");\n        await context.sync();\n        let amtColIndexFromRange = amtRange.columnIndex;\n\n        // 2\n        const amtColumnName = parseColumnFromFormula(amtNamedItem.formula);\n        let amtColIndexFromFormula: number | null = null;\n        if (amtColumnName) {\n          amtColIndexFromFormula = getColumnIndexFromName(amtColumnName);\n        }\n\n        // \n        amtColIndex = amtColIndexFromFormula !== null ? amtColIndexFromFormula : amtColIndexFromRange;\n\n        // \n        appendDebugLog(` NamedItem: ${amtNamedItem.name}`);\n        appendDebugLog(`  : ${amtNamedItem.formula}`);\n        appendDebugLog(`  : ${amtRange.address}`);\n        appendDebugLog(`   Range : ${amtColIndexFromRange} ( ${getColumnName(amtColIndexFromRange)})`);\n        if (amtColumnName) {\n          appendDebugLog(`  : ${amtColumnName}, : ${amtColIndexFromFormula}`);\n        }\n        appendDebugLog(`  : ${amtColIndex} ( ${getColumnName(amtColIndex)})`);\n      } catch (error) {\n        showMessage(\": \\\"\\\"\", true);\n        return;\n      }\n\n      //  Excel \n      const usedRange = sourceSheet.getUsedRange();\n      if (!usedRange) {\n        showMessage(\": \", true);\n        return;\n      }\n\n      usedRange.load(\"rowCount, columnCount, address, values, rowIndex\");\n\n      // \n      await context.sync();\n\n      if (usedRange.rowCount === 0 || usedRange.columnCount === 0) {\n        showMessage(\": \", true);\n        return;\n      }\n\n      const rowCount = usedRange.rowCount;\n      const columnCount = usedRange.columnCount;\n\n      // \n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(`:  (: ${rowCount}, : ${columnCount})`, true);\n        return;\n      }\n\n      // \n      clearDebugLog();\n      appendDebugLog(`...`);\n      appendDebugLog(`S/N : ${snColIndex}, : ${amtColIndex}`);\n\n      // \n      if (snColIndex === amtColIndex) {\n        appendDebugLog(`: S/N `);\n      }\n\n      // =====  filterPanelFields =====\n      // \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n\n      appendDebugLog(`: ${filterEntries.length}`);\n      for (const filter of filterEntries) {\n        appendDebugLog(`  ${filter.headerText}: ${filter.allowedValues.size} `);\n      }\n\n      // \n      const filteredRows: any[][] = [];\n\n      //  columnCount \n      const normalizeRow = (rowData: any[]): any[] => {\n        if (!rowData || !Array.isArray(rowData)) {\n          return new Array(columnCount).fill(\"\");\n        }\n        if (rowData.length === columnCount) {\n          return rowData;\n        } else if (rowData.length < columnCount) {\n          return [...rowData, ...new Array(columnCount - rowData.length).fill(\"\")];\n        } else {\n          return rowData.slice(0, columnCount);\n        }\n      };\n\n      // \n      if (usedRange.values.length > 0 && usedRange.values[0]) {\n        filteredRows.push(normalizeRow(usedRange.values[0]));\n      }\n\n      // \n      let visibleRowCount = 0;\n      let hiddenRowCount = 0;\n\n      for (let i = 1; i < usedRange.values.length; i++) {\n        const rowData = usedRange.values[i];\n        if (!rowData || !Array.isArray(rowData)) continue;\n\n        // \n        let shouldInclude = true;\n\n        if (filterEntries.length > 0) {\n          for (const filter of filterEntries) {\n            if (filter.colIdx < rowData.length) {\n              const cellValue = rowData[filter.colIdx];\n              const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n\n              if (!filter.allowedValues.has(cellStr)) {\n                shouldInclude = false;\n                break;\n              }\n            }\n          }\n        }\n\n        if (shouldInclude) {\n          filteredRows.push(normalizeRow(rowData));\n          visibleRowCount++;\n        } else {\n          hiddenRowCount++;\n        }\n      }\n\n      appendDebugLog(`: ${rowCount}, : ${visibleRowCount}, : ${hiddenRowCount}`);\n\n      const filteredCount = filteredRows.length - 1; // \n\n      // \n      if (filteredCount === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n      appendDebugLog(`: ${filteredCount}`);\n\n      //  filteredRows \n      let totalAmount = 0;\n      const amountValues: number[] = []; // \n\n      for (let i = 1; i < filteredRows.length; i++) {\n        const rowData = filteredRows[i];\n        // Excel  = filteredRows  + 1 filteredRows[0] \n        const excelRowNumber = i + 1;\n\n        if (rowData && Array.isArray(rowData) && amtColIndex !== null && amtColIndex >= 0 && amtColIndex < rowData.length) {\n          const amountValue = rowData[amtColIndex];\n\n          //  S/N \n          const snValue = (snColIndex !== null && snColIndex >= 0 && snColIndex < rowData.length) ? rowData[snColIndex] : \"N/A\";\n\n          // \n          if (amountValue !== null && amountValue !== undefined && amountValue !== \"\") {\n            const cleanedAmount = cleanAmount(amountValue);\n            totalAmount += cleanedAmount;\n            amountValues.push(cleanedAmount);\n\n            // \n            const rawValueStr = typeof amountValue === \"string\" ? `\"${amountValue}\"` : String(amountValue);\n\n            //  S/N \n            appendDebugLog(`Row ${excelRowNumber}: SN[${snColIndex}]=${snValue}, [${amtColIndex}]=${rawValueStr} -> Clean=${cleanedAmount.toFixed(2)}`);\n          } else {\n            // \n            appendDebugLog(`Row ${excelRowNumber}: SN[${snColIndex}]=${snValue}, [${amtColIndex}]=`);\n          }\n        } else {\n          appendDebugLog(`Row ${excelRowNumber}:  -  ${amtColIndex}  (: ${rowData ? rowData.length : 0})`);\n        }\n      }\n\n      // \n      appendDebugLog(`---  ---`);\n      appendDebugLog(`: ${totalAmount.toFixed(2)}`);\n      appendDebugLog(`: [${amountValues.map(v => v.toFixed(2)).join(', ')}]`);\n\n      // \n      const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\").slice(0, 19);\n      const newSheetName = `_${timestamp}`;\n      let newSheet: Excel.Worksheet;\n\n      try {\n        newSheet = workbook.worksheets.add(newSheetName);\n      } catch (error) {\n        // \n        let counter = 1;\n        while (true) {\n          try {\n            newSheet = workbook.worksheets.add(`${newSheetName}_${counter}`);\n            break;\n          } catch (e) {\n            counter++;\n          }\n        }\n      }\n\n      // \n      newSheet.load(\"name\");\n\n      // \n      // \\n\n      let currentFilterText = \"\";\n      interface FilterDisplayItem {\n        fieldName: string;\n        values: string;\n      }\n      const filterDisplayItems: FilterDisplayItem[] = [];\n\n      try {\n        // \n        for (const field of filterPanelFields) {\n          // \n          if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n            const selectedValuesArray = Array.from(field.selectedValues);\n\n            // \n            let displayValues: string;\n            if (selectedValuesArray.length <= 5) {\n              displayValues = selectedValuesArray.join(\"; \");\n            } else {\n              displayValues = selectedValuesArray.slice(0, 5).join(\"; \") + `... (${selectedValuesArray.length})`;\n            }\n\n            filterDisplayItems.push({\n              fieldName: field.headerText,\n              values: displayValues\n            });\n            appendDebugLog(` - ${field.headerText}: ${selectedValuesArray.length}/${field.allValues.length}`);\n          }\n        }\n\n        if (filterDisplayItems.length > 0) {\n          // \\n\n          currentFilterText = filterDisplayItems.map(item =>\n            `${item.fieldName}${item.values}`\n          ).join(\"\\n\");\n          appendDebugLog(`: ${currentFilterText}`);\n        } else {\n          appendDebugLog(\"\");\n        }\n      } catch (error) {\n        console.warn(\":\", error);\n        appendDebugLog(`: ${error.message}`);\n      }\n\n      //  Dashboard  4  + \n      const filterRowCount = filterDisplayItems.length > 0 ? filterDisplayItems.length : 1;\n      const dashboardEndRow = 4 + filterRowCount + 1; // +1 for spacing row\n      const dataStartRow = dashboardEndRow + 1;\n\n      //  Dashboard  - \n      const dashboardRange = newSheet.getRange(`A1:E${dashboardEndRow}`);\n      dashboardRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n      dashboardRange.format.horizontalAlignment = Excel.HorizontalAlignment.left;\n      dashboardRange.format.fill.color = \"#F5F5F5\"; // \n      dashboardRange.format.font.name = \"Arial\";\n      dashboardRange.format.font.size = 11;\n      dashboardRange.format.font.color = \"#323130\";\n\n      //  Dashboard 3\n      //  sheet \n      const dashboardBaseData = [\n        [newSheetName, \"\", \"\", \"\", \"\"],\n        [\"\", filteredCount.toString(), \"\", \"\", sourceSheetName],\n        [\"\", totalAmount.toFixed(2), \"\", \"\", new Date().toLocaleString(\"zh-CN\")]\n      ];\n      const dashboardBaseRange = newSheet.getRange(\"A1:E3\");\n      dashboardBaseRange.values = dashboardBaseData;\n\n      //  Dashboard \n      const titleCell = newSheet.getRange(\"A1:E1\");\n      titleCell.merge();\n      titleCell.format.font.size = 14;\n      titleCell.format.font.bold = true;\n      titleCell.format.font.color = \"#0078d4\";\n      titleCell.format.horizontalAlignment = Excel.HorizontalAlignment.center;\n\n      //  Dashboard A\n      const labelRange = newSheet.getRange(\"A2:A3\");\n      labelRange.format.font.bold = true;\n      labelRange.format.font.color = \"#323130\";\n\n      //  Dashboard \n      const dataRangeDashboard = newSheet.getRange(\"B2:B3\");\n      dataRangeDashboard.format.font.color = \"#0078d4\";\n      dataRangeDashboard.format.font.bold = true;\n\n      //  Dashboard \n      const rightLabelRange = newSheet.getRange(\"D2:D3\");\n      rightLabelRange.format.font.bold = true;\n      const rightDataRange = newSheet.getRange(\"E2:E3\");\n      rightDataRange.format.font.color = \"#323130\";\n\n      // \n      const sourceSheetLinkCell = newSheet.getRange(\"E2\");\n      // \n      const configHeaderRow = currentMainReportConfig?.headerRow || 1;\n      const linkAddress = `'${sourceSheetName}'!A${configHeaderRow}`;\n      sourceSheetLinkCell.hyperlink = {\n        address: \"\",\n        documentReference: linkAddress,\n        screenTip: `: ${sourceSheetName}`,\n        textToDisplay: sourceSheetName\n      };\n      sourceSheetLinkCell.format.font.color = \"#0078d4\";\n      sourceSheetLinkCell.format.font.underline = Excel.RangeUnderlineStyle.single;\n\n      // 4\n      // A = \"\"B = C = \n      if (filterDisplayItems.length > 0) {\n        for (let i = 0; i < filterDisplayItems.length; i++) {\n          const rowNum = 4 + i;\n          const item = filterDisplayItems[i];\n\n          // A-E\n          const rowRange = newSheet.getRange(`A${rowNum}:E${rowNum}`);\n          if (i === 0) {\n            rowRange.values = [[\"\", `${item.fieldName}`, item.values, \"\", \"\"]];\n          } else {\n            rowRange.values = [[\"\", `${item.fieldName}`, item.values, \"\", \"\"]];\n          }\n\n          // A \n          const labelCell = newSheet.getRange(`A${rowNum}`);\n          labelCell.format.font.bold = true;\n          labelCell.format.font.color = \"#323130\";\n\n          // B \n          const fieldNameCell = newSheet.getRange(`B${rowNum}`);\n          fieldNameCell.format.font.color = \"#0d47a1\"; // \n          fieldNameCell.format.font.bold = true;\n\n          // C \n          const valueCell = newSheet.getRange(`C${rowNum}`);\n          valueCell.format.font.color = \"#323130\";\n          valueCell.format.wrapText = true;\n        }\n      } else {\n        // \n        const noFilterRow = newSheet.getRange(\"A4:E4\");\n        noFilterRow.values = [[\"\", \"\", \"\", \"\", \"\"]];\n\n        const noFilterLabelCell = newSheet.getRange(\"A4\");\n        noFilterLabelCell.format.font.bold = true;\n        noFilterLabelCell.format.font.color = \"#323130\";\n\n        const noFilterValueCell = newSheet.getRange(\"B4\");\n        noFilterValueCell.format.font.color = \"#a19f9d\";\n        noFilterValueCell.format.font.italic = true;\n      }\n\n      //  Dashboard \n      dashboardRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeTop\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeBottom\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeLeft\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeRight\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"InsideHorizontal\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"InsideHorizontal\").color = \"#E1E1E1\";\n      dashboardRange.format.borders.getItem(\"InsideVertical\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"InsideVertical\").color = \"#E1E1E1\";\n\n      // \n      await context.sync();\n\n      //  dataStartRow - \n      if (filteredRows.length > 0) {\n        const lastColumnName = getColumnName(columnCount - 1);\n\n        // \n        appendDebugLog(`...`);\n        appendDebugLog(`: A${dataStartRow}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n        appendDebugLog(`filteredRows.length = ${filteredRows.length}`);\n        appendDebugLog(`columnCount = ${columnCount}`);\n\n        // \n        for (let i = 0; i < filteredRows.length; i++) {\n          const rowLen = filteredRows[i] ? filteredRows[i].length : 0;\n          if (rowLen !== columnCount) {\n            appendDebugLog(`:  ${i}  (${rowLen})  columnCount (${columnCount}) `);\n          }\n        }\n\n        // \n        const targetRowCount = filteredRows.length;\n        const targetColCount = columnCount;\n        appendDebugLog(`: ${targetRowCount}  x ${targetColCount} `);\n\n        const dataRange = newSheet.getRange(`A${dataStartRow}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n\n        try {\n          dataRange.values = filteredRows;\n        } catch (writeError) {\n          appendDebugLog(`: ${writeError.message}`);\n          // \n          appendDebugLog(`: ${JSON.stringify(filteredRows[0])}`);\n          if (filteredRows.length > 1) {\n            appendDebugLog(`: ${JSON.stringify(filteredRows[1])}`);\n          }\n          throw writeError;\n        }\n\n        // \n        dataRange.format.font.name = \"Arial\";\n        dataRange.format.font.size = 11;\n        dataRange.format.font.color = \"#323130\";\n        dataRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n        dataRange.format.horizontalAlignment = Excel.HorizontalAlignment.left;\n\n        // dataStartRow\n        const headerRange = newSheet.getRange(`A${dataStartRow}:${lastColumnName}${dataStartRow}`);\n        headerRange.format.fill.color = \"#0078d4\"; // \n        headerRange.format.font.bold = true;\n        headerRange.format.font.color = \"#FFFFFF\"; // \n        headerRange.format.font.size = 11;\n        headerRange.format.font.name = \"Arial\";\n        headerRange.format.horizontalAlignment = Excel.HorizontalAlignment.center;\n        headerRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n\n        // \n        headerRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeTop\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeBottom\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeLeft\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeRight\").color = \"#005a9e\";\n\n        // dataStartRow+1\n        if (filteredRows.length > 1) {\n          const dataRowsRange = newSheet.getRange(`A${dataStartRow + 1}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n\n          // \n          dataRowsRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeTop\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeBottom\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeLeft\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeRight\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"InsideHorizontal\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"InsideHorizontal\").color = \"#F0F0F0\";\n          dataRowsRange.format.borders.getItem(\"InsideVertical\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"InsideVertical\").color = \"#F0F0F0\";\n\n          // \n          const dataRowStart = dataStartRow + 1;\n          for (let i = dataRowStart; i <= dataStartRow + filteredRows.length - 1; i++) {\n            const rowRange = newSheet.getRange(`A${i}:${lastColumnName}${i}`);\n            if ((i - dataRowStart) % 2 === 0) {\n              // \n              rowRange.format.fill.color = \"#FAFAFA\";\n            } else {\n              // \n              rowRange.format.fill.color = \"#FFFFFF\";\n            }\n          }\n        }\n      }\n\n      // \n      const usedRangeNew = newSheet.getUsedRange();\n      usedRangeNew.format.autofitColumns();\n\n      // \n      const allRowsRange = newSheet.getUsedRange();\n      allRowsRange.format.rowHeight = 20; // \n\n      // Dashboard \n      const dashboardRows = newSheet.getRange(`1:${dashboardEndRow}`);\n      dashboardRows.format.rowHeight = 22;\n\n      // \n      newSheet.activate();\n\n      await context.sync();\n\n      //  newSheet.name \n      addReportToList(newSheet.name, filteredCount, totalAmount);\n\n      // \n      await saveCurrentFilterCondition();\n\n      showMessage(` ${filteredCount} : ${totalAmount.toFixed(2)}`);\n    });\n\n    // \n    updateFilterTextDisplay();\n    await copyFilterTextToClipboard();\n\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function loadMainReportConfig(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      // \n      try {\n        const dataRangeItem = workbook.names.getItem(CFG_DATA_RANGE_NAME);\n        dataRangeItem.load(\"formula\");\n        await context.sync();\n\n        const rangeMatch = dataRangeItem.formula.match(/=([^!]+)!([^$]+)/);\n        if (rangeMatch) {\n          if (!currentMainReportConfig) {\n            currentMainReportConfig = {\n              dataRange: dataRangeItem.formula.replace(/^=/, \"\"),\n              headerRow: 0,\n              snColumn: 0,\n              amtColumn: 0,\n              sheetName: rangeMatch[1]\n            };\n          } else {\n            currentMainReportConfig.dataRange = dataRangeItem.formula.replace(/^=/, \"\");\n            currentMainReportConfig.sheetName = rangeMatch[1];\n          }\n        }\n      } catch (error) {\n        // \n      }\n\n      // \n      try {\n        const headerRowItem = workbook.names.getItem(CFG_HEADER_ROW_NAME);\n        headerRowItem.load(\"formula\");\n        await context.sync();\n\n        const rowMatch = headerRowItem.formula.match(/:(\\d+):/);\n        if (rowMatch && currentMainReportConfig) {\n          currentMainReportConfig.headerRow = parseInt(rowMatch[1]);\n        }\n      } catch (error) {\n        // \n      }\n\n      //  S/N \n      try {\n        const snItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        const snRange = snItem.getRange();\n        snRange.load(\"columnIndex\");\n        await context.sync();\n\n        if (currentMainReportConfig) {\n          currentMainReportConfig.snColumn = snRange.columnIndex;\n        }\n      } catch (error) {\n        // S/N \n      }\n\n      // \n      try {\n        const amtItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        const amtRange = amtItem.getRange();\n        amtRange.load(\"columnIndex\");\n        await context.sync();\n\n        if (currentMainReportConfig) {\n          currentMainReportConfig.amtColumn = amtRange.columnIndex;\n        }\n      } catch (error) {\n        // \n      }\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    // \n    document.getElementById(\"btn-set-data-range\")?.addEventListener(\"click\", () => {\n      setDataRange();\n    });\n\n    document.getElementById(\"btn-set-header-row\")?.addEventListener(\"click\", () => {\n      setHeaderRow();\n    });\n\n    document.getElementById(\"btn-set-sn\")?.addEventListener(\"click\", () => {\n      setSnColumnWithMergeCheck();\n    });\n\n    document.getElementById(\"btn-set-amt\")?.addEventListener(\"click\", () => {\n      setColumnConfig(CFG_AMT_COL_NAME, \"\");\n    });\n\n    document.getElementById(\"btn-enable-filter\")?.addEventListener(\"click\", () => {\n      enableFilter();\n    });\n\n    document.getElementById(\"btn-generate\")?.addEventListener(\"click\", () => {\n      generateReport();\n    });\n\n    // \n    document.getElementById(\"btn-apply-filter\")?.addEventListener(\"click\", () => {\n      applyFilterFromPanel();\n    });\n\n    document.getElementById(\"btn-clear-filter\")?.addEventListener(\"click\", () => {\n      clearFilterFromPanel();\n    });\n\n    document.getElementById(\"btn-save-filter\")?.addEventListener(\"click\", () => {\n      saveFilterFromPanel();\n    });\n\n    // \n    document.getElementById(\"btn-reset-filter\")?.addEventListener(\"click\", () => {\n      resetFilterAndGoToMainReport();\n    });\n\n    // \n    document.getElementById(\"data-range-info\")?.addEventListener(\"click\", () => {\n      goToMainReport();\n    });\n\n    // \n    bindFilterPanelEvents();\n\n    // \n    bindFilterTextEvents();\n\n    // \n    loadMainReportConfig().then(() => {\n      updateMainReportConfigDisplay();\n      updateReportsTable();\n      updateFilterConditionsList();\n    });\n\n    console.log(\"Excel Add-in \");\n  }\n});\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title></title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-Fabric ms-font-m\\\"> <div class=\\\"ms-Grid\\\" dir=\\\"ltr\\\"> <main class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <header class=\\\"app-header\\\"> <div class=\\\"header-content\\\"> <i class=\\\"ms-Icon ms-Icon--ExcelDocument header-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-l ms-fontWeight-semibold header-title\\\"></span> </div> </header> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--Settings section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <p class=\\\"ms-font-s section-hint\\\"></p> <div class=\\\"config-steps\\\"> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">1.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-data-range\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Table\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"data-range-info\\\" class=\\\"step-value clickable ms-font-s\\\" title=\\\"\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">2.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-header-row\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Header\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"header-row-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">3.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\">S/N </span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-sn\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--NumberField\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"> S/N </span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"sn-col-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">4.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-amt\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Money\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"amt-col-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> </div> <div class=\\\"config-actions\\\"> <button id=\\\"btn-enable-filter\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--FilterSolid\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> </div> </section> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--Filter section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <div id=\\\"filter-panel\\\" class=\\\"filter-panel\\\"> <div class=\\\"filter-panel-hint ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--Info\\\" aria-hidden=\\\"true\\\"></i> \\\"\\\" </div> </div> <div class=\\\"filter-actions\\\"> <button id=\\\"btn-reset-filter\\\" class=\\\"ms-Button ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Refresh\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-apply-filter\\\" class=\\\"ms-Button ms-Button--primary ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Filter\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-generate\\\" class=\\\"ms-Button ms-Button--icon btn-success\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--DocumentSet\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-save-filter\\\" class=\\\"ms-Button ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Save\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-clear-filter\\\" class=\\\"ms-Button ms-Button--icon btn-danger\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Cancel\\\" aria-hidden=\\\"true\\\"></i></span> </button> </div> <div id=\\\"current-filter-display\\\" class=\\\"current-filter-display\\\"> <div class=\\\"no-filters ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--Info\\\" aria-hidden=\\\"true\\\"></i>  </div> </div> <div class=\\\"subsection-header\\\"> <i class=\\\"ms-Icon ms-Icon--FavoriteList\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div id=\\\"filter-conditions-list\\\" class=\\\"filter-conditions-list\\\"> <div class=\\\"no-filters ms-font-s\\\"></div> </div> </div> </section> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--ReportDocument section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Table\\\" id=\\\"reports-table-container\\\"> <table id=\\\"reports-table\\\" class=\\\"reports-table\\\"> <thead> <tr> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> </tr> </thead> <tbody id=\\\"reports-table-body\\\"> <tr> <td colspan=\\\"3\\\" class=\\\"no-reports ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--DocumentSearch\\\" aria-hidden=\\\"true\\\"></i>  </td> </tr> </tbody> </table> </div> </div> </section> <div id=\\\"message-area\\\" class=\\\"message-area ms-font-s\\\"></div> <div id=\\\"filter-text-container\\\" class=\\\"filter-text-container\\\" style=\\\"display:none\\\"> <div class=\\\"filter-text-header\\\"> <i class=\\\"ms-Icon ms-Icon--Copy\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> <span id=\\\"copy-success-hint\\\" class=\\\"copy-success-hint ms-font-xs\\\">!</span> </div> <div id=\\\"filter-text-content\\\" class=\\\"filter-text-content ms-font-s\\\" title=\\\"\\\"></div> </div> <div id=\\\"debug-log\\\" class=\\\"debug-log ms-font-xs\\\"></div> </div> </main> </div> <div id=\\\"confirm-dialog\\\" class=\\\"ms-Dialog confirm-dialog-overlay\\\"> <div class=\\\"ms-Dialog-main confirm-dialog\\\"> <div class=\\\"ms-Dialog-header confirm-dialog-header\\\"> <p class=\\\"ms-Dialog-title ms-font-l ms-fontWeight-semibold\\\"> <i class=\\\"ms-Icon ms-Icon--Warning\\\" aria-hidden=\\\"true\\\"></i>  </p> </div> <div class=\\\"ms-Dialog-inner\\\"> <div class=\\\"ms-Dialog-content confirm-dialog-body\\\"> <p id=\\\"confirm-dialog-message\\\" class=\\\"ms-font-m\\\"></p> </div> <div class=\\\"ms-Dialog-actions confirm-dialog-footer\\\"> <button id=\\\"confirm-dialog-cancel\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\"></span> </button> <button id=\\\"confirm-dialog-ok\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\"></span> </button> </div> </div> </div> </div> <div id=\\\"progress-overlay\\\" class=\\\"ms-Dialog progress-overlay\\\"> <div class=\\\"ms-Dialog-main progress-dialog\\\"> <div class=\\\"ms-Dialog-header progress-header\\\"> <i class=\\\"ms-Icon ms-Icon--Processing spinning-icon\\\" aria-hidden=\\\"true\\\"></i> <span id=\\\"progress-title\\\" class=\\\"ms-font-l ms-fontWeight-semibold\\\">...</span> </div> <div class=\\\"ms-Dialog-inner progress-body\\\"> <p id=\\\"progress-message\\\" class=\\\"ms-font-m\\\">...</p> <div class=\\\"progress-bar-container\\\"> <div id=\\\"progress-bar\\\" class=\\\"progress-bar\\\"></div> </div> <p id=\\\"progress-detail\\\" class=\\\"progress-detail ms-font-s\\\">0 / 0</p> </div> </div> </div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CFG_SN_COL_NAME","CFG_AMT_COL_NAME","CFG_DATA_RANGE_NAME","CFG_HEADER_ROW_NAME","getColumnName","columnIndex","result","index","String","fromCharCode","Math","floor","getColumnIndexFromName","columnName","charCodeAt","parseColumnFromFormula","formula","match","reportsList","filterConditionsList","currentMainReportConfig","filterPanelFields","currentFilterStatistics","filteredRowCount","totalAmount","isValid","showMessage","message","isError","messageArea","getElementById","textContent","className","console","log","showProgress","title","overlay","titleEl","messageEl","barEl","detailEl","style","width","classList","add","updateProgress","current","total","detail","percent","round","concat","hideProgress","remove","appendDebugLog","debugLog","logEntry","createElement","marginBottom","appendChild","scrollTop","scrollHeight","generateFilterText","filterItems","push","toFixed","hasFilter","_i","_filterPanelFields","field","selectedValues","size","allValues","valuesArray","Array","from","valuesText","slice","join","headerText","updateFilterTextDisplay","autoHide","container","content","filterText","display","htmlContent","split","map","line","trim","startsWith","innerHTML","copyFilterTextToClipboard","_copyFilterTextToClipboard","_callee2","textArea","_t","_t2","_context2","navigator","clipboard","writeText","showCopySuccessHint","error","position","left","body","select","execCommand","removeChild","hint","setTimeout","clearDebugLog","cleanAmount","isNaN","str","isNegative","substring","dotIndex","indexOf","num","parseFloat","_setDataRange","_callee4","_t5","_context4","Excel","run","_ref2","_callee3","context","sheet","selection","address","parts","startRow","startCol","endRow","endCol","startColName","endColName","currentSheetName","sheetNameEscaped","fullAddress","namedItems","existingItem","debugInfo","errorMsg","_t3","_t4","_context3","workbook","worksheets","getActiveWorksheet","load","getSelectedRange","sync","includes","rowIndex","rowCount","columnCount","name","names","getItem","delete","code","JSON","stringify","getOwnPropertyNames","dataRange","sheetName","headerRow","snColumn","amtColumn","updateMainReportConfigDisplay","_x15","_setHeaderRow","_callee6","_t7","_context6","_ref3","_callee5","rowAddress","_context5","_x16","_setColumnConfig","_callee8","_t9","_context8","_ref4","_callee7","columnNameStr","cellAddress","_t8","_context7","getItemOrNullObject","isNullObject","_x17","_setSnColumnWithMergeCheck","_callee0","_t11","_context1","_ref5","_callee9","usedRange","totalColumns","columnRange","values","mergedCellInfos","mergedAreas","areas","j","_j","_area","currentValue","consecutiveEmpty","k","nextValue","cellRowIndex","mergeRowCount","endRowIndex","_iterator5","_step5","info","sortedInfos","deletedRows","totalInfos","minRow","maxRow","_iterator6","_step6","_info2","allDataRange","allData","mergeResults","idx","_info","rowsToMerge","firstRowIndex","dataOffset","mergedValues","rowOffset","currentDataOffset","currentRowValues","col","firstVal","currentVal","BATCH_SIZE","batchStart","batchEnd","batchResults","_iterator7","_step7","_loop","_iterator8","_step8","firstRowRange","_iterator9","_step9","_result","_i5","columnAddress","mergeInfo","_t0","_t1","_context0","getUsedRange","getRangeByIndexes","getMergedAreasOrNullObject","areaCount","items","area","showConfirmDialog","_createForOfIteratorHelper","s","getRange","format","fill","color","err","sort","Infinity","min","max","rowsToDelete","_context9","find","unmerge","_regeneratorValues","wrapText","DeleteShiftDirection","up","_x18","dataRangeEl","headerRowEl","snColEl","colName","amtColEl","enableFilterBtn","isConfigComplete","disabled","updateReportsTable","_currentMainReportCon","tbody","html","report","createTime","Date","toLocaleString","month","day","hour","minute","querySelectorAll","forEach","link","addEventListener","goToMainReport","span","target","getAttribute","_x5","_navigateToSheet","navigateToSheet","_displaySpan$parentEl","displaySpan","querySelector","editContainer","parentElement","input","focus","startEditReportName","parseInt","keyEvent","key","_x3","_x4","_confirmEditReportName","confirmEditReportName","cancelEditReportName","button","btn","currentTarget","_x6","_x7","_deleteReport","deleteReport","_displaySpan$parentEl2","_callee12","newName","oldName","_t15","_context13","_ref7","_callee11","_context12","_x20","_callee14","_context15","_ref8","_callee13","_context14","activate","_x21","okButton","cancelButton","cleanup","removeEventListener","onOk","onCancel","_callee16","_t18","_context17","_ref9","_callee15","_context16","splice","_x22","addReportToList","toISOString","unshift","updateFilterConditionsList","filter","filterSummary","filterSettings","_displaySpan$parentEl3","startEditFilterName","cancelEditFilterName","confirmEditFilterName","_x8","_x9","_applyFilterCondition","applyFilterCondition","_displaySpan$parentEl4","_callee18","filterCondition","_t20","_context20","_ref0","_callee17","_loop2","colIdx","applyBtn","clearBtn","saveBtn","generateBtn","resetBtn","excelRow","filterEntries","_i6","_filterPanelFields4","hiddenCount","visibleCount","valueIdx","rowData","excelRowNum","shouldHide","_iterator0","_step0","cellValue","cellStr","_t19","_context19","config","rowIdx","_cellValue","valueStr","sortedValues","savedFilter","_context18","Set","localeCompare","isFiltered","filterValues","has","isTimeField","timeDimension","renderFilterPanel","rowHidden","allowedValues","updateCurrentFilterDisplay","filterType","_x23","activeFilters","filterItemsHtml","totalCount","displayValues","remainingCount","filterId","refreshCurrentFilterDisplay","columnFilterSettings","_i2","_filterPanelFields2","selectedValuesArray","_enableFilter","_callee20","_t21","_context22","_ref1","_callee19","_currentMainReportCon3","_currentMainReportCon4","activeSheet","_context21","_x24","expandFilterValues","_filterIndex","collapsedEl","expandedEl","collapseFilterValues","activeFilterFieldIndex","panel","tagsHtml","selectedCount","tagClass","escapeHtml","dropdownHtml","fieldId","timeDimensionHtml","timeValues","isSelected","displayValue","text","div","_toggleTimeField","_callee21","fieldIndex","_context23","checkTimeFieldFormat","_x1","_checkTimeFieldFormat","_callee23","_t22","_context25","_ref10","_callee22","colIndex","standardCount","nonStandardCount","nonStandardRows","nonStandardValues","examples","confirmMsg","_context24","isStandardDateFormat","calculateTimeValues","confirm","convertTimeFormat","_x25","_i3","_standardPatterns","date","getTime","_x10","_x11","_x12","_x13","_convertTimeFormat","_callee24","convertedCount","converted","cell","_context26","tryConvertToDate","font","recalculateTimeValues","dmyMatch","_dmyMatch","_slicedToArray","year","padStart","cnMatch","_cnMatch","enMatch","toLowerCase","_enMatch","monthStr","getFullYear","getMonth","getDate","years","months","days","dateInfo","extractDateInfo","yearMonth","excelDate","excelEpoch","_x14","_recalculateTimeValues","_callee26","_t23","_context28","_ref11","_callee25","_context27","_x26","filterPanelEventsBound","updateTagCount","tag","toggle","countSpan","_applyFilterFromPanel","_callee28","_t25","_context30","_ref12","_callee27","_currentMainReportCon5","_currentMainReportCon6","targetSheet","_iterator1","_step1","rowVisibility","amtColIndex","shouldShow","_iterator10","_step10","amountValue","allDataRowsStart","allDataRowsEnd","hiddenRangeCount","endIdx","rangeStartRow","rangeEndRow","_t24","_context29","rowHeight","count","_x27","_clearFilterFromPanel","_callee30","_iterator11","_step11","_t26","_context32","_ref13","_callee29","startRowNum","endRowNum","allDataRows","filterTextContainer","_context31","_x28","saveCurrentFilterCondition","_saveCurrentFilterCondition","_callee31","_currentMainReportCon7","_iterator12","_step12","filterCount","_context33","id","now","_objectSpread","_goToMainReport","_callee33","_t27","_context35","_ref14","_callee32","_context34","_x29","_resetFilterAndGoToMainReport","_callee35","_t28","_context37","_ref15","_callee34","_iterator13","_step13","_context36","_x30","_generateReport","_callee37","_t35","_context39","_ref16","_callee36","_currentMainReportCon8","sourceSheet","usingMainReport","snColIndex","sourceSheetName","snNamedItem","snRange","snColIndexFromRange","snColumnName","snColIndexFromFormula","amtNamedItem","amtRange","amtColIndexFromRange","amtColumnName","amtColIndexFromFormula","_iterator14","_step14","_field3","_i7","_filterEntries","filteredRows","normalizeRow","visibleRowCount","hiddenRowCount","shouldInclude","_iterator15","_step15","_filter","filteredCount","amountValues","_i8","_rowData","excelRowNumber","snValue","cleanedAmount","rawValueStr","timestamp","newSheetName","newSheet","counter","currentFilterText","filterDisplayItems","_iterator16","_step16","filterRowCount","dashboardEndRow","dataStartRow","dashboardRange","dashboardBaseData","titleCell","labelRange","dataRangeDashboard","sourceSheetLinkCell","configHeaderRow","linkAddress","_i9","rowNum","item","labelCell","fieldNameCell","valueCell","noFilterLabelCell","noFilterValueCell","lastColumnName","_i0","rowLen","targetRowCount","targetColCount","headerRange","dataRowsRange","dataRowStart","_i1","_t31","_t34","_context38","isArray","_toConsumableArray","fieldName","warn","verticalAlignment","VerticalAlignment","center","horizontalAlignment","HorizontalAlignment","toString","merge","bold","hyperlink","documentReference","screenTip","textToDisplay","underline","RangeUnderlineStyle","single","italic","borders","BorderLineStyle","continuous","autofitColumns","_x31","_loadMainReportConfig","_callee39","_t40","_context41","_ref17","_callee38","dataRangeItem","rangeMatch","headerRowItem","rowMatch","snItem","amtItem","_context40","_x32","Office","onReady","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB0","_document$getElementB1","host","HostType","setDataRange","setHeaderRow","setSnColumnWithMergeCheck","_x","_x2","setColumnConfig","enableFilter","generateReport","applyFilterFromPanel","clearFilterFromPanel","_currentMainReportCon2","_i4","_filterPanelFields3","saveFilterFromPanel","resetFilterAndGoToMainReport","contains","preventDefault","stopPropagation","_x0","toggleTimeField","tagElement","closest","actionButton","action","searchInput","searchText","isSearchMode","optionsContainer","visibleValues","option","valueIndexStr","valueIndex","_step","_iterator","_step2","_iterator2","_step3","_iterator3","_step4","newSelected","_iterator4","options","checkbox","checked","updateFieldOptions","optionDiv","newChecked","actionsContainer","searchHint","searchLower","hasSearchText","matches","hintSpan","filterSearchOptions","type","dimension","getDimensionLabel","changeTimeDimension","_callee","_context","loadMainReportConfig","URL"],"ignoreList":[],"sourceRoot":""}