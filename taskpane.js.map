{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\n// \nconst CFG_SN_COL_NAME = \"Wiz_Cfg_SN_Col\";\nconst CFG_AMT_COL_NAME = \"Wiz_Cfg_Amt_Col\";\nconst CFG_DATA_RANGE_NAME = \"Wiz_Cfg_Data_Range\";\nconst CFG_HEADER_ROW_NAME = \"Wiz_Cfg_Header_Row\";\n\n// \ninterface MainReportConfig {\n  dataRange: string; //  \"Sheet1!A1:E100\"\n  headerRow: number; // 1-based\n  snColumn: number; // S/N 0-based\n  amtColumn: number; // 0-based\n  sheetName: string; // \n}\n\n//  Excel  A-Z  AA-ZZ\nfunction getColumnName(columnIndex: number): string {\n  let result = \"\";\n  let index = columnIndex;\n  while (index >= 0) {\n    result = String.fromCharCode(65 + (index % 26)) + result;\n    index = Math.floor(index / 26) - 1;\n  }\n  return result;\n}\n\n//  Excel  \"A\" -> 0, \"Z\" -> 25, \"AA\" -> 26\nfunction getColumnIndexFromName(columnName: string): number {\n  let index = 0;\n  columnName = columnName.toUpperCase();\n  for (let i = 0; i < columnName.length; i++) {\n    index = index * 26 + (columnName.charCodeAt(i) - 64);\n  }\n  return index - 1;\n}\n\n//  NamedItem  \"=Sheet1!$A:$A\" -> \"A\"\nfunction parseColumnFromFormula(formula: string): string | null {\n  // =SheetName!$Column:$Column  =SheetName!Column:Column\n  const match = formula.match(/![\\$]?([A-Z]+)[\\$]?:[\\$]?[A-Z]+/i);\n  if (match && match[1]) {\n    return match[1].toUpperCase();\n  }\n  return null;\n}\n\n// \ninterface ReportInfo {\n  sheetName: string;\n  createTime: string;\n  rowCount: number;\n  totalAmount: number;\n}\n\n// \ninterface ColumnFilterSetting {\n  columnIndex: number;\n  columnName: string; //  \"A\", \"B\"\n  headerText: string; // \n  filterType: string; // \n  filterValues: string[]; // \n  isFiltered: boolean; // \n}\n\n// \ninterface FilterCondition {\n  id: string;\n  name: string;\n  createTime: string;\n  sheetName: string;\n  filterSettings: ColumnFilterSetting[]; // \n  config: MainReportConfig; // \n}\n\n//  Excel Add-in  localStorage \nlet reportsList: ReportInfo[] = [];\n\n// \nlet filterConditionsList: FilterCondition[] = [];\n\n// \nlet currentMainReportConfig: MainReportConfig | null = null;\n\n// \ntype TimeDimension = \"year\" | \"month\" | \"day\" | \"all\";\n\n// \ninterface FilterFieldData {\n  columnIndex: number;\n  headerText: string;\n  allValues: string[]; // \n  selectedValues: Set<string>; // \n  isTimeField: boolean; // \n  timeDimension: TimeDimension; // \n  timeValues?: { year: string[]; month: string[]; day: string[] }; // \n}\n\n// \nlet filterPanelFields: FilterFieldData[] = [];\n\n// \ninterface FilterStatistics {\n  filteredRowCount: number;   // \n  totalAmount: number;        // \n  isValid: boolean;           // \n}\n\n// \nlet currentFilterStatistics: FilterStatistics = {\n  filteredRowCount: 0,\n  totalAmount: 0,\n  isValid: false\n};\n\n// \nfunction showMessage(message: string, isError: boolean = false): void {\n  const messageArea = document.getElementById(\"message-area\");\n  if (messageArea) {\n    messageArea.textContent = message;\n    messageArea.className = isError ? \"message-area error\" : \"message-area success\";\n  }\n  console.log(message);\n}\n\n// \nfunction showProgress(title: string, message: string): void {\n  const overlay = document.getElementById(\"progress-overlay\");\n  const titleEl = document.getElementById(\"progress-title\");\n  const messageEl = document.getElementById(\"progress-message\");\n  const barEl = document.getElementById(\"progress-bar\");\n  const detailEl = document.getElementById(\"progress-detail\");\n\n  if (overlay && titleEl && messageEl && barEl && detailEl) {\n    titleEl.textContent = title;\n    messageEl.textContent = message;\n    barEl.style.width = \"0%\";\n    detailEl.textContent = \"\";\n    overlay.classList.add(\"show\");\n  }\n}\n\n// \nfunction updateProgress(current: number, total: number, detail?: string): void {\n  const barEl = document.getElementById(\"progress-bar\");\n  const detailEl = document.getElementById(\"progress-detail\");\n\n  if (barEl && detailEl) {\n    const percent = total > 0 ? Math.round((current / total) * 100) : 0;\n    barEl.style.width = `${percent}%`;\n    detailEl.textContent = detail || `${current} / ${total}`;\n  }\n}\n\n// \nfunction hideProgress(): void {\n  const overlay = document.getElementById(\"progress-overlay\");\n  if (overlay) {\n    overlay.classList.remove(\"show\");\n  }\n}\n\n// \nfunction appendDebugLog(message: string): void {\n  const debugLog = document.getElementById(\"debug-log\");\n  if (debugLog) {\n    const logEntry = document.createElement(\"div\");\n    logEntry.textContent = message;\n    logEntry.style.marginBottom = \"2px\";\n    debugLog.appendChild(logEntry);\n    // \n    debugLog.scrollTop = debugLog.scrollHeight;\n  }\n  console.log(message);\n}\n\n// \nfunction generateFilterText(): string {\n  const filterItems: string[] = [];\n\n  // \n  if (currentFilterStatistics.isValid) {\n    filterItems.push(`${currentFilterStatistics.filteredRowCount}`);\n    filterItems.push(`${currentFilterStatistics.totalAmount.toFixed(2)}`);\n    filterItems.push(\"\"); // \n  }\n\n  // \n  let hasFilter = false;\n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      const valuesArray = Array.from(field.selectedValues);\n      const valuesText = valuesArray.length > 5\n        ? valuesArray.slice(0, 5).join(\"\") + `...${valuesArray.length}`\n        : valuesArray.join(\"\");\n      filterItems.push(`${field.headerText}${valuesText}`);\n      hasFilter = true;\n    }\n  }\n\n  if (!hasFilter && !currentFilterStatistics.isValid) {\n    return \"\";\n  }\n\n  return filterItems.join(\"\\n\");\n}\n\n// \nfunction updateFilterTextDisplay(autoHide: boolean = false): void {\n  const container = document.getElementById(\"filter-text-container\");\n  const content = document.getElementById(\"filter-text-content\");\n\n  if (!container || !content) return;\n\n  const filterText = generateFilterText();\n\n  if (filterText === \"\" && autoHide) {\n    container.style.display = \"none\";\n    return;\n  }\n\n  // \n  container.style.display = \"block\";\n\n  //  HTML \n  const htmlContent = filterText.split(\"\\n\").map(line => {\n    // \n    if (line.trim() === \"\") {\n      return \"<hr class='filter-text-divider'>\";\n    }\n\n    //   \n    if (line.startsWith(\"\")) {\n      const value = line.replace(\"\", \"\");\n      return `<span class=\"stat-label\"></span><span class=\"stat-value\">${value}</span>`;\n    }\n    if (line.startsWith(\"\")) {\n      const value = line.replace(\"\", \"\");\n      return `<span class=\"stat-label\"></span><span class=\"stat-value\">${value}</span>`;\n    }\n\n    //   \n    const match = line.match(/(.+?)(.+)/);\n    if (match) {\n      return `<span class=\"field-name\">${match[1]}</span><span class=\"field-value\">${match[2]}</span>`;\n    }\n    return line;\n  }).join(\"<br>\");\n\n  content.innerHTML = htmlContent;\n}\n\n// \nasync function copyFilterTextToClipboard(): Promise<boolean> {\n  const filterText = generateFilterText();\n\n  if (filterText === \"\") {\n    return false;\n  }\n\n  try {\n    await navigator.clipboard.writeText(filterText);\n    showCopySuccessHint();\n    return true;\n  } catch (error) {\n    console.error(\":\", error);\n    // \n    try {\n      const textArea = document.createElement(\"textarea\");\n      textArea.value = filterText;\n      textArea.style.position = \"fixed\";\n      textArea.style.left = \"-9999px\";\n      document.body.appendChild(textArea);\n      textArea.select();\n      document.execCommand(\"copy\");\n      document.body.removeChild(textArea);\n      showCopySuccessHint();\n      return true;\n    } catch (fallbackError) {\n      console.error(\":\", fallbackError);\n      return false;\n    }\n  }\n}\n\n// \nfunction showCopySuccessHint(): void {\n  const hint = document.getElementById(\"copy-success-hint\");\n  if (hint) {\n    hint.classList.add(\"show\");\n    setTimeout(() => {\n      hint.classList.remove(\"show\");\n    }, 2000);\n  }\n}\n\n// \nfunction bindFilterTextEvents(): void {\n  const content = document.getElementById(\"filter-text-content\");\n  if (content) {\n    content.addEventListener(\"click\", async () => {\n      await copyFilterTextToClipboard();\n    });\n  }\n}\n\n// \nfunction clearDebugLog(): void {\n  const debugLog = document.getElementById(\"debug-log\");\n  if (debugLog) {\n    debugLog.innerHTML = \"\";\n  }\n}\n\n// \nfunction cleanAmount(value: any): number {\n  if (value === null || value === undefined || value === \"\") {\n    return 0;\n  }\n\n  // \n  if (typeof value === \"number\") {\n    return isNaN(value) ? 0 : value;\n  }\n\n  // \n  let str = String(value).trim();\n\n  // 0\n  if (str === \"\") {\n    return 0;\n  }\n\n  //  RMBCNY \n  str = str.replace(/RMB|CNY|USD|EUR|GBP/gi, \"\");\n\n  //  $\n  str = str.replace(/[$]/g, \"\");\n\n  // \n  str = str.replace(/[,]/g, \"\");\n\n  // \n  str = str.replace(/\\s+/g, \"\");\n\n  // \n  const isNegative = str.startsWith(\"-\");\n  if (isNegative) {\n    str = str.substring(1);\n  }\n\n  // \n  str = str.replace(/[^\\d.]/g, \"\");\n\n  // \n  const dotIndex = str.indexOf(\".\");\n  if (dotIndex !== -1) {\n    str = str.substring(0, dotIndex + 1) + str.substring(dotIndex + 1).replace(/\\./g, \"\");\n  }\n\n  // \n  const num = parseFloat(str);\n  const result = isNaN(num) ? 0 : (isNegative ? -num : num);\n\n  return result;\n}\n\n// \n// \nasync function setDataRange(): Promise<void> {\n  try {\n    // \n    showMessage(\"...\", false);\n    appendDebugLog(\" setDataRange\");\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      if (!selection) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      selection.load(\"address, rowIndex, columnIndex, rowCount, columnCount\");\n      await context.sync();\n\n      // \n      let address = selection.address;\n      appendDebugLog(`: ${address}`);\n\n      // \n      let sheetNameInAddress = \"\";\n      if (address.includes(\"!\")) {\n        const parts = address.split(\"!\");\n        if (parts.length > 1) {\n          sheetNameInAddress = parts[0].replace(/^'|'$/g, \"\");\n          address = parts[1];\n        }\n      }\n\n      //  $ \n      // \n      if (!address.includes(\"$\")) {\n        // \n        const startRow = selection.rowIndex + 1;\n        const startCol = selection.columnIndex;\n        const endRow = startRow + selection.rowCount - 1;\n        const endCol = startCol + selection.columnCount - 1;\n\n        const startColName = getColumnName(startCol);\n        const endColName = getColumnName(endCol);\n\n        address = `$${startColName}$${startRow}:$${endColName}$${endRow}`;\n        appendDebugLog(`: ${address}`);\n      }\n\n      // \n      const currentSheetName = sheet.name;\n      appendDebugLog(`Sheet: [${currentSheetName}]`);\n\n      // Sheet\n      const sheetNameEscaped = `'${currentSheetName.replace(/'/g, \"''\")}'`;\n\n      appendDebugLog(`Sheet: [${sheetNameEscaped}]`);\n\n      const fullAddress = `${sheetNameEscaped}!${address}`;\n\n      //  NamedItem\n      const namedItems = context.workbook.names;\n\n      // \n      try {\n        //  getItem  getItemOrNullObject catch \n        const existingItem = namedItems.getItem(CFG_DATA_RANGE_NAME);\n        // \n        existingItem.load(\"name\");\n        await context.sync();\n\n        appendDebugLog(`: ${CFG_DATA_RANGE_NAME}`);\n        existingItem.delete();\n        await context.sync();\n        appendDebugLog(``);\n      } catch (error) {\n        // ItemNotFound \n        if (error.code !== \"ItemNotFound\") {\n          appendDebugLog(`404: ${error.code} - ${error.message}`);\n        } else {\n          appendDebugLog(` (ItemNotFound)`);\n        }\n      }\n\n      //  NamedItem = \n      const formula = `=${fullAddress}`;\n\n      // \n      appendDebugLog(`===  NamedItem ===`);\n      appendDebugLog(`Name: ${CFG_DATA_RANGE_NAME}`);\n      appendDebugLog(`Formula: ${formula}`);\n      appendDebugLog(`RefersTo: ${fullAddress}`);\n\n      try {\n        namedItems.add(CFG_DATA_RANGE_NAME, formula);\n        await context.sync();\n        appendDebugLog(`!`);\n      } catch (addError) {\n        console.error(\" NamedItem :\", addError);\n        // \n        const debugInfo = JSON.stringify(addError, Object.getOwnPropertyNames(addError));\n        appendDebugLog(` : ${debugInfo}`);\n\n        let errorMsg = addError.message;\n        if (addError.code) {\n          errorMsg = `[${addError.code}] ${errorMsg}`;\n        }\n        throw new Error(errorMsg);\n      }\n\n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: fullAddress,\n          headerRow: 0,\n          snColumn: 0,\n          amtColumn: 0,\n          sheetName: currentSheetName\n        };\n      } else {\n        currentMainReportConfig.dataRange = fullAddress;\n        currentMainReportConfig.sheetName = currentSheetName;\n      }\n\n      updateMainReportConfigDisplay();\n      showMessage(`: ${address}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    // \n    showMessage(`: ${error.message}`, true);\n    appendDebugLog(`CRITICAL: ${error.message}`);\n  }\n}\n\n// \n// \nasync function setHeaderRow(): Promise<void> {\n  try {\n    showMessage(\"...\", false);\n    appendDebugLog(\" setHeaderRow\");\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"rowIndex\");\n\n      await context.sync();\n\n      const rowIndex = selection.rowIndex + 1; //  1-based\n\n      // Sheet\n      const currentSheetName = sheet.name;\n      const sheetNameEscaped = `'${currentSheetName.replace(/'/g, \"''\")}'`;\n      appendDebugLog(`Sheet: ${sheetNameEscaped}, : ${rowIndex}`);\n\n      //  NamedItem\n      const namedItems = context.workbook.names;\n      try {\n        const existingItem = namedItems.getItem(CFG_HEADER_ROW_NAME);\n        existingItem.delete();\n        await context.sync();\n        appendDebugLog(`: ${CFG_HEADER_ROW_NAME}`);\n      } catch (error) {\n        // \n        if (error.code !== \"ItemNotFound\") {\n          appendDebugLog(`: ${error.message}`);\n        }\n      }\n\n      const rowAddress = `${sheetNameEscaped}!$${rowIndex}:$${rowIndex}`;\n      const formula = `=${rowAddress}`;\n      appendDebugLog(`: ${formula}`);\n\n      try {\n        namedItems.add(CFG_HEADER_ROW_NAME, formula);\n        await context.sync();\n      } catch (addError) {\n        const debugInfo = JSON.stringify(addError, Object.getOwnPropertyNames(addError));\n        appendDebugLog(` : ${debugInfo}`);\n        throw addError;\n      }\n\n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: rowIndex,\n          snColumn: 0,\n          amtColumn: 0,\n          sheetName: sheet.name\n        };\n      } else {\n        currentMainReportConfig.headerRow = rowIndex;\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n\n      updateMainReportConfigDisplay();\n      showMessage(`:  ${rowIndex} `);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n    appendDebugLog(`CRITICAL: ${error.message}`);\n  }\n}\n\n// SN\n// SN\nasync function setColumnConfig(columnName: string, displayName: string): Promise<void> {\n  try {\n    showMessage(`${displayName}...`, false);\n    appendDebugLog(` setColumnConfig: ${displayName}`);\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"address, columnIndex\");\n\n      await context.sync();\n\n      // \n      if (!selection.address) {\n        showMessage(` Excel ${displayName}`, true);\n        return;\n      }\n\n      //  selection  columnIndex\n      const columnIndex = selection.columnIndex;\n      const columnNameStr = getColumnName(columnIndex);\n\n      //  NamedItem\n      const namedItems = context.workbook.names;\n\n      // \n      try {\n        //  getItem  getItemOrNullObject\n        //  fetch \n        /* \n           FIX: getItemOrNullObject  Excel \n            try-catch getItem \n            setDataRange  try-catch \n        */\n        const existingItem = namedItems.getItem(columnName);\n        existingItem.delete();\n        await context.sync();\n        appendDebugLog(`: ${columnName}`);\n      } catch (error) {\n        if (error.code !== \"ItemNotFound\") {\n          appendDebugLog(`: ${error.message}`);\n        }\n      }\n\n      // Sheet\n      const currentSheetName = sheet.name;\n      const sheetNameEscaped = `'${currentSheetName.replace(/'/g, \"''\")}'`;\n\n      //  NamedItem\n      //  Excel \n      // : ='Sheet Name'!$A$1\n      const cellAddress = `=${sheetNameEscaped}!$${columnNameStr}$1`;\n      appendDebugLog(`NamedItem: ${columnName}, : ${cellAddress}`);\n\n      try {\n        namedItems.add(columnName, cellAddress);\n        await context.sync();\n      } catch (addError) {\n        const debugInfo = JSON.stringify(addError, Object.getOwnPropertyNames(addError));\n        appendDebugLog(` : ${debugInfo}`);\n        throw addError;\n      }\n\n      // \n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: 0,\n          snColumn: columnName === CFG_SN_COL_NAME ? columnIndex : 0,\n          amtColumn: columnName === CFG_AMT_COL_NAME ? columnIndex : 0,\n          sheetName: sheet.name\n        };\n      } else {\n        if (columnName === CFG_SN_COL_NAME) {\n          currentMainReportConfig.snColumn = columnIndex;\n        } else if (columnName === CFG_AMT_COL_NAME) {\n          currentMainReportConfig.amtColumn = columnIndex;\n        }\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n\n      showMessage(`${displayName} ${columnIndex + 1}  (${columnNameStr})`);\n\n      // \n      updateMainReportConfigDisplay();\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`${displayName}: ${error.message}`, true);\n    appendDebugLog(`CRITICAL: ${error.message}`);\n  }\n}\n\n// SN\n// \ninterface MergeCellInfo {\n  address: string;      //  \"A5:A6\"\n  startRow: number;     // 0-based\n  endRow: number;       // 0-based\n  columnIndex: number;  // \n}\n\nasync function setSnColumnWithMergeCheck(): Promise<void> {\n  try {\n    // \n    showProgress(\"\", \"...\");\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.load(\"name\");\n\n      // \n      const selection = context.workbook.getSelectedRange();\n      selection.load(\"address, columnIndex\");\n\n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex, columnCount, address\");\n\n      await context.sync();\n\n      const columnIndex = selection.columnIndex;\n      const columnNameStr = getColumnName(columnIndex);\n      const startRow = usedRange.rowIndex;\n      const rowCount = usedRange.rowCount;\n      const totalColumns = usedRange.columnCount;\n\n      console.log(` ${columnNameStr} : ${startRow + 1}${startRow + rowCount}`);\n\n      // \n      updateProgress(10, 100, ` ${columnIndex + 1}  (${columnNameStr}) ${rowCount} ...`);\n\n      //  - \n      const columnRange = sheet.getRangeByIndexes(startRow, columnIndex, rowCount, 1);\n      columnRange.load(\"values\");\n      await context.sync();\n\n      const values = columnRange.values;\n      console.log(` ${values.length} `);\n\n      // \n      updateProgress(30, 100, `...`);\n\n      // =====  Excel API  =====\n      const mergedCellInfos: MergeCellInfo[] = [];\n\n      // 1 getMergedAreasOrNullObject \n      updateProgress(40, 100, \" API ...\");\n\n      try {\n        const mergedAreas = columnRange.getMergedAreasOrNullObject();\n        mergedAreas.load(\"isNullObject, areaCount\");\n        await context.sync();\n\n        if (!mergedAreas.isNullObject && mergedAreas.areaCount > 0) {\n          // \n          mergedAreas.load(\"areas\");\n          await context.sync();\n\n          const areas = mergedAreas.areas;\n          areas.load(\"items\");\n          await context.sync();\n\n          for (let j = 0; j < areas.items.length; j++) {\n            const area = areas.items[j];\n            area.load(\"rowCount, address, rowIndex, columnIndex\");\n          }\n          await context.sync();\n\n          for (let j = 0; j < areas.items.length; j++) {\n            const area = areas.items[j];\n            if (area.rowCount > 1 && area.columnIndex === columnIndex) {\n              mergedCellInfos.push({\n                address: area.address,\n                startRow: area.rowIndex,\n                endRow: area.rowIndex + area.rowCount - 1,\n                columnIndex: columnIndex\n              });\n              console.log(`API : ${area.address}, ${area.rowCount}`);\n            }\n          }\n        }\n      } catch (apiError) {\n        console.log(\"API :\", apiError);\n      }\n\n      // 2 API \n      if (mergedCellInfos.length === 0) {\n        updateProgress(50, 100, \"...\");\n\n        //  null \n        let i = 0;\n\n        while (i < rowCount) {\n          const currentValue = values[i][0];\n\n          //  null \n          let consecutiveEmpty = 0;\n          for (let k = i + 1; k < rowCount; k++) {\n            const nextValue = values[k][0];\n            // null  undefined \n            if (nextValue === null || nextValue === undefined || nextValue === \"\") {\n              consecutiveEmpty++;\n            } else {\n              break;\n            }\n          }\n\n          // \n          if (consecutiveEmpty > 0 && currentValue !== null && currentValue !== undefined && currentValue !== \"\") {\n            const cellRowIndex = startRow + i;\n            const mergeRowCount = consecutiveEmpty + 1;\n            const endRowIndex = cellRowIndex + mergeRowCount - 1;\n            const address = `${columnNameStr}${cellRowIndex + 1}:${columnNameStr}${endRowIndex + 1}`;\n\n            console.log(`: ${address}, ${mergeRowCount}`);\n\n            mergedCellInfos.push({\n              address: address,\n              startRow: cellRowIndex,\n              endRow: endRowIndex,\n              columnIndex: columnIndex\n            });\n\n            i += mergeRowCount;\n          } else {\n            i++;\n          }\n        }\n      }\n\n      console.log(` ${mergedCellInfos.length} `);\n\n      // \n      updateProgress(80, 100, ` ${mergedCellInfos.length} `);\n\n      // \n      hideProgress();\n\n      // \n      if (mergedCellInfos.length > 0) {\n        showMessage(` ${mergedCellInfos.length} `, false);\n\n        // \n        const confirmHighlight = await showConfirmDialog(\n          ` ${columnIndex + 1}  (${columnNameStr})  ${mergedCellInfos.length} \\n\\n`\n        );\n\n        if (confirmHighlight) {\n          // \n          for (const info of mergedCellInfos) {\n            const mergeRange = sheet.getRange(info.address);\n            mergeRange.format.fill.color = \"#FFFF00\";\n          }\n          await context.sync();\n          showMessage(` ${mergedCellInfos.length} `);\n        }\n\n        // \n        const confirmMerge = await showConfirmDialog(\n          `\\n\\n\\n \\n \\n \\n \\n `\n        );\n\n        if (confirmMerge) {\n          // \n          showProgress(\"\", ` ${mergedCellInfos.length} ...`);\n\n          // \n          const sortedInfos = mergedCellInfos.sort((a, b) => b.startRow - a.startRow);\n          let deletedRows = 0;\n          const totalInfos = sortedInfos.length;\n\n          // =====  =====\n          // \n          let minRow = Infinity;\n          let maxRow = 0;\n          for (const info of sortedInfos) {\n            minRow = Math.min(minRow, info.startRow);\n            maxRow = Math.max(maxRow, info.endRow);\n          }\n\n          // \n          const allDataRange = sheet.getRangeByIndexes(minRow, 0, maxRow - minRow + 1, totalColumns);\n          allDataRange.load(\"values\");\n          await context.sync();\n          const allData = allDataRange.values;\n\n          updateProgress(0, totalInfos, \"...\");\n\n          // \n          interface MergeResult {\n            firstRowIndex: number;\n            mergedValues: (string | number | boolean | null)[];\n            rowsToDelete: number;\n          }\n          const mergeResults: MergeResult[] = [];\n\n          // \n          for (let idx = 0; idx < sortedInfos.length; idx++) {\n            const info = sortedInfos[idx];\n            const rowsToMerge = info.endRow - info.startRow + 1;\n            if (rowsToMerge < 2) continue;\n\n            const firstRowIndex = info.startRow;\n            const dataOffset = firstRowIndex - minRow;\n\n            // \n            const mergedValues = allData[dataOffset].slice();\n\n            // \n            for (let rowOffset = 1; rowOffset < rowsToMerge; rowOffset++) {\n              const currentDataOffset = dataOffset + rowOffset;\n              if (currentDataOffset >= allData.length) break;\n\n              const currentRowValues = allData[currentDataOffset];\n\n              for (let col = 0; col < totalColumns; col++) {\n                const firstVal = String(mergedValues[col] || \"\").trim();\n                const currentVal = String(currentRowValues[col] || \"\").trim();\n\n                if (currentVal && currentVal !== firstVal) {\n                  if (firstVal) {\n                    mergedValues[col] = firstVal + \"\\n\" + currentVal;\n                  } else {\n                    mergedValues[col] = currentVal;\n                  }\n                }\n              }\n            }\n\n            mergeResults.push({\n              firstRowIndex,\n              mergedValues,\n              rowsToDelete: rowsToMerge - 1\n            });\n          }\n\n          // =====  =====\n          // \n          const BATCH_SIZE = 20;\n\n          for (let batchStart = 0; batchStart < mergeResults.length; batchStart += BATCH_SIZE) {\n            const batchEnd = Math.min(batchStart + BATCH_SIZE, mergeResults.length);\n            const batchResults = mergeResults.slice(batchStart, batchEnd);\n\n            updateProgress(batchStart, mergeResults.length, ` ${batchStart + 1}-${batchEnd}/${mergeResults.length}`);\n\n            // 1. \n            for (const result of batchResults) {\n              const info = sortedInfos.find(i => i.startRow === result.firstRowIndex);\n              if (info) {\n                const mergeRange = sheet.getRange(info.address);\n                mergeRange.unmerge();\n              }\n            }\n            await context.sync();\n\n            // 2. \n            for (const result of batchResults) {\n              const firstRowRange = sheet.getRangeByIndexes(result.firstRowIndex, 0, 1, totalColumns);\n              firstRowRange.values = [result.mergedValues];\n              firstRowRange.format.wrapText = true;\n              firstRowRange.format.fill.color = \"#F5F5F5\";\n            }\n            await context.sync();\n\n            // 3. \n            for (const result of batchResults) {\n              for (let i = result.rowsToDelete; i > 0; i--) {\n                const rowToDelete = sheet.getRangeByIndexes(result.firstRowIndex + i, 0, 1, totalColumns);\n                rowToDelete.delete(Excel.DeleteShiftDirection.up);\n                deletedRows++;\n              }\n            }\n            await context.sync();\n          }\n\n          // \n          hideProgress();\n\n          showMessage(` ${mergedCellInfos.length}  ${deletedRows} `);\n        }\n      } else {\n        // \n        showMessage(` ${columnIndex + 1}  (${columnNameStr})  ${rowCount} `, false);\n      }\n\n      // SN\n      const namedItems = context.workbook.names;\n\n      try {\n        const existingItem = namedItems.getItem(CFG_SN_COL_NAME);\n        existingItem.delete();\n        await context.sync();\n      } catch (error) {\n        // \n      }\n\n      const columnAddress = `='${sheet.name}'!$${columnNameStr}:$${columnNameStr}`;\n      namedItems.add(CFG_SN_COL_NAME, columnAddress);\n\n      await context.sync();\n\n      if (!currentMainReportConfig) {\n        currentMainReportConfig = {\n          dataRange: \"\",\n          headerRow: 0,\n          snColumn: columnIndex,\n          amtColumn: 0,\n          sheetName: sheet.name\n        };\n      } else {\n        currentMainReportConfig.snColumn = columnIndex;\n        currentMainReportConfig.sheetName = sheet.name;\n      }\n\n      const mergeInfo = mergedCellInfos.length > 0 ? ` ( ${mergedCellInfos.length} )` : \"\";\n      showMessage(` S/N  ${columnIndex + 1}  (${columnNameStr})${mergeInfo}`);\n\n      updateMainReportConfigDisplay();\n    });\n  } catch (error) {\n    console.error(\"SN:\", error);\n    hideProgress(); // \n    showMessage(` S/N : ${error.message}`, true);\n  }\n}\n\n// \nfunction updateMainReportConfigDisplay(): void {\n  // \n  const dataRangeEl = document.getElementById(\"data-range-info\");\n  if (dataRangeEl) {\n    if (currentMainReportConfig && currentMainReportConfig.dataRange) {\n      dataRangeEl.textContent = currentMainReportConfig.dataRange;\n      dataRangeEl.className = \"step-value clickable\";\n      dataRangeEl.title = \"\";\n    } else {\n      dataRangeEl.textContent = \"\";\n      dataRangeEl.className = \"step-value not-configured\";\n      dataRangeEl.title = \"\";\n    }\n  }\n\n  // \n  const headerRowEl = document.getElementById(\"header-row-info\");\n  if (headerRowEl) {\n    if (currentMainReportConfig && currentMainReportConfig.headerRow > 0) {\n      headerRowEl.textContent = ` ${currentMainReportConfig.headerRow} `;\n      headerRowEl.className = \"step-value\";\n    } else {\n      headerRowEl.textContent = \"\";\n      headerRowEl.className = \"step-value not-configured\";\n    }\n  }\n\n  //  S/N \n  const snColEl = document.getElementById(\"sn-col-info\");\n  if (snColEl) {\n    if (currentMainReportConfig && currentMainReportConfig.snColumn >= 0) {\n      const colName = getColumnName(currentMainReportConfig.snColumn);\n      snColEl.textContent = ` ${currentMainReportConfig.snColumn + 1}  (${colName})`;\n      snColEl.className = \"step-value\";\n    } else {\n      snColEl.textContent = \"\";\n      snColEl.className = \"step-value not-configured\";\n    }\n  }\n\n  // \n  const amtColEl = document.getElementById(\"amt-col-info\");\n  if (amtColEl) {\n    if (currentMainReportConfig && currentMainReportConfig.amtColumn >= 0) {\n      const colName = getColumnName(currentMainReportConfig.amtColumn);\n      amtColEl.textContent = ` ${currentMainReportConfig.amtColumn + 1}  (${colName})`;\n      amtColEl.className = \"step-value\";\n    } else {\n      amtColEl.textContent = \"\";\n      amtColEl.className = \"step-value not-configured\";\n    }\n  }\n\n  // \n  const enableFilterBtn = document.getElementById(\"btn-enable-filter\") as HTMLButtonElement;\n  if (enableFilterBtn) {\n    const isConfigComplete = currentMainReportConfig &&\n      currentMainReportConfig.dataRange &&\n      currentMainReportConfig.headerRow > 0 &&\n      currentMainReportConfig.snColumn >= 0 &&\n      currentMainReportConfig.amtColumn >= 0;\n    enableFilterBtn.disabled = !isConfigComplete;\n  }\n}\n\n// \nasync function updateColumnConfigDisplay(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      //  S/N \n      const snInfoEl = document.getElementById(\"sn-col-info\");\n      try {\n        const snNamedItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        snNamedItem.load(\"formula\");\n        const snRange = snNamedItem.getRange();\n        snRange.load(\"columnIndex\");\n        await context.sync();\n\n        const snColName = getColumnName(snRange.columnIndex);\n        if (snInfoEl) {\n          snInfoEl.textContent = ` ${snRange.columnIndex + 1}  (${snColName})`;\n          snInfoEl.className = \"config-value\";\n        }\n      } catch (error) {\n        if (snInfoEl) {\n          snInfoEl.textContent = \"\";\n          snInfoEl.className = \"config-value not-configured\";\n        }\n      }\n\n      // \n      const amtInfoEl = document.getElementById(\"amt-col-info\");\n      try {\n        const amtNamedItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        amtNamedItem.load(\"formula\");\n        const amtRange = amtNamedItem.getRange();\n        amtRange.load(\"columnIndex\");\n        await context.sync();\n\n        const amtColName = getColumnName(amtRange.columnIndex);\n        if (amtInfoEl) {\n          amtInfoEl.textContent = ` ${amtRange.columnIndex + 1}  (${amtColName})`;\n          amtInfoEl.className = \"config-value\";\n        }\n      } catch (error) {\n        if (amtInfoEl) {\n          amtInfoEl.textContent = \"\";\n          amtInfoEl.className = \"config-value not-configured\";\n        }\n      }\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nfunction updateReportsTable(): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n\n  let html = \"\";\n\n  // \n  if (currentMainReportConfig && currentMainReportConfig.sheetName) {\n    html += `\n      <tr class=\"main-report-row\">\n        <td>\n          <span class=\"main-report-link\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Home\" style=\"margin-right: 4px; font-size: 10px;\"></i>${currentMainReportConfig.sheetName}\n          </span>\n        </td>\n        <td><span class=\"main-report-badge\"></span></td>\n        <td></td>\n      </tr>\n    `;\n  }\n\n  if (reportsList.length === 0 && !currentMainReportConfig?.sheetName) {\n    tbody.innerHTML = '<tr><td colspan=\"3\" class=\"no-reports\"></td></tr>';\n    return;\n  }\n\n  html += reportsList.map((report, index) => {\n    const createTime = new Date(report.createTime).toLocaleString(\"zh-CN\", {\n      month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\"\n    });\n    return `\n      <tr>\n        <td>\n          <span class=\"report-name-display\" data-index=\"${index}\" data-sheet-name=\"${report.sheetName}\" title=\"\">${report.sheetName}</span>\n          <div class=\"report-name-edit-container\" style=\"display: none;\">\n            <input type=\"text\" class=\"report-name-input\" data-index=\"${index}\" value=\"${report.sheetName}\">\n            <i class=\"ms-Icon ms-Icon--ReturnKey edit-hint-icon\" title=\"\"></i>\n          </div>\n        </td>\n        <td>${createTime}</td>\n        <td>\n          <button class=\"icon-button-small danger\" data-index=\"${index}\" data-sheet-name=\"${report.sheetName}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Delete\"></i>\n          </button>\n        </td>\n      </tr>\n    `;\n  }).join(\"\");\n\n  tbody.innerHTML = html;\n\n  // \n  tbody.querySelectorAll(\".main-report-link\").forEach(link => {\n    link.addEventListener(\"click\", () => {\n      goToMainReport();\n    });\n  });\n\n  // \n  tbody.querySelectorAll(\".report-name-display\").forEach(span => {\n    span.addEventListener(\"click\", (e) => {\n      const sheetName = (e.target as HTMLElement).getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        navigateToSheet(sheetName);\n      }\n    });\n\n    // \n    span.addEventListener(\"dblclick\", (e) => {\n      const target = e.target as HTMLElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      startEditReportName(index);\n    });\n  });\n\n  // \n  tbody.querySelectorAll(\".report-name-input\").forEach(input => {\n    // \n    input.addEventListener(\"keydown\", (e) => {\n      const keyEvent = e as KeyboardEvent;\n      if (keyEvent.key === \"Enter\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        confirmEditReportName(index, target.value);\n      } else if (keyEvent.key === \"Escape\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        cancelEditReportName(index);\n      }\n    });\n\n    // \n    input.addEventListener(\"blur\", (e) => {\n      const target = e.target as HTMLInputElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      // \n      setTimeout(() => {\n        cancelEditReportName(index);\n      }, 200);\n    });\n  });\n\n  // \n  tbody.querySelectorAll(\".icon-button-small.danger\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      //  currentTarget  target target \n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      const sheetName = btn.getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        deleteReport(index, sheetName);\n      }\n    });\n  });\n}\n\n// \nfunction startEditReportName(index: number): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n\n  // \n  const displaySpan = tbody.querySelector(`.report-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".report-name-edit-container\") as HTMLElement;\n  const input = editContainer?.querySelector(\".report-name-input\") as HTMLInputElement;\n\n  if (displaySpan && editContainer && input) {\n    displaySpan.style.display = \"none\";\n    editContainer.style.display = \"flex\";\n    input.focus();\n    input.select();\n  }\n}\n\n// \nfunction cancelEditReportName(index: number): void {\n  const tbody = document.getElementById(\"reports-table-body\");\n  if (!tbody) return;\n\n  const displaySpan = tbody.querySelector(`.report-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".report-name-edit-container\") as HTMLElement;\n\n  if (displaySpan && editContainer) {\n    displaySpan.style.display = \"inline\";\n    editContainer.style.display = \"none\";\n  }\n}\n\n// \nasync function confirmEditReportName(index: number, newName: string): Promise<void> {\n  if (index < 0 || index >= reportsList.length) return;\n\n  const oldName = reportsList[index].sheetName;\n  newName = newName.trim();\n\n  if (!newName || newName === oldName) {\n    cancelEditReportName(index);\n    return;\n  }\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(oldName);\n\n      //  sheet \n      sheet.name = newName;\n\n      // A1 \n      const titleCell = sheet.getRange(\"A1\");\n      titleCell.values = [[newName]];\n\n      await context.sync();\n\n      // \n      reportsList[index].sheetName = newName;\n\n      // \n      updateReportsTable();\n\n      showMessage(`: ${newName}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n    cancelEditReportName(index);\n  }\n}\n\n// \nasync function navigateToSheet(sheetName: string): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(sheetName);\n      sheet.activate();\n      await context.sync();\n      showMessage(`: ${sheetName}`);\n    });\n  } catch (error) {\n    showMessage(`:  \"${sheetName}\"`, true);\n  }\n}\n\n// \nfunction showConfirmDialog(message: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    const overlay = document.getElementById(\"confirm-dialog\");\n    const messageEl = document.getElementById(\"confirm-dialog-message\");\n    const okButton = document.getElementById(\"confirm-dialog-ok\");\n    const cancelButton = document.getElementById(\"confirm-dialog-cancel\");\n\n    if (!overlay || !messageEl || !okButton || !cancelButton) {\n      resolve(false);\n      return;\n    }\n\n    messageEl.textContent = message;\n    overlay.classList.add(\"show\");\n\n    const cleanup = () => {\n      overlay.classList.remove(\"show\");\n      okButton.removeEventListener(\"click\", onOk);\n      cancelButton.removeEventListener(\"click\", onCancel);\n    };\n\n    const onOk = () => {\n      cleanup();\n      resolve(true);\n    };\n\n    const onCancel = () => {\n      cleanup();\n      resolve(false);\n    };\n\n    okButton.addEventListener(\"click\", onOk);\n    cancelButton.addEventListener(\"click\", onCancel);\n  });\n}\n\n// \nasync function deleteReport(index: number, sheetName: string): Promise<void> {\n  const confirmed = await showConfirmDialog(` \"${sheetName}\" `);\n\n  if (!confirmed) {\n    return;\n  }\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      try {\n        const sheet = workbook.worksheets.getItem(sheetName);\n        sheet.delete();\n        await context.sync();\n\n        // \n        reportsList.splice(index, 1);\n        updateReportsTable();\n        showMessage(`: ${sheetName}`);\n      } catch (error) {\n        // \n        reportsList.splice(index, 1);\n        updateReportsTable();\n        showMessage(` \"${sheetName}\" `);\n      }\n    });\n  } catch (error) {\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction addReportToList(sheetName: string, rowCount: number, totalAmount: number): void {\n  const report: ReportInfo = {\n    sheetName: sheetName,\n    createTime: new Date().toISOString(),\n    rowCount: rowCount,\n    totalAmount: totalAmount\n  };\n\n  reportsList.unshift(report); // \n  updateReportsTable();\n}\n\n\n// \nfunction updateFilterConditionsList(): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n\n  if (filterConditionsList.length === 0) {\n    container.innerHTML = '<div class=\"no-filters\"></div>';\n    return;\n  }\n\n  container.innerHTML = filterConditionsList.map((filter, index) => {\n    const createTime = new Date(filter.createTime).toLocaleString(\"zh-CN\", {\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    });\n\n    // \n    const filterSummary = filter.filterSettings.map(f => f.headerText).join(\", \");\n\n    return `\n      <div class=\"filter-condition-item\">\n        <div class=\"filter-condition-info\">\n          <span class=\"filter-name-display\" data-index=\"${index}\" title=\" | ${filterSummary}\">${filter.name}</span>\n          <div class=\"filter-name-edit-container\" style=\"display: none;\">\n            <input type=\"text\" class=\"filter-name-input\" data-index=\"${index}\" value=\"${filter.name}\">\n            <i class=\"ms-Icon ms-Icon--ReturnKey edit-hint-icon\" title=\"\"></i>\n          </div>\n          <span class=\"filter-condition-time\">${createTime}</span>\n        </div>\n        <div class=\"filter-condition-actions\">\n          <button class=\"icon-button-small apply-filter-btn\" data-index=\"${index}\" data-sheet-name=\"${filter.sheetName}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Play\"></i>\n          </button>\n          <button class=\"icon-button-small danger delete-filter-btn\" data-index=\"${index}\" title=\"\">\n            <i class=\"ms-Icon ms-Icon--Delete\"></i>\n          </button>\n        </div>\n      </div>\n    `;\n  }).join(\"\");\n\n  // \n  container.querySelectorAll(\".filter-name-display\").forEach(span => {\n    span.addEventListener(\"dblclick\", (e) => {\n      const target = e.target as HTMLElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      startEditFilterName(index);\n    });\n  });\n\n  // \n  container.querySelectorAll(\".filter-name-input\").forEach(input => {\n    // \n    input.addEventListener(\"keydown\", (e) => {\n      const keyEvent = e as KeyboardEvent;\n      if (keyEvent.key === \"Enter\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        confirmEditFilterName(index, target.value);\n      } else if (keyEvent.key === \"Escape\") {\n        const target = e.target as HTMLInputElement;\n        const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n        cancelEditFilterName(index);\n      }\n    });\n\n    // \n    input.addEventListener(\"blur\", (e) => {\n      const target = e.target as HTMLInputElement;\n      const index = parseInt(target.getAttribute(\"data-index\") || \"0\");\n      setTimeout(() => {\n        cancelEditFilterName(index);\n      }, 200);\n    });\n  });\n\n  // \n  container.querySelectorAll(\".apply-filter-btn\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      const sheetName = btn.getAttribute(\"data-sheet-name\");\n      if (sheetName) {\n        applyFilterCondition(index, sheetName);\n      }\n    });\n  });\n\n  // \n  container.querySelectorAll(\".delete-filter-btn\").forEach(button => {\n    button.addEventListener(\"click\", (e) => {\n      const btn = e.currentTarget as HTMLElement;\n      const index = parseInt(btn.getAttribute(\"data-index\") || \"0\");\n      deleteFilterCondition(index);\n    });\n  });\n}\n\n// \nfunction startEditFilterName(index: number): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n\n  const displaySpan = container.querySelector(`.filter-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".filter-name-edit-container\") as HTMLElement;\n  const input = editContainer?.querySelector(\".filter-name-input\") as HTMLInputElement;\n\n  if (displaySpan && editContainer && input) {\n    displaySpan.style.display = \"none\";\n    editContainer.style.display = \"flex\";\n    input.focus();\n    input.select();\n  }\n}\n\n// \nfunction cancelEditFilterName(index: number): void {\n  const container = document.getElementById(\"filter-conditions-list\");\n  if (!container) return;\n\n  const displaySpan = container.querySelector(`.filter-name-display[data-index=\"${index}\"]`) as HTMLElement;\n  const editContainer = displaySpan?.parentElement?.querySelector(\".filter-name-edit-container\") as HTMLElement;\n\n  if (displaySpan && editContainer) {\n    displaySpan.style.display = \"inline\";\n    editContainer.style.display = \"none\";\n  }\n}\n\n// \nfunction confirmEditFilterName(index: number, newName: string): void {\n  if (index < 0 || index >= filterConditionsList.length) return;\n\n  newName = newName.trim();\n  const oldName = filterConditionsList[index].name;\n\n  if (!newName || newName === oldName) {\n    cancelEditFilterName(index);\n    return;\n  }\n\n  // \n  filterConditionsList[index].name = newName;\n\n  // \n  updateFilterConditionsList();\n\n  showMessage(`: ${newName}`);\n}\n\n// \nasync function applyFilterCondition(index: number, sheetName: string): Promise<void> {\n  if (index < 0 || index >= filterConditionsList.length) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  const filterCondition = filterConditionsList[index];\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      // \n      const sheet = workbook.worksheets.getItem(filterCondition.config.sheetName);\n      sheet.activate();\n      sheet.load(\"name\");\n\n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"values, rowCount, columnCount, address, rowIndex\");\n      await context.sync();\n\n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      // usedRange.rowIndex  0-based 0\n      const startRow = usedRange.rowIndex + 1; //  1-based Excel \n      const endRow = startRow + usedRange.rowCount - 1;\n\n      // \n      currentMainReportConfig = {\n        dataRange: usedRange.address,\n        headerRow: startRow,\n        snColumn: filterCondition.config.snColumn,\n        amtColumn: filterCondition.config.amtColumn,\n        sheetName: sheet.name\n      };\n\n      // \n      const headerRow = usedRange.values[0];\n      filterPanelFields = [];\n\n      for (let colIdx = 0; colIdx < usedRange.columnCount; colIdx++) {\n        const headerText = headerRow[colIdx] ? String(headerRow[colIdx]) : getColumnName(colIdx);\n        const allValues = new Set<string>();\n\n        for (let rowIdx = 1; rowIdx < usedRange.values.length; rowIdx++) {\n          const cellValue = usedRange.values[rowIdx][colIdx];\n          const valueStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n          if (valueStr !== \"\") {\n            allValues.add(valueStr);\n          }\n        }\n\n        const sortedValues = Array.from(allValues).sort((a, b) => a.localeCompare(b, \"zh-CN\"));\n\n        // \n        const savedFilter = filterCondition.filterSettings.find(f => f.columnIndex === colIdx);\n\n        // \n        let selectedValues: Set<string>;\n        if (savedFilter && savedFilter.isFiltered) {\n          selectedValues = new Set<string>(savedFilter.filterValues.filter(v => allValues.has(v)));\n        } else {\n          selectedValues = new Set<string>(sortedValues);\n        }\n\n        filterPanelFields.push({\n          columnIndex: colIdx,\n          headerText: headerText,\n          allValues: sortedValues,\n          selectedValues: selectedValues,\n          isTimeField: false,\n          timeDimension: \"all\"\n        });\n      }\n\n      // \n      renderFilterPanel();\n\n      // \n      const applyBtn = document.getElementById(\"btn-apply-filter\") as HTMLButtonElement;\n      const clearBtn = document.getElementById(\"btn-clear-filter\") as HTMLButtonElement;\n      const saveBtn = document.getElementById(\"btn-save-filter\") as HTMLButtonElement;\n      const generateBtn = document.getElementById(\"btn-generate\") as HTMLButtonElement;\n      const resetBtn = document.getElementById(\"btn-reset-filter\") as HTMLButtonElement;\n      if (applyBtn) applyBtn.disabled = false;\n      if (clearBtn) clearBtn.disabled = false;\n      if (saveBtn) saveBtn.disabled = false;\n      if (generateBtn) generateBtn.disabled = false;\n      if (resetBtn) resetBtn.disabled = false;\n\n      // \n      const dataStartRow = startRow + 1;\n      for (let excelRow = dataStartRow; excelRow <= endRow; excelRow++) {\n        const row = sheet.getRange(`${excelRow}:${excelRow}`);\n        row.rowHidden = false;\n      }\n      await context.sync();\n\n      //  - \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n\n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n\n      // \n      if (filterEntries.length === 0) {\n        updateCurrentFilterDisplay([]);\n        showMessage(\"\");\n        return;\n      }\n\n      // \n      let hiddenCount = 0;\n      let visibleCount = 0;\n\n      for (let valueIdx = 1; valueIdx < usedRange.values.length; valueIdx++) {\n        const rowData = usedRange.values[valueIdx];\n        const excelRowNum = startRow + valueIdx; //  Excel \n        let shouldHide = false;\n\n        for (const filter of filterEntries) {\n          if (filter.colIdx < rowData.length) {\n            const cellValue = rowData[filter.colIdx];\n            const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n\n            if (!filter.allowedValues.has(cellStr)) {\n              shouldHide = true;\n              break;\n            }\n          }\n        }\n\n        if (shouldHide) {\n          const row = sheet.getRange(`${excelRowNum}:${excelRowNum}`);\n          row.rowHidden = true;\n          hiddenCount++;\n        } else {\n          visibleCount++;\n        }\n      }\n\n      await context.sync();\n\n      // \n      const filterSettings: ColumnFilterSetting[] = filterEntries.map(f => ({\n        columnIndex: f.colIdx,\n        columnName: getColumnName(f.colIdx),\n        headerText: f.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(f.allowedValues),\n        isFiltered: true\n      }));\n\n      updateCurrentFilterDisplay(filterSettings);\n\n      // \n      const filterSummary = filterEntries.map(f => `${f.headerText}(${f.allowedValues.size})`).join(\", \");\n      showMessage(`: ${filterSummary} | ${visibleCount}, ${hiddenCount}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    appendDebugLog(`: ${error.message}`);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction updateCurrentFilterDisplay(filterSettings: ColumnFilterSetting[]): void {\n  const container = document.getElementById(\"current-filter-display\");\n  if (!container) return;\n\n  const activeFilters = filterSettings.filter(f => f.isFiltered);\n\n  if (activeFilters.length === 0) {\n    container.innerHTML = '<div class=\"no-filters\"></div>';\n    return;\n  }\n\n  //  HTML\n  const filterItemsHtml = activeFilters.map((filter, index) => {\n    const values = filter.filterValues;\n    const totalCount = values.length;\n    const MAX_DISPLAY = 3; // 3\n\n    if (totalCount <= MAX_DISPLAY) {\n      // \n      return `\n        <div class=\"current-filter-item\">\n          <span class=\"filter-field\">${filter.headerText}</span>\n          <span class=\"filter-separator\"></span>\n          <span class=\"filter-value\">${values.join(\"\")}</span>\n        </div>\n      `;\n    } else {\n      //  + \"xxx\"\n      const displayValues = values.slice(0, MAX_DISPLAY);\n      const remainingCount = totalCount;\n      const filterId = `filter-expand-${index}`;\n\n      return `\n        <div class=\"current-filter-item\">\n          <span class=\"filter-field\">${filter.headerText}</span>\n          <span class=\"filter-separator\"></span>\n          <span class=\"filter-value-collapsed\" id=\"${filterId}-collapsed\">\n            ${displayValues.join(\"\")}\n            <a href=\"javascript:void(0)\" class=\"filter-expand-link\" onclick=\"expandFilterValues('${filterId}', ${index})\">${remainingCount}</a>\n          </span>\n          <span class=\"filter-value-expanded\" id=\"${filterId}-expanded\" style=\"display: none;\">\n            ${values.join(\"\")}\n            <a href=\"javascript:void(0)\" class=\"filter-collapse-link\" onclick=\"collapseFilterValues('${filterId}')\"></a>\n          </span>\n        </div>\n      `;\n    }\n  }).join(\"\");\n\n  container.innerHTML = `\n    <div class=\"current-filter-title\"></div>\n    <div class=\"current-filter-items\">\n      ${filterItemsHtml}\n    </div>\n  `;\n}\n\n// \nfunction expandFilterValues(filterId: string, _filterIndex: number): void {\n  const collapsedEl = document.getElementById(`${filterId}-collapsed`);\n  const expandedEl = document.getElementById(`${filterId}-expanded`);\n\n  if (collapsedEl && expandedEl) {\n    collapsedEl.style.display = \"none\";\n    expandedEl.style.display = \"inline\";\n  }\n}\n\n// \nfunction collapseFilterValues(filterId: string): void {\n  const collapsedEl = document.getElementById(`${filterId}-collapsed`);\n  const expandedEl = document.getElementById(`${filterId}-expanded`);\n\n  if (collapsedEl && expandedEl) {\n    collapsedEl.style.display = \"inline\";\n    expandedEl.style.display = \"none\";\n  }\n}\n\n//  onclick \n(window as any).expandFilterValues = expandFilterValues;\n(window as any).collapseFilterValues = collapseFilterValues;\n\n// \nfunction refreshCurrentFilterDisplay(): void {\n  const container = document.getElementById(\"current-filter-display\");\n  if (!container) return;\n\n  // \n  const columnFilterSettings: ColumnFilterSetting[] = [];\n\n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      const selectedValuesArray = Array.from(field.selectedValues);\n\n      //  updateCurrentFilterDisplay \n      columnFilterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: selectedValuesArray,  // \n        isFiltered: true\n      });\n    }\n  }\n\n  // \n  if (columnFilterSettings.length > 0) {\n    updateCurrentFilterDisplay(columnFilterSettings);\n  } else if (filterPanelFields.length > 0) {\n    // \n    container.innerHTML = '<div class=\"no-filters\"></div>';\n  } else {\n    // \n    container.innerHTML = '<div class=\"no-filters\">\"\"</div>';\n  }\n}\n\n// \nfunction deleteFilterCondition(index: number): void {\n  if (index >= 0 && index < filterConditionsList.length) {\n    filterConditionsList.splice(index, 1);\n    updateFilterConditionsList();\n    showMessage(\"\");\n  }\n}\n\n// \nasync function enableFilter(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const activeSheet = workbook.worksheets.getActiveWorksheet();\n      activeSheet.load(\"name\");\n\n      // \n      const usedRange = activeSheet.getUsedRange();\n      usedRange.load(\"values, rowCount, columnCount, address\");\n      await context.sync();\n\n      if (!usedRange.values || usedRange.values.length < 2) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      // \n      const headerRow = usedRange.values[0];\n\n      // \n      currentMainReportConfig = {\n        dataRange: usedRange.address,\n        headerRow: 1,\n        snColumn: currentMainReportConfig?.snColumn || 0,\n        amtColumn: currentMainReportConfig?.amtColumn || 0,\n        sheetName: activeSheet.name\n      };\n\n      // \n      filterPanelFields = [];\n\n      // \n      for (let colIdx = 0; colIdx < usedRange.columnCount; colIdx++) {\n        const headerText = headerRow[colIdx] ? String(headerRow[colIdx]) : getColumnName(colIdx);\n        const allValues = new Set<string>();\n\n        // \n        for (let rowIdx = 1; rowIdx < usedRange.values.length; rowIdx++) {\n          const cellValue = usedRange.values[rowIdx][colIdx];\n          const valueStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n          if (valueStr !== \"\") {\n            allValues.add(valueStr);\n          }\n        }\n\n        //  Set \n        const sortedValues = Array.from(allValues).sort((a, b) => a.localeCompare(b, \"zh-CN\"));\n\n        filterPanelFields.push({\n          columnIndex: colIdx,\n          headerText: headerText,\n          allValues: sortedValues,\n          selectedValues: new Set<string>(sortedValues), // \n          isTimeField: false,\n          timeDimension: \"all\"\n        });\n      }\n\n      // \n      renderFilterPanel();\n\n      // \n      const applyBtn = document.getElementById(\"btn-apply-filter\") as HTMLButtonElement;\n      const clearBtn = document.getElementById(\"btn-clear-filter\") as HTMLButtonElement;\n      const saveBtn = document.getElementById(\"btn-save-filter\") as HTMLButtonElement;\n      const generateBtn = document.getElementById(\"btn-generate\") as HTMLButtonElement;\n      const resetBtn = document.getElementById(\"btn-reset-filter\") as HTMLButtonElement;\n      if (applyBtn) applyBtn.disabled = false;\n      if (clearBtn) clearBtn.disabled = false;\n      if (saveBtn) saveBtn.disabled = false;\n      if (generateBtn) generateBtn.disabled = false;\n      if (resetBtn) resetBtn.disabled = false;\n\n      // \n      updateMainReportConfigDisplay();\n\n      showMessage(` ${filterPanelFields.length} `);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \n// \nlet activeFilterFieldIndex: number = -1;\n\nfunction renderFilterPanel(): void {\n  const panel = document.getElementById(\"filter-panel\");\n  if (!panel) return;\n\n  if (filterPanelFields.length === 0) {\n    panel.innerHTML = '<div class=\"filter-panel-hint\">\"\"</div>';\n    return;\n  }\n\n  // \n  let tagsHtml = '<div class=\"filter-tags-container\">';\n\n  for (let i = 0; i < filterPanelFields.length; i++) {\n    const field = filterPanelFields[i];\n    const selectedCount = field.selectedValues.size;\n    const totalCount = field.allValues.length;\n    const isFiltered = selectedCount < totalCount;\n    const isActive = i === activeFilterFieldIndex;\n\n    let tagClass = \"filter-tag\";\n    if (isFiltered) tagClass += \" filtered\";\n    if (isActive) tagClass += \" active\";\n    if (field.isTimeField) tagClass += \" time-field\";\n\n    tagsHtml += `\n      <div class=\"${tagClass}\" data-field-index=\"${i}\">\n        <span class=\"filter-tag-name\">${escapeHtml(field.headerText)}</span>\n        <span class=\"filter-tag-count\">${isFiltered ? selectedCount + '/' : ''}${totalCount}</span>\n        <span class=\"time-field-toggle ${field.isTimeField ? 'active' : ''}\" \n              data-field-index=\"${i}\" title=\"\">T</span>\n      </div>\n    `;\n  }\n\n  tagsHtml += '</div>';\n\n  // \n  let dropdownHtml = '';\n\n  if (activeFilterFieldIndex >= 0 && activeFilterFieldIndex < filterPanelFields.length) {\n    const field = filterPanelFields[activeFilterFieldIndex];\n    const fieldId = `filter-field-${activeFilterFieldIndex}`;\n\n    // \n    let timeDimensionHtml = '';\n    if (field.isTimeField) {\n      timeDimensionHtml = `\n        <div class=\"time-dimension-selector\">\n          <span class=\"time-dimension-label\"></span>\n          <select class=\"time-dimension-select\" id=\"${fieldId}-dimension\" data-field-index=\"${activeFilterFieldIndex}\">\n            <option value=\"all\" ${field.timeDimension === 'all' ? 'selected' : ''}></option>\n            <option value=\"year\" ${field.timeDimension === 'year' ? 'selected' : ''}></option>\n            <option value=\"month\" ${field.timeDimension === 'month' ? 'selected' : ''}></option>\n            <option value=\"day\" ${field.timeDimension === 'day' ? 'selected' : ''}></option>\n          </select>\n        </div>\n      `;\n    }\n\n    dropdownHtml = `\n      <div class=\"filter-dropdown show\" data-field-index=\"${activeFilterFieldIndex}\">\n        <div class=\"filter-dropdown-header\">\n          <span class=\"filter-dropdown-title\">${escapeHtml(field.headerText)} </span>\n          <button class=\"filter-dropdown-close\" id=\"btn-close-dropdown\"></button>\n        </div>\n        ${timeDimensionHtml}\n        <input type=\"text\" class=\"filter-field-search\" placeholder=\"...\" \n               id=\"${fieldId}-search\" data-field-index=\"${activeFilterFieldIndex}\">\n        <div class=\"filter-options-container\" id=\"${fieldId}-options\">\n    `;\n\n    // \n    let displayValues: string[] = field.allValues;\n    if (field.isTimeField && field.timeDimension !== 'all' && field.timeValues) {\n      displayValues = field.timeValues[field.timeDimension] || field.allValues;\n    }\n\n    for (let j = 0; j < displayValues.length; j++) {\n      const value = displayValues[j];\n      const isSelected = field.selectedValues.has(value);\n      const displayValue = value.length > 40 ? value.substring(0, 40) + \"...\" : value;\n\n      dropdownHtml += `\n        <div class=\"filter-option ${isSelected ? 'selected' : ''}\" \n             data-field-index=\"${activeFilterFieldIndex}\" data-value-index=\"${j}\" data-value=\"${escapeHtml(value)}\">\n          <input type=\"checkbox\" ${isSelected ? 'checked' : ''} \n                 id=\"${fieldId}-opt-${j}\" data-field-index=\"${activeFilterFieldIndex}\" data-value=\"${escapeHtml(value)}\">\n          <span class=\"filter-option-label\" title=\"${escapeHtml(value)}\">${escapeHtml(displayValue)}</span>\n        </div>\n      `;\n    }\n\n    dropdownHtml += `\n        </div>\n        <div class=\"filter-select-actions\" id=\"${fieldId}-actions\">\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"all\"></button>\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"none\"></button>\n          <button class=\"filter-select-action\" data-field-index=\"${activeFilterFieldIndex}\" data-action=\"invert\"></button>\n        </div>\n        <div class=\"filter-search-hint\" id=\"${fieldId}-search-hint\" style=\"display: none;\">\n          <i class=\"ms-Icon ms-Icon--Info\" aria-hidden=\"true\"></i>\n          <span></span>\n        </div>\n      </div>\n    `;\n  }\n\n  panel.innerHTML = tagsHtml + dropdownHtml;\n\n  //  panel \n}\n\n// HTML \nfunction escapeHtml(text: string): string {\n  const div = document.createElement(\"div\");\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n// ========================================\n// \n// ========================================\n\n// \nasync function toggleTimeField(fieldIndex: number): Promise<void> {\n  if (fieldIndex < 0 || fieldIndex >= filterPanelFields.length) return;\n\n  const field = filterPanelFields[fieldIndex];\n  field.isTimeField = !field.isTimeField;\n\n  if (field.isTimeField) {\n    // \n    showMessage(`\"${field.headerText}\"`);\n    await checkTimeFieldFormat(fieldIndex);\n  } else {\n    // \n    field.timeDimension = \"all\";\n    field.timeValues = undefined;\n    showMessage(`\"${field.headerText}\"`);\n  }\n\n  renderFilterPanel();\n}\n\n// \nasync function checkTimeFieldFormat(fieldIndex: number): Promise<void> {\n  if (fieldIndex < 0 || fieldIndex >= filterPanelFields.length) return;\n\n  const field = filterPanelFields[fieldIndex];\n  if (!currentMainReportConfig) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  showProgress(\"\", \"...\");\n\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"values, rowCount\");\n      await context.sync();\n\n      const colIndex = field.columnIndex;\n      const rowCount = usedRange.rowCount;\n\n      let standardCount = 0;\n      let nonStandardCount = 0;\n      const nonStandardRows: number[] = [];\n      const nonStandardValues: string[] = [];\n\n      // \n      for (let i = 1; i < rowCount; i++) { // \n        const cellValue = usedRange.values[i][colIndex];\n\n        // \n        if (i % 100 === 0) {\n          updateProgress(i, rowCount, ` ${i}/${rowCount} `);\n        }\n\n        if (cellValue === null || cellValue === undefined || cellValue === \"\") {\n          continue;\n        }\n\n        const isStandard = isStandardDateFormat(cellValue);\n        if (isStandard) {\n          standardCount++;\n        } else {\n          nonStandardCount++;\n          if (nonStandardRows.length < 10) { // 10\n            nonStandardRows.push(i + 1); // Excel \n            nonStandardValues.push(String(cellValue));\n          }\n        }\n      }\n\n      updateProgress(rowCount, rowCount, \"\");\n      hideProgress();\n\n      // \n      calculateTimeValues(fieldIndex, usedRange.values, colIndex);\n\n      // \n      if (nonStandardCount === 0) {\n        showMessage(`\"${field.headerText}\" ${standardCount} `);\n      } else {\n        // \n        const examples = nonStandardValues.slice(0, 3).join(\"\");\n        const confirmMsg = `\"${field.headerText}\" ${nonStandardCount} ${examples}...\\n`;\n\n        if (confirm(confirmMsg)) {\n          await convertTimeFormat(fieldIndex, usedRange, sheet, context);\n        } else {\n          showMessage(` ${nonStandardCount} `);\n        }\n      }\n    });\n  } catch (error) {\n    hideProgress();\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction isStandardDateFormat(value: any): boolean {\n  if (value === null || value === undefined || value === \"\") {\n    return true; // \n  }\n\n  // Excel \n  if (typeof value === \"number\") {\n    return true;\n  }\n\n  const str = String(value).trim();\n\n  // \n  const standardPatterns = [\n    /^\\d{4}[-/]\\d{1,2}[-/]\\d{1,2}$/,  // 2024-01-15  2024/01/15\n    /^\\d{4}[-/]\\d{1,2}[-/]\\d{1,2}\\s+\\d{1,2}:\\d{2}(:\\d{2})?$/,  // 2024-01-15 10:30  2024-01-15 10:30:00\n    /^\\d{1,2}[-/]\\d{1,2}[-/]\\d{4}$/,  // 01-15-2024  01/15/2024\n    /^\\d{4}\\d{1,2}\\d{1,2}$/,    // 2024115\n  ];\n\n  for (const pattern of standardPatterns) {\n    if (pattern.test(str)) {\n      return true;\n    }\n  }\n\n  // \n  const date = new Date(str);\n  if (!isNaN(date.getTime())) {\n    return true;\n  }\n\n  return false;\n}\n\n// \nasync function convertTimeFormat(\n  fieldIndex: number,\n  usedRange: Excel.Range,\n  sheet: Excel.Worksheet,\n  context: Excel.RequestContext\n): Promise<void> {\n  const field = filterPanelFields[fieldIndex];\n  const colIndex = field.columnIndex;\n  const colName = getColumnName(colIndex);\n\n  showProgress(\"\", \"...\");\n\n  let convertedCount = 0;\n  const rowCount = usedRange.values.length;\n\n  for (let i = 1; i < rowCount; i++) { // \n    const cellValue = usedRange.values[i][colIndex];\n\n    if (i % 50 === 0) {\n      updateProgress(i, rowCount, ` ${i}/${rowCount} `);\n    }\n\n    if (cellValue === null || cellValue === undefined || cellValue === \"\") {\n      continue;\n    }\n\n    if (!isStandardDateFormat(cellValue)) {\n      // \n      const converted = tryConvertToDate(cellValue);\n      if (converted) {\n        const excelRow = i + 1; // Excel \n        const cellAddress = `${colName}${excelRow}`;\n        const cell = sheet.getRange(cellAddress);\n        cell.values = [[converted]];\n        cell.format.font.color = \"#7b1fa2\"; // \n        convertedCount++;\n      }\n    }\n  }\n\n  await context.sync();\n\n  updateProgress(rowCount, rowCount, \"\");\n  hideProgress();\n\n  // \n  await recalculateTimeValues(fieldIndex);\n\n  showMessage(` ${convertedCount} `);\n}\n\n// \nfunction tryConvertToDate(value: any): string | null {\n  const str = String(value).trim();\n\n  // \n  // 1: 20240115 -> 2024-01-15\n  if (/^\\d{8}$/.test(str)) {\n    return `${str.slice(0, 4)}-${str.slice(4, 6)}-${str.slice(6, 8)}`;\n  }\n\n  // 2: 2024.01.15 -> 2024-01-15\n  if (/^\\d{4}\\.\\d{1,2}\\.\\d{1,2}$/.test(str)) {\n    return str.replace(/\\./g, \"-\");\n  }\n\n  // 3: 15-01-2024 (--) -> 2024-01-15\n  const dmyMatch = str.match(/^(\\d{1,2})[-/](\\d{1,2})[-/](\\d{4})$/);\n  if (dmyMatch) {\n    const [, day, month, year] = dmyMatch;\n    return `${year}-${month.padStart(2, \"0\")}-${day.padStart(2, \"0\")}`;\n  }\n\n  // 4: 2024115 -> 2024-01-15\n  const cnMatch = str.match(/^(\\d{4})(\\d{1,2})(\\d{1,2})?$/);\n  if (cnMatch) {\n    const [, year, month, day] = cnMatch;\n    return `${year}-${month.padStart(2, \"0\")}-${day.padStart(2, \"0\")}`;\n  }\n\n  // 5: Jan 15, 2024  January 15, 2024 -> 2024-01-15\n  const enMonths: { [key: string]: string } = {\n    \"jan\": \"01\", \"january\": \"01\",\n    \"feb\": \"02\", \"february\": \"02\",\n    \"mar\": \"03\", \"march\": \"03\",\n    \"apr\": \"04\", \"april\": \"04\",\n    \"may\": \"05\",\n    \"jun\": \"06\", \"june\": \"06\",\n    \"jul\": \"07\", \"july\": \"07\",\n    \"aug\": \"08\", \"august\": \"08\",\n    \"sep\": \"09\", \"september\": \"09\",\n    \"oct\": \"10\", \"october\": \"10\",\n    \"nov\": \"11\", \"november\": \"11\",\n    \"dec\": \"12\", \"december\": \"12\"\n  };\n\n  const enMatch = str.toLowerCase().match(/^([a-z]+)\\s+(\\d{1,2}),?\\s+(\\d{4})$/);\n  if (enMatch) {\n    const [, monthStr, day, year] = enMatch;\n    const month = enMonths[monthStr];\n    if (month) {\n      return `${year}-${month}-${day.padStart(2, \"0\")}`;\n    }\n  }\n\n  //  Date \n  const date = new Date(str);\n  if (!isNaN(date.getTime())) {\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, \"0\");\n    const day = String(date.getDate()).padStart(2, \"0\");\n    return `${year}-${month}-${day}`;\n  }\n\n  return null;\n}\n\n// \nfunction calculateTimeValues(fieldIndex: number, values: any[][], colIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n\n  const years = new Set<string>();\n  const months = new Set<string>();\n  const days = new Set<string>();\n\n  for (let i = 1; i < values.length; i++) {\n    const cellValue = values[i][colIndex];\n    if (cellValue === null || cellValue === undefined || cellValue === \"\") {\n      continue;\n    }\n\n    const dateInfo = extractDateInfo(cellValue);\n    if (dateInfo) {\n      years.add(dateInfo.year);\n      months.add(dateInfo.yearMonth);\n      days.add(dateInfo.date);\n    }\n  }\n\n  field.timeValues = {\n    year: Array.from(years).sort(),\n    month: Array.from(months).sort(),\n    day: Array.from(days).sort()\n  };\n}\n\n// \nfunction extractDateInfo(value: any): { year: string; yearMonth: string; date: string } | null {\n  let date: Date | null = null;\n\n  if (typeof value === \"number\") {\n    // Excel \n    date = excelDateToJSDate(value);\n  } else {\n    const str = String(value).trim();\n    date = new Date(str);\n\n    // \n    if (isNaN(date.getTime())) {\n      //  YYYYMMDD \n      if (/^\\d{8}$/.test(str)) {\n        const y = parseInt(str.slice(0, 4));\n        const m = parseInt(str.slice(4, 6)) - 1;\n        const d = parseInt(str.slice(6, 8));\n        date = new Date(y, m, d);\n      }\n    }\n  }\n\n  if (!date || isNaN(date.getTime())) {\n    return null;\n  }\n\n  const year = String(date.getFullYear());\n  const month = String(date.getMonth() + 1).padStart(2, \"0\");\n  const day = String(date.getDate()).padStart(2, \"0\");\n\n  return {\n    year: year,\n    yearMonth: `${year}-${month}`,\n    date: `${year}-${month}-${day}`\n  };\n}\n\n// Excel  JS Date\nfunction excelDateToJSDate(excelDate: number): Date {\n  // Excel  1900-01-01  1\n  //  Excel  1900 \n  const excelEpoch = new Date(1899, 11, 30); // 1899-12-30\n  const msPerDay = 24 * 60 * 60 * 1000;\n  return new Date(excelEpoch.getTime() + excelDate * msPerDay);\n}\n\n// \nasync function recalculateTimeValues(fieldIndex: number): Promise<void> {\n  if (!currentMainReportConfig) return;\n\n  const field = filterPanelFields[fieldIndex];\n\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"values\");\n      await context.sync();\n\n      calculateTimeValues(fieldIndex, usedRange.values, field.columnIndex);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nfunction changeTimeDimension(fieldIndex: number, dimension: TimeDimension): void {\n  if (fieldIndex < 0 || fieldIndex >= filterPanelFields.length) return;\n\n  const field = filterPanelFields[fieldIndex];\n  field.timeDimension = dimension;\n\n  //  selectedValues\n  if (dimension === \"all\") {\n    // \n    field.selectedValues = new Set<string>(field.allValues);\n  } else if (field.timeValues && field.timeValues[dimension]) {\n    // \n    field.selectedValues = new Set<string>(field.timeValues[dimension]);\n  }\n\n  renderFilterPanel();\n  showMessage(`\"${field.headerText}\"${getDimensionLabel(dimension)}`);\n}\n\n// \nfunction getDimensionLabel(dimension: TimeDimension): string {\n  switch (dimension) {\n    case \"year\": return \"\";\n    case \"month\": return \"\";\n    case \"day\": return \"\";\n    default: return \"\";\n  }\n}\n\n// ========================================\n// \n// ========================================\n\n// \nlet filterPanelEventsBound = false;\n\n// \nfunction bindFilterPanelEvents(): void {\n  const panel = document.getElementById(\"filter-panel\");\n  if (!panel || filterPanelEventsBound) return;\n\n  filterPanelEventsBound = true;\n  console.log(\"[] \");\n\n  // \n  panel.addEventListener(\"click\", (e) => {\n    const target = e.target as HTMLElement;\n\n    // 0. T - \n    if (target.classList.contains(\"time-field-toggle\")) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"-1\", 10);\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        toggleTimeField(fieldIndex);\n      }\n      return;\n    }\n\n    // 1.  - \n    const tagElement = target.closest(\".filter-tag\") as HTMLElement;\n    if (tagElement && !target.classList.contains(\"time-field-toggle\")) {\n      const fieldIndex = parseInt(tagElement.getAttribute(\"data-field-index\") || \"-1\", 10);\n\n      if (fieldIndex === activeFilterFieldIndex) {\n        activeFilterFieldIndex = -1;\n      } else {\n        activeFilterFieldIndex = fieldIndex;\n\n        // \n        if (filterPanelFields[fieldIndex].isTimeField) {\n          checkTimeFieldFormat(fieldIndex);\n        }\n      }\n\n      renderFilterPanel();\n      return;\n    }\n\n    // 2. \n    if (target.id === \"btn-close-dropdown\" || target.closest(\"#btn-close-dropdown\")) {\n      activeFilterFieldIndex = -1;\n      renderFilterPanel();\n      return;\n    }\n\n    // 3. //\n    const actionButton = target.closest(\".filter-select-action\") as HTMLElement;\n    if (actionButton) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const fieldIndex = parseInt(actionButton.getAttribute(\"data-field-index\") || \"0\", 10);\n      const action = actionButton.getAttribute(\"data-action\");\n\n      console.log(`[] action=${action}, fieldIndex=${fieldIndex}`);\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        const field = filterPanelFields[fieldIndex];\n\n        // \n        const searchInput = document.getElementById(`filter-field-${fieldIndex}-search`) as HTMLInputElement;\n        const searchText = searchInput ? searchInput.value.trim() : \"\";\n        const isSearchMode = searchText.length > 0;\n\n        console.log(`[] isSearchMode=${isSearchMode}, searchText=\"${searchText}\"`);\n        console.log(`[]  selectedValues.size=${field.selectedValues.size}, allValues.length=${field.allValues.length}`);\n\n        if (isSearchMode) {\n          // \n          const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n          const visibleValues: string[] = [];\n          if (optionsContainer) {\n            const options = optionsContainer.querySelectorAll(\".filter-option:not(.hidden)\");\n            options.forEach((option) => {\n              const valueIndexStr = option.getAttribute(\"data-value-index\");\n              const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n              const value = valueIndex >= 0 && valueIndex < field.allValues.length\n                ? field.allValues[valueIndex]\n                : option.getAttribute(\"data-value\") || \"\";\n              visibleValues.push(value);\n            });\n          }\n\n          console.log(`[] : ${visibleValues.length}`);\n\n          if (action === \"all\") {\n            for (const v of visibleValues) {\n              field.selectedValues.add(v);\n            }\n          } else if (action === \"none\") {\n            for (const v of visibleValues) {\n              field.selectedValues.delete(v);\n            }\n          } else if (action === \"invert\") {\n            for (const v of visibleValues) {\n              if (field.selectedValues.has(v)) {\n                field.selectedValues.delete(v);\n              } else {\n                field.selectedValues.add(v);\n              }\n            }\n          }\n        } else {\n          // \n          console.log(`[]  ${field.allValues.length} `);\n\n          if (action === \"all\") {\n            field.selectedValues = new Set<string>(field.allValues);\n          } else if (action === \"none\") {\n            field.selectedValues = new Set<string>();\n          } else if (action === \"invert\") {\n            const newSelected = new Set<string>();\n            for (const v of field.allValues) {\n              if (!field.selectedValues.has(v)) {\n                newSelected.add(v);\n              }\n            }\n            console.log(`[]  ${field.selectedValues.size}  ${newSelected.size} `);\n            field.selectedValues = newSelected;\n          }\n        }\n\n        console.log(`[]  selectedValues.size=${field.selectedValues.size}`);\n\n        // \n        updateFieldOptions(fieldIndex);\n        // \n        updateTagCount(fieldIndex);\n      }\n      return;\n    }\n\n    // 4. \n    const optionDiv = target.closest(\".filter-option\") as HTMLElement;\n    if (optionDiv && target.tagName !== \"INPUT\") {\n      const fieldIndex = parseInt(optionDiv.getAttribute(\"data-field-index\") || \"0\", 10);\n      const checkbox = optionDiv.querySelector(\"input[type='checkbox']\") as HTMLInputElement;\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length && checkbox) {\n        const field = filterPanelFields[fieldIndex];\n\n        //  data-value-index \n        const valueIndexStr = optionDiv.getAttribute(\"data-value-index\");\n        const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n        const value = valueIndex >= 0 && valueIndex < field.allValues.length\n          ? field.allValues[valueIndex]\n          : optionDiv.getAttribute(\"data-value\") || \"\";\n\n        // \n        const newChecked = !checkbox.checked;\n        checkbox.checked = newChecked;\n\n        if (newChecked) {\n          field.selectedValues.add(value);\n        } else {\n          field.selectedValues.delete(value);\n        }\n\n        //  selected \n        optionDiv.classList.toggle(\"selected\", newChecked);\n\n        // \n        updateTagCount(fieldIndex);\n      }\n      return;\n    }\n  });\n\n  // \n  panel.addEventListener(\"input\", (e) => {\n    const target = e.target as HTMLInputElement;\n    if (target.classList.contains(\"filter-field-search\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"0\", 10);\n      filterSearchOptions(fieldIndex, target.value);\n    }\n  });\n\n  //  change \n  panel.addEventListener(\"change\", (e) => {\n    const target = e.target as HTMLInputElement;\n    if (target.type === \"checkbox\" && target.closest(\".filter-option\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"0\", 10);\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        const field = filterPanelFields[fieldIndex];\n\n        //  data-value-index \n        const optionDiv = target.closest(\".filter-option\") as HTMLElement;\n        let value = target.getAttribute(\"data-value\") || \"\";\n        if (optionDiv) {\n          const valueIndexStr = optionDiv.getAttribute(\"data-value-index\");\n          const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n          if (valueIndex >= 0 && valueIndex < field.allValues.length) {\n            value = field.allValues[valueIndex];\n          }\n        }\n\n        if (target.checked) {\n          field.selectedValues.add(value);\n        } else {\n          field.selectedValues.delete(value);\n        }\n\n        //  selected \n        if (optionDiv) {\n          optionDiv.classList.toggle(\"selected\", target.checked);\n        }\n\n        // \n        updateTagCount(fieldIndex);\n      }\n    }\n\n    //  change \n    if (target.classList.contains(\"time-dimension-select\")) {\n      const fieldIndex = parseInt(target.getAttribute(\"data-field-index\") || \"-1\", 10);\n      const selectEl = target as unknown as HTMLSelectElement;\n      const dimension = selectEl.value as TimeDimension;\n\n      if (fieldIndex >= 0 && fieldIndex < filterPanelFields.length) {\n        changeTimeDimension(fieldIndex, dimension);\n      }\n    }\n  });\n}\n\n// \nfunction updateTagCount(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  if (!field) return;\n\n  const tag = document.querySelector(`.filter-tag[data-field-index=\"${fieldIndex}\"]`);\n  if (!tag) return;\n\n  const selectedCount = field.selectedValues.size;\n  const totalCount = field.allValues.length;\n  const isFiltered = selectedCount < totalCount;\n\n  // \n  tag.classList.toggle(\"filtered\", isFiltered);\n\n  // \n  const countSpan = tag.querySelector(\".filter-tag-count\");\n  if (countSpan) {\n    countSpan.textContent = isFiltered ? `${selectedCount}/${totalCount}` : `${totalCount}`;\n  }\n}\n\n// \nfunction filterSearchOptions(fieldIndex: number, searchText: string): void {\n  const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n  const actionsContainer = document.getElementById(`filter-field-${fieldIndex}-actions`);\n  const searchHint = document.getElementById(`filter-field-${fieldIndex}-search-hint`);\n  if (!optionsContainer) return;\n\n  const options = optionsContainer.querySelectorAll(\".filter-option\");\n  const searchLower = searchText.toLowerCase().trim();\n  const hasSearchText = searchLower.length > 0;\n\n  let visibleCount = 0;\n  options.forEach((option) => {\n    const value = option.getAttribute(\"data-value\") || \"\";\n    const matches = value.toLowerCase().includes(searchLower);\n    option.classList.toggle(\"hidden\", !matches);\n    if (matches) visibleCount++;\n  });\n\n  // \n  if (actionsContainer) {\n    actionsContainer.classList.toggle(\"search-mode\", hasSearchText);\n  }\n  if (searchHint) {\n    searchHint.style.display = hasSearchText ? \"flex\" : \"none\";\n    // \n    const hintSpan = searchHint.querySelector(\"span\");\n    if (hintSpan && hasSearchText) {\n      hintSpan.textContent = `${visibleCount} `;\n    }\n  }\n}\n\n// /\nfunction updateFieldOptions(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  const optionsContainer = document.getElementById(`filter-field-${fieldIndex}-options`);\n  if (!optionsContainer || !field) return;\n\n  const options = optionsContainer.querySelectorAll(\".filter-option\");\n  options.forEach((option) => {\n    //  data-value-index  HTML \n    const valueIndexStr = option.getAttribute(\"data-value-index\");\n    const valueIndex = valueIndexStr !== null ? parseInt(valueIndexStr, 10) : -1;\n    const value = valueIndex >= 0 && valueIndex < field.allValues.length\n      ? field.allValues[valueIndex]\n      : option.getAttribute(\"data-value\") || \"\";\n\n    const isSelected = field.selectedValues.has(value);\n    const checkbox = option.querySelector(\"input[type='checkbox']\") as HTMLInputElement;\n    if (checkbox) {\n      checkbox.checked = isSelected;\n    }\n    option.classList.toggle(\"selected\", isSelected);\n  });\n\n  console.log(`[updateFieldOptions] fieldIndex=${fieldIndex},  ${options.length} `);\n}\n\n// \nfunction updateFieldCountDisplay(fieldIndex: number): void {\n  const field = filterPanelFields[fieldIndex];\n  const fieldGroup = document.querySelector(`[data-field-index=\"${fieldIndex}\"].filter-field-group`);\n  if (!fieldGroup || !field) return;\n\n  const label = fieldGroup.querySelector(\".filter-field-label\");\n  if (label) {\n    const selectedCount = field.selectedValues.size;\n    const totalCount = field.allValues.length;\n    const isFiltered = selectedCount < totalCount;\n\n    label.innerHTML = `\n      ${field.headerText} \n      <span style=\"font-weight: normal; color: ${isFiltered ? '#0078d4' : '#605e5c'};\">\n        (${selectedCount}/${totalCount})\n      </span>\n    `;\n  }\n}\n\n//  Excel\nasync function applyFilterFromPanel(): Promise<void> {\n  if (filterPanelFields.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  showMessage(\"...\", false);\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      let targetSheet: Excel.Worksheet;\n\n      if (currentMainReportConfig) {\n        targetSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n      } else {\n        targetSheet = workbook.worksheets.getActiveWorksheet();\n      }\n\n      targetSheet.activate();\n\n      // \n      const usedRange = targetSheet.getUsedRange();\n      usedRange.load(\"values, rowCount, rowIndex, columnCount\");\n      await context.sync();\n\n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n\n      const startRow = usedRange.rowIndex; // 0-based\n      const rowCount = usedRange.rowCount;\n      const columnCount = usedRange.columnCount;\n\n      // \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n\n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n\n      // =====  =====\n      const rowVisibility: boolean[] = []; // true = , false = \n      rowVisibility.push(true); // \n\n      let visibleCount = 0;\n      let hiddenCount = 0;\n      let totalAmount = 0; // \n\n      // \n      const amtColIndex = currentMainReportConfig?.amtColumn ?? -1;\n\n      // \n      for (let valueIdx = 1; valueIdx < usedRange.values.length; valueIdx++) {\n        const rowData = usedRange.values[valueIdx];\n        let shouldShow = true;\n\n        if (filterEntries.length > 0) {\n          for (const filter of filterEntries) {\n            if (filter.colIdx < rowData.length) {\n              const cellValue = rowData[filter.colIdx];\n              const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n\n              if (!filter.allowedValues.has(cellStr)) {\n                shouldShow = false;\n                break;\n              }\n            }\n          }\n        }\n\n        rowVisibility.push(shouldShow);\n        if (shouldShow) {\n          visibleCount++;\n          // \n          if (amtColIndex >= 0 && amtColIndex < rowData.length) {\n            const amountValue = rowData[amtColIndex];\n            totalAmount += cleanAmount(amountValue);\n          }\n        } else {\n          hiddenCount++;\n        }\n      }\n\n      // \n      currentFilterStatistics = {\n        filteredRowCount: visibleCount,\n        totalAmount: totalAmount,\n        isValid: true\n      };\n\n      // =====  =====\n      // \n      const allDataRowsStart = startRow + 2; // Excel \n      const allDataRowsEnd = startRow + rowCount;\n      if (allDataRowsEnd >= allDataRowsStart) {\n        const allDataRows = targetSheet.getRange(`${allDataRowsStart}:${allDataRowsEnd}`);\n        allDataRows.rowHidden = false;\n      }\n      await context.sync();\n\n      // \n      // \n      let i = 1; // \n      let hiddenRangeCount = 0;\n      while (i < rowVisibility.length) {\n        if (!rowVisibility[i]) {\n          // \n          let endIdx = i;\n\n          // \n          while (endIdx + 1 < rowVisibility.length && !rowVisibility[endIdx + 1]) {\n            endIdx++;\n          }\n\n          // \n          const rangeStartRow = startRow + i + 1; // Excel  (1-based)\n          const rangeEndRow = startRow + endIdx + 1;\n          const range = targetSheet.getRange(`${rangeStartRow}:${rangeEndRow}`);\n          range.rowHidden = true;\n          hiddenRangeCount++;\n\n          i = endIdx + 1;\n        } else {\n          i++;\n        }\n      }\n\n      await context.sync();\n\n      // \n      appendDebugLog(`:  ${hiddenRangeCount} ,  ${hiddenCount} `);\n      appendDebugLog(`: Excel  ${startRow + 1} ,  ${rowCount} `);\n\n      // =====  =====\n      // \n      const dataRange = targetSheet.getRangeByIndexes(startRow + 1, 0, rowCount - 1, columnCount);\n      dataRange.format.rowHeight = 20; //  20 \n      await context.sync();\n\n      // \n      const filterSettings: ColumnFilterSetting[] = filterEntries.map(f => ({\n        columnIndex: f.colIdx,\n        columnName: getColumnName(f.colIdx),\n        headerText: f.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(f.allowedValues),\n        isFiltered: true\n      }));\n\n      updateCurrentFilterDisplay(filterSettings);\n\n      // \n      updateFilterTextDisplay();\n      await copyFilterTextToClipboard();\n\n      // \n      const filterSummary = filterEntries.map(f => {\n        const count = f.allowedValues.size;\n        return `${f.headerText}(${count})`;\n      }).join(\", \");\n\n      showMessage(`: ${filterSummary} | ${visibleCount}, ${hiddenCount}`);\n      appendDebugLog(`: ${filterSummary}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function clearFilterFromPanel(): Promise<void> {\n  // \n  for (const field of filterPanelFields) {\n    field.selectedValues = new Set<string>(field.allValues);\n  }\n\n  // \n  currentFilterStatistics = {\n    filteredRowCount: 0,\n    totalAmount: 0,\n    isValid: false\n  };\n\n  // \n  renderFilterPanel();\n\n  // \n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      let targetSheet: Excel.Worksheet;\n\n      if (currentMainReportConfig) {\n        targetSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n      } else {\n        targetSheet = workbook.worksheets.getActiveWorksheet();\n      }\n\n      const usedRange = targetSheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex, columnCount\");\n      await context.sync();\n\n      // \n      const dataRowCount = usedRange.rowCount - 1;\n      if (dataRowCount > 0) {\n        const startRowNum = usedRange.rowIndex + 2; // Excel \n        const endRowNum = usedRange.rowIndex + usedRange.rowCount;\n        const allDataRows = targetSheet.getRange(`${startRowNum}:${endRowNum}`);\n        allDataRows.rowHidden = false;\n\n        // \n        allDataRows.format.rowHeight = 20;\n      }\n      await context.sync();\n\n      updateCurrentFilterDisplay([]);\n\n      // \n      const filterTextContainer = document.getElementById(\"filter-text-container\");\n      if (filterTextContainer) {\n        filterTextContainer.style.display = \"none\";\n      }\n\n      showMessage(\"\");\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nfunction saveFilterFromPanel(): void {\n  if (filterPanelFields.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  const filterSettings: ColumnFilterSetting[] = [];\n\n  for (const field of filterPanelFields) {\n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      filterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(field.selectedValues),\n        isFiltered: true\n      });\n    }\n  }\n\n  if (filterSettings.length === 0) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  const filterCondition: FilterCondition = {\n    id: `filter_${Date.now()}`,\n    name: `_${new Date().toLocaleString(\"zh-CN\", { month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\" })}`,\n    createTime: new Date().toISOString(),\n    sheetName: currentMainReportConfig?.sheetName || \"\",\n    filterSettings: filterSettings,\n    config: currentMainReportConfig ? { ...currentMainReportConfig } : {\n      dataRange: \"\",\n      headerRow: 1,\n      snColumn: 0,\n      amtColumn: 0,\n      sheetName: \"\"\n    }\n  };\n\n  filterConditionsList.unshift(filterCondition);\n  updateFilterConditionsList();\n\n  const filterSummary = filterSettings.map(f => `${f.headerText}(${f.filterValues.length})`).join(\", \");\n  showMessage(`: ${filterSummary}`);\n}\n\n// \nasync function saveCurrentFilterCondition(): Promise<void> {\n  // \n  const columnFilterSettings: ColumnFilterSetting[] = [];\n\n  for (const field of filterPanelFields) {\n    // \n    if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n      columnFilterSettings.push({\n        columnIndex: field.columnIndex,\n        columnName: getColumnName(field.columnIndex),\n        headerText: field.headerText,\n        filterType: \"values\",\n        filterValues: Array.from(field.selectedValues),\n        isFiltered: true\n      });\n\n      appendDebugLog(` - ${field.headerText}: ${field.selectedValues.size}/${field.allValues.length}`);\n    }\n  }\n\n  // \n  if (columnFilterSettings.length === 0) {\n    appendDebugLog(\"\");\n    return;\n  }\n\n  // \n  const filterCondition: FilterCondition = {\n    id: `filter_${Date.now()}`,\n    name: `_${new Date().toLocaleString(\"zh-CN\", { month: \"2-digit\", day: \"2-digit\", hour: \"2-digit\", minute: \"2-digit\" })}`,\n    createTime: new Date().toISOString(),\n    sheetName: currentMainReportConfig?.sheetName || \"\",\n    filterSettings: columnFilterSettings,\n    config: currentMainReportConfig ? { ...currentMainReportConfig } : {\n      dataRange: \"\",\n      headerRow: 1,\n      snColumn: 0,\n      amtColumn: 0,\n      sheetName: \"\"\n    }\n  };\n\n  filterConditionsList.unshift(filterCondition);\n  updateFilterConditionsList();\n  refreshCurrentFilterDisplay();\n\n  const filterCount = columnFilterSettings.length;\n  appendDebugLog(`: ${filterCount} `);\n}\n\n// \nasync function goToMainReport(): Promise<void> {\n  if (!currentMainReportConfig || !currentMainReportConfig.sheetName) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      sheet.activate();\n\n      // \n      const firstCell = sheet.getRange(\"A1\");\n      firstCell.select();\n\n      await context.sync();\n      showMessage(`: ${currentMainReportConfig!.sheetName}`);\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function resetFilterAndGoToMainReport(): Promise<void> {\n  if (!currentMainReportConfig || !currentMainReportConfig.sheetName) {\n    showMessage(\"\", true);\n    return;\n  }\n\n  // \n  currentFilterStatistics = {\n    filteredRowCount: 0,\n    totalAmount: 0,\n    isValid: false\n  };\n\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      const sheet = workbook.worksheets.getItem(currentMainReportConfig!.sheetName);\n      sheet.activate();\n\n      // \n      const usedRange = sheet.getUsedRange();\n      usedRange.load(\"rowCount, rowIndex\");\n      await context.sync();\n\n      // \n      const dataRowCount = usedRange.rowCount - 1;\n      if (dataRowCount > 0) {\n        const startRowNum = usedRange.rowIndex + 2; // \n        const endRowNum = usedRange.rowIndex + usedRange.rowCount;\n        const allDataRows = sheet.getRange(`${startRowNum}:${endRowNum}`);\n        allDataRows.rowHidden = false;\n\n        // \n        allDataRows.format.rowHeight = 20;\n      }\n\n      // \n      const firstCell = sheet.getRange(\"A1\");\n      firstCell.select();\n\n      await context.sync();\n\n      // \n      for (const field of filterPanelFields) {\n        field.selectedValues = new Set<string>(field.allValues);\n      }\n\n      // \n      activeFilterFieldIndex = -1;\n      renderFilterPanel();\n      refreshCurrentFilterDisplay();\n\n      // \n      const filterTextContainer = document.getElementById(\"filter-text-container\");\n      if (filterTextContainer) {\n        filterTextContainer.style.display = \"none\";\n      }\n\n      showMessage(\"\");\n    });\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function generateReport(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      // \n      let sourceSheet: Excel.Worksheet;\n      let usingMainReport = false;\n      if (currentMainReportConfig && currentMainReportConfig.sheetName) {\n        sourceSheet = workbook.worksheets.getItem(currentMainReportConfig.sheetName);\n        usingMainReport = true;\n      } else {\n        sourceSheet = workbook.worksheets.getActiveWorksheet();\n      }\n      sourceSheet.load(\"name\");\n      await context.sync();\n\n      // \n      appendDebugLog(` - : \"${sourceSheet.name}\", : ${usingMainReport}`);\n      if (currentMainReportConfig) {\n        appendDebugLog(`  : sheetName=\"${currentMainReportConfig.sheetName}\"`);\n      }\n\n      // \n      let snColIndex: number | null = null;\n      let amtColIndex: number | null = null;\n      let sourceSheetName: string = \"\"; // \n\n\n      try {\n        const snNamedItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        snNamedItem.load(\"name, formula\");\n        await context.sync();\n\n        //  sync \n        sourceSheetName = sourceSheet.name;\n\n        // 1 NamedItem  Range \n        const snRange = snNamedItem.getRange();\n        snRange.load(\"columnIndex, address, columnCount\");\n        await context.sync();\n        let snColIndexFromRange = snRange.columnIndex;\n\n        // 2\n        const snColumnName = parseColumnFromFormula(snNamedItem.formula);\n        let snColIndexFromFormula: number | null = null;\n        if (snColumnName) {\n          snColIndexFromFormula = getColumnIndexFromName(snColumnName);\n        }\n\n        // \n        snColIndex = snColIndexFromFormula !== null ? snColIndexFromFormula : snColIndexFromRange;\n\n        //  S/N \n        appendDebugLog(`S/N  NamedItem: ${snNamedItem.name}`);\n        appendDebugLog(`  : ${snNamedItem.formula}`);\n        appendDebugLog(`  : ${snRange.address}`);\n        appendDebugLog(`   Range : ${snColIndexFromRange} ( ${getColumnName(snColIndexFromRange)})`);\n        if (snColumnName) {\n          appendDebugLog(`  : ${snColumnName}, : ${snColIndexFromFormula}`);\n        }\n        appendDebugLog(`  : ${snColIndex} ( ${getColumnName(snColIndex)})`);\n      } catch (error) {\n        showMessage(\":  S/N \\\" S/N \\\"\", true);\n        return;\n      }\n\n      try {\n        const amtNamedItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        amtNamedItem.load(\"name, formula\");\n        await context.sync();\n\n        // 1 NamedItem  Range \n        const amtRange = amtNamedItem.getRange();\n        amtRange.load(\"columnIndex, address, columnCount\");\n        await context.sync();\n        let amtColIndexFromRange = amtRange.columnIndex;\n\n        // 2\n        const amtColumnName = parseColumnFromFormula(amtNamedItem.formula);\n        let amtColIndexFromFormula: number | null = null;\n        if (amtColumnName) {\n          amtColIndexFromFormula = getColumnIndexFromName(amtColumnName);\n        }\n\n        // \n        amtColIndex = amtColIndexFromFormula !== null ? amtColIndexFromFormula : amtColIndexFromRange;\n\n        // \n        appendDebugLog(` NamedItem: ${amtNamedItem.name}`);\n        appendDebugLog(`  : ${amtNamedItem.formula}`);\n        appendDebugLog(`  : ${amtRange.address}`);\n        appendDebugLog(`   Range : ${amtColIndexFromRange} ( ${getColumnName(amtColIndexFromRange)})`);\n        if (amtColumnName) {\n          appendDebugLog(`  : ${amtColumnName}, : ${amtColIndexFromFormula}`);\n        }\n        appendDebugLog(`  : ${amtColIndex} ( ${getColumnName(amtColIndex)})`);\n      } catch (error) {\n        showMessage(\": \\\"\\\"\", true);\n        return;\n      }\n\n      //  Excel \n      const usedRange = sourceSheet.getUsedRange();\n      if (!usedRange) {\n        showMessage(\": \", true);\n        return;\n      }\n\n      usedRange.load(\"rowCount, columnCount, address, values, rowIndex\");\n\n      // \n      await context.sync();\n\n      if (usedRange.rowCount === 0 || usedRange.columnCount === 0) {\n        showMessage(\": \", true);\n        return;\n      }\n\n      const rowCount = usedRange.rowCount;\n      const columnCount = usedRange.columnCount;\n\n      // \n      if (!usedRange.values || usedRange.values.length === 0) {\n        showMessage(`:  (: ${rowCount}, : ${columnCount})`, true);\n        return;\n      }\n\n      // \n      clearDebugLog();\n      appendDebugLog(`...`);\n      appendDebugLog(`S/N : ${snColIndex}, : ${amtColIndex}`);\n\n      // \n      if (snColIndex === amtColIndex) {\n        appendDebugLog(`: S/N `);\n      }\n\n      // =====  filterPanelFields =====\n      // \n      const filterEntries: Array<{ colIdx: number; allowedValues: Set<string>; headerText: string }> = [];\n      for (const field of filterPanelFields) {\n        if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n          filterEntries.push({\n            colIdx: field.columnIndex,\n            allowedValues: field.selectedValues,\n            headerText: field.headerText\n          });\n        }\n      }\n\n      appendDebugLog(`: ${filterEntries.length}`);\n      for (const filter of filterEntries) {\n        appendDebugLog(`  ${filter.headerText}: ${filter.allowedValues.size} `);\n      }\n\n      // \n      const filteredRows: any[][] = [];\n\n      //  columnCount \n      const normalizeRow = (rowData: any[]): any[] => {\n        if (!rowData || !Array.isArray(rowData)) {\n          return new Array(columnCount).fill(\"\");\n        }\n        if (rowData.length === columnCount) {\n          return rowData;\n        } else if (rowData.length < columnCount) {\n          return [...rowData, ...new Array(columnCount - rowData.length).fill(\"\")];\n        } else {\n          return rowData.slice(0, columnCount);\n        }\n      };\n\n      // \n      if (usedRange.values.length > 0 && usedRange.values[0]) {\n        filteredRows.push(normalizeRow(usedRange.values[0]));\n      }\n\n      // \n      let visibleRowCount = 0;\n      let hiddenRowCount = 0;\n\n      for (let i = 1; i < usedRange.values.length; i++) {\n        const rowData = usedRange.values[i];\n        if (!rowData || !Array.isArray(rowData)) continue;\n\n        // \n        let shouldInclude = true;\n\n        if (filterEntries.length > 0) {\n          for (const filter of filterEntries) {\n            if (filter.colIdx < rowData.length) {\n              const cellValue = rowData[filter.colIdx];\n              const cellStr = cellValue !== null && cellValue !== undefined ? String(cellValue) : \"\";\n\n              if (!filter.allowedValues.has(cellStr)) {\n                shouldInclude = false;\n                break;\n              }\n            }\n          }\n        }\n\n        if (shouldInclude) {\n          filteredRows.push(normalizeRow(rowData));\n          visibleRowCount++;\n        } else {\n          hiddenRowCount++;\n        }\n      }\n\n      appendDebugLog(`: ${rowCount}, : ${visibleRowCount}, : ${hiddenRowCount}`);\n\n      const filteredCount = filteredRows.length - 1; // \n\n      // \n      if (filteredCount === 0) {\n        showMessage(\"\", true);\n        return;\n      }\n      appendDebugLog(`: ${filteredCount}`);\n\n      //  filteredRows \n      let totalAmount = 0;\n      const amountValues: number[] = []; // \n\n      for (let i = 1; i < filteredRows.length; i++) {\n        const rowData = filteredRows[i];\n        // Excel  = filteredRows  + 1 filteredRows[0] \n        const excelRowNumber = i + 1;\n\n        if (rowData && Array.isArray(rowData) && amtColIndex !== null && amtColIndex >= 0 && amtColIndex < rowData.length) {\n          const amountValue = rowData[amtColIndex];\n\n          //  S/N \n          const snValue = (snColIndex !== null && snColIndex >= 0 && snColIndex < rowData.length) ? rowData[snColIndex] : \"N/A\";\n\n          // \n          if (amountValue !== null && amountValue !== undefined && amountValue !== \"\") {\n            const cleanedAmount = cleanAmount(amountValue);\n            totalAmount += cleanedAmount;\n            amountValues.push(cleanedAmount);\n\n            // \n            const rawValueStr = typeof amountValue === \"string\" ? `\"${amountValue}\"` : String(amountValue);\n\n            //  S/N \n            appendDebugLog(`Row ${excelRowNumber}: SN[${snColIndex}]=${snValue}, [${amtColIndex}]=${rawValueStr} -> Clean=${cleanedAmount.toFixed(2)}`);\n          } else {\n            // \n            appendDebugLog(`Row ${excelRowNumber}: SN[${snColIndex}]=${snValue}, [${amtColIndex}]=`);\n          }\n        } else {\n          appendDebugLog(`Row ${excelRowNumber}:  -  ${amtColIndex}  (: ${rowData ? rowData.length : 0})`);\n        }\n      }\n\n      // \n      appendDebugLog(`---  ---`);\n      appendDebugLog(`: ${totalAmount.toFixed(2)}`);\n      appendDebugLog(`: [${amountValues.map(v => v.toFixed(2)).join(', ')}]`);\n\n      // \n      const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\").slice(0, 19);\n      const newSheetName = `_${timestamp}`;\n      let newSheet: Excel.Worksheet;\n\n      try {\n        newSheet = workbook.worksheets.add(newSheetName);\n      } catch (error) {\n        // \n        let counter = 1;\n        while (true) {\n          try {\n            newSheet = workbook.worksheets.add(`${newSheetName}_${counter}`);\n            break;\n          } catch (e) {\n            counter++;\n          }\n        }\n      }\n\n      // \n      newSheet.load(\"name\");\n\n      // \n      // \\n\n      let currentFilterText = \"\";\n      interface FilterDisplayItem {\n        fieldName: string;\n        values: string;\n      }\n      const filterDisplayItems: FilterDisplayItem[] = [];\n\n      try {\n        // \n        for (const field of filterPanelFields) {\n          // \n          if (field.selectedValues.size < field.allValues.length && field.selectedValues.size > 0) {\n            const selectedValuesArray = Array.from(field.selectedValues);\n\n            // \n            let displayValues: string;\n            if (selectedValuesArray.length <= 5) {\n              displayValues = selectedValuesArray.join(\"; \");\n            } else {\n              displayValues = selectedValuesArray.slice(0, 5).join(\"; \") + `... (${selectedValuesArray.length})`;\n            }\n\n            filterDisplayItems.push({\n              fieldName: field.headerText,\n              values: displayValues\n            });\n            appendDebugLog(` - ${field.headerText}: ${selectedValuesArray.length}/${field.allValues.length}`);\n          }\n        }\n\n        if (filterDisplayItems.length > 0) {\n          // \\n\n          currentFilterText = filterDisplayItems.map(item =>\n            `${item.fieldName}${item.values}`\n          ).join(\"\\n\");\n          appendDebugLog(`: ${currentFilterText}`);\n        } else {\n          appendDebugLog(\"\");\n        }\n      } catch (error) {\n        console.warn(\":\", error);\n        appendDebugLog(`: ${error.message}`);\n      }\n\n      //  Dashboard  4  + \n      const filterRowCount = filterDisplayItems.length > 0 ? filterDisplayItems.length : 1;\n      const dashboardEndRow = 4 + filterRowCount + 1; // +1 for spacing row\n      const dataStartRow = dashboardEndRow + 1;\n\n      //  Dashboard  - \n      const dashboardRange = newSheet.getRange(`A1:E${dashboardEndRow}`);\n      dashboardRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n      dashboardRange.format.horizontalAlignment = Excel.HorizontalAlignment.left;\n      dashboardRange.format.fill.color = \"#F5F5F5\"; // \n      dashboardRange.format.font.name = \"Arial\";\n      dashboardRange.format.font.size = 11;\n      dashboardRange.format.font.color = \"#323130\";\n\n      //  Dashboard 3\n      //  sheet \n      const dashboardBaseData = [\n        [newSheetName, \"\", \"\", \"\", \"\"],\n        [\"\", filteredCount.toString(), \"\", \"\", sourceSheetName],\n        [\"\", totalAmount.toFixed(2), \"\", \"\", new Date().toLocaleString(\"zh-CN\")]\n      ];\n      const dashboardBaseRange = newSheet.getRange(\"A1:E3\");\n      dashboardBaseRange.values = dashboardBaseData;\n\n      //  Dashboard \n      const titleCell = newSheet.getRange(\"A1:E1\");\n      titleCell.merge();\n      titleCell.format.font.size = 14;\n      titleCell.format.font.bold = true;\n      titleCell.format.font.color = \"#0078d4\";\n      titleCell.format.horizontalAlignment = Excel.HorizontalAlignment.center;\n\n      //  Dashboard A\n      const labelRange = newSheet.getRange(\"A2:A3\");\n      labelRange.format.font.bold = true;\n      labelRange.format.font.color = \"#323130\";\n\n      //  Dashboard \n      const dataRangeDashboard = newSheet.getRange(\"B2:B3\");\n      dataRangeDashboard.format.font.color = \"#0078d4\";\n      dataRangeDashboard.format.font.bold = true;\n\n      //  Dashboard \n      const rightLabelRange = newSheet.getRange(\"D2:D3\");\n      rightLabelRange.format.font.bold = true;\n      const rightDataRange = newSheet.getRange(\"E2:E3\");\n      rightDataRange.format.font.color = \"#323130\";\n\n      // \n      const sourceSheetLinkCell = newSheet.getRange(\"E2\");\n      // \n      const configHeaderRow = currentMainReportConfig?.headerRow || 1;\n      const linkAddress = `'${sourceSheetName}'!A${configHeaderRow}`;\n      sourceSheetLinkCell.hyperlink = {\n        address: \"\",\n        documentReference: linkAddress,\n        screenTip: `: ${sourceSheetName}`,\n        textToDisplay: sourceSheetName\n      };\n      sourceSheetLinkCell.format.font.color = \"#0078d4\";\n      sourceSheetLinkCell.format.font.underline = Excel.RangeUnderlineStyle.single;\n\n      // 4\n      // A = \"\"B = C = \n      if (filterDisplayItems.length > 0) {\n        for (let i = 0; i < filterDisplayItems.length; i++) {\n          const rowNum = 4 + i;\n          const item = filterDisplayItems[i];\n\n          // A-E\n          const rowRange = newSheet.getRange(`A${rowNum}:E${rowNum}`);\n          if (i === 0) {\n            rowRange.values = [[\"\", `${item.fieldName}`, item.values, \"\", \"\"]];\n          } else {\n            rowRange.values = [[\"\", `${item.fieldName}`, item.values, \"\", \"\"]];\n          }\n\n          // A \n          const labelCell = newSheet.getRange(`A${rowNum}`);\n          labelCell.format.font.bold = true;\n          labelCell.format.font.color = \"#323130\";\n\n          // B \n          const fieldNameCell = newSheet.getRange(`B${rowNum}`);\n          fieldNameCell.format.font.color = \"#0d47a1\"; // \n          fieldNameCell.format.font.bold = true;\n\n          // C \n          const valueCell = newSheet.getRange(`C${rowNum}`);\n          valueCell.format.font.color = \"#323130\";\n          valueCell.format.wrapText = true;\n        }\n      } else {\n        // \n        const noFilterRow = newSheet.getRange(\"A4:E4\");\n        noFilterRow.values = [[\"\", \"\", \"\", \"\", \"\"]];\n\n        const noFilterLabelCell = newSheet.getRange(\"A4\");\n        noFilterLabelCell.format.font.bold = true;\n        noFilterLabelCell.format.font.color = \"#323130\";\n\n        const noFilterValueCell = newSheet.getRange(\"B4\");\n        noFilterValueCell.format.font.color = \"#a19f9d\";\n        noFilterValueCell.format.font.italic = true;\n      }\n\n      //  Dashboard \n      dashboardRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeTop\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeBottom\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeLeft\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"EdgeRight\").color = \"#D1D1D1\";\n      dashboardRange.format.borders.getItem(\"InsideHorizontal\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"InsideHorizontal\").color = \"#E1E1E1\";\n      dashboardRange.format.borders.getItem(\"InsideVertical\").style = Excel.BorderLineStyle.continuous;\n      dashboardRange.format.borders.getItem(\"InsideVertical\").color = \"#E1E1E1\";\n\n      // \n      await context.sync();\n\n      //  dataStartRow - \n      if (filteredRows.length > 0) {\n        const lastColumnName = getColumnName(columnCount - 1);\n\n        // \n        appendDebugLog(`...`);\n        appendDebugLog(`: A${dataStartRow}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n        appendDebugLog(`filteredRows.length = ${filteredRows.length}`);\n        appendDebugLog(`columnCount = ${columnCount}`);\n\n        // \n        for (let i = 0; i < filteredRows.length; i++) {\n          const rowLen = filteredRows[i] ? filteredRows[i].length : 0;\n          if (rowLen !== columnCount) {\n            appendDebugLog(`:  ${i}  (${rowLen})  columnCount (${columnCount}) `);\n          }\n        }\n\n        // \n        const targetRowCount = filteredRows.length;\n        const targetColCount = columnCount;\n        appendDebugLog(`: ${targetRowCount}  x ${targetColCount} `);\n\n        const dataRange = newSheet.getRange(`A${dataStartRow}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n\n        try {\n          dataRange.values = filteredRows;\n        } catch (writeError) {\n          appendDebugLog(`: ${writeError.message}`);\n          // \n          appendDebugLog(`: ${JSON.stringify(filteredRows[0])}`);\n          if (filteredRows.length > 1) {\n            appendDebugLog(`: ${JSON.stringify(filteredRows[1])}`);\n          }\n          throw writeError;\n        }\n\n        // \n        dataRange.format.font.name = \"Arial\";\n        dataRange.format.font.size = 11;\n        dataRange.format.font.color = \"#323130\";\n        dataRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n        dataRange.format.horizontalAlignment = Excel.HorizontalAlignment.left;\n\n        // dataStartRow\n        const headerRange = newSheet.getRange(`A${dataStartRow}:${lastColumnName}${dataStartRow}`);\n        headerRange.format.fill.color = \"#0078d4\"; // \n        headerRange.format.font.bold = true;\n        headerRange.format.font.color = \"#FFFFFF\"; // \n        headerRange.format.font.size = 11;\n        headerRange.format.font.name = \"Arial\";\n        headerRange.format.horizontalAlignment = Excel.HorizontalAlignment.center;\n        headerRange.format.verticalAlignment = Excel.VerticalAlignment.center;\n\n        // \n        headerRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeTop\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeBottom\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeLeft\").color = \"#005a9e\";\n        headerRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n        headerRange.format.borders.getItem(\"EdgeRight\").color = \"#005a9e\";\n\n        // dataStartRow+1\n        if (filteredRows.length > 1) {\n          const dataRowsRange = newSheet.getRange(`A${dataStartRow + 1}:${lastColumnName}${dataStartRow + filteredRows.length - 1}`);\n\n          // \n          dataRowsRange.format.borders.getItem(\"EdgeTop\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeTop\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeBottom\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeBottom\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeLeft\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeLeft\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"EdgeRight\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"EdgeRight\").color = \"#E1E1E1\";\n          dataRowsRange.format.borders.getItem(\"InsideHorizontal\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"InsideHorizontal\").color = \"#F0F0F0\";\n          dataRowsRange.format.borders.getItem(\"InsideVertical\").style = Excel.BorderLineStyle.continuous;\n          dataRowsRange.format.borders.getItem(\"InsideVertical\").color = \"#F0F0F0\";\n\n          // \n          const dataRowStart = dataStartRow + 1;\n          for (let i = dataRowStart; i <= dataStartRow + filteredRows.length - 1; i++) {\n            const rowRange = newSheet.getRange(`A${i}:${lastColumnName}${i}`);\n            if ((i - dataRowStart) % 2 === 0) {\n              // \n              rowRange.format.fill.color = \"#FAFAFA\";\n            } else {\n              // \n              rowRange.format.fill.color = \"#FFFFFF\";\n            }\n          }\n        }\n      }\n\n      // \n      const usedRangeNew = newSheet.getUsedRange();\n      usedRangeNew.format.autofitColumns();\n\n      // \n      const allRowsRange = newSheet.getUsedRange();\n      allRowsRange.format.rowHeight = 20; // \n\n      // Dashboard \n      const dashboardRows = newSheet.getRange(`1:${dashboardEndRow}`);\n      dashboardRows.format.rowHeight = 22;\n\n      // \n      newSheet.activate();\n\n      await context.sync();\n\n      //  newSheet.name \n      addReportToList(newSheet.name, filteredCount, totalAmount);\n\n      // \n      await saveCurrentFilterCondition();\n\n      showMessage(` ${filteredCount} : ${totalAmount.toFixed(2)}`);\n    });\n\n    // \n    updateFilterTextDisplay();\n    await copyFilterTextToClipboard();\n\n  } catch (error) {\n    console.error(\":\", error);\n    showMessage(`: ${error.message}`, true);\n  }\n}\n\n// \nasync function loadMainReportConfig(): Promise<void> {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n\n      // \n      try {\n        const dataRangeItem = workbook.names.getItem(CFG_DATA_RANGE_NAME);\n        dataRangeItem.load(\"formula\");\n        await context.sync();\n\n        const rangeMatch = dataRangeItem.formula.match(/=([^!]+)!([^$]+)/);\n        if (rangeMatch) {\n          if (!currentMainReportConfig) {\n            currentMainReportConfig = {\n              dataRange: dataRangeItem.formula.replace(/^=/, \"\"),\n              headerRow: 0,\n              snColumn: 0,\n              amtColumn: 0,\n              sheetName: rangeMatch[1]\n            };\n          } else {\n            currentMainReportConfig.dataRange = dataRangeItem.formula.replace(/^=/, \"\");\n            currentMainReportConfig.sheetName = rangeMatch[1];\n          }\n        }\n      } catch (error) {\n        // \n      }\n\n      // \n      try {\n        const headerRowItem = workbook.names.getItem(CFG_HEADER_ROW_NAME);\n        headerRowItem.load(\"formula\");\n        await context.sync();\n\n        const rowMatch = headerRowItem.formula.match(/:(\\d+):/);\n        if (rowMatch && currentMainReportConfig) {\n          currentMainReportConfig.headerRow = parseInt(rowMatch[1]);\n        }\n      } catch (error) {\n        // \n      }\n\n      //  S/N \n      try {\n        const snItem = workbook.names.getItem(CFG_SN_COL_NAME);\n        const snRange = snItem.getRange();\n        snRange.load(\"columnIndex\");\n        await context.sync();\n\n        if (currentMainReportConfig) {\n          currentMainReportConfig.snColumn = snRange.columnIndex;\n        }\n      } catch (error) {\n        // S/N \n      }\n\n      // \n      try {\n        const amtItem = workbook.names.getItem(CFG_AMT_COL_NAME);\n        const amtRange = amtItem.getRange();\n        amtRange.load(\"columnIndex\");\n        await context.sync();\n\n        if (currentMainReportConfig) {\n          currentMainReportConfig.amtColumn = amtRange.columnIndex;\n        }\n      } catch (error) {\n        // \n      }\n    });\n  } catch (error) {\n    console.error(\":\", error);\n  }\n}\n\n// \nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    // \n    document.getElementById(\"btn-set-data-range\")?.addEventListener(\"click\", () => {\n      setDataRange();\n    });\n\n    document.getElementById(\"btn-set-header-row\")?.addEventListener(\"click\", () => {\n      setHeaderRow();\n    });\n\n    document.getElementById(\"btn-set-sn\")?.addEventListener(\"click\", () => {\n      setSnColumnWithMergeCheck();\n    });\n\n    document.getElementById(\"btn-set-amt\")?.addEventListener(\"click\", () => {\n      setColumnConfig(CFG_AMT_COL_NAME, \"\");\n    });\n\n    document.getElementById(\"btn-enable-filter\")?.addEventListener(\"click\", () => {\n      enableFilter();\n    });\n\n    document.getElementById(\"btn-generate\")?.addEventListener(\"click\", () => {\n      generateReport();\n    });\n\n    // \n    document.getElementById(\"btn-apply-filter\")?.addEventListener(\"click\", () => {\n      applyFilterFromPanel();\n    });\n\n    document.getElementById(\"btn-clear-filter\")?.addEventListener(\"click\", () => {\n      clearFilterFromPanel();\n    });\n\n    document.getElementById(\"btn-save-filter\")?.addEventListener(\"click\", () => {\n      saveFilterFromPanel();\n    });\n\n    // \n    document.getElementById(\"btn-reset-filter\")?.addEventListener(\"click\", () => {\n      resetFilterAndGoToMainReport();\n    });\n\n    // \n    document.getElementById(\"data-range-info\")?.addEventListener(\"click\", () => {\n      goToMainReport();\n    });\n\n    // \n    bindFilterPanelEvents();\n\n    // \n    bindFilterTextEvents();\n\n    // \n    loadMainReportConfig().then(() => {\n      updateMainReportConfigDisplay();\n      updateReportsTable();\n      updateFilterConditionsList();\n    });\n\n    console.log(\"Excel Add-in \");\n  }\n});\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title></title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-Fabric ms-font-m\\\"> <div class=\\\"ms-Grid\\\" dir=\\\"ltr\\\"> <main class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <header class=\\\"app-header\\\"> <div class=\\\"header-content\\\"> <i class=\\\"ms-Icon ms-Icon--ExcelDocument header-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-l ms-fontWeight-semibold header-title\\\"></span> </div> </header> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--Settings section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <p class=\\\"ms-font-s section-hint\\\"></p> <div class=\\\"config-steps\\\"> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">1.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-data-range\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Table\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"data-range-info\\\" class=\\\"step-value clickable ms-font-s\\\" title=\\\"\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">2.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-header-row\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Header\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"header-row-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">3.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\">S/N </span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-sn\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--NumberField\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"> S/N </span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"sn-col-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> <div class=\\\"config-step ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm4 step-label-col\\\"> <span class=\\\"ms-font-s ms-fontWeight-semibold step-number\\\">4.</span> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <button id=\\\"btn-set-amt\\\" class=\\\"ms-Button ms-Button--small\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Money\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> <div class=\\\"ms-Grid-col ms-sm4\\\"> <span id=\\\"amt-col-info\\\" class=\\\"step-value ms-font-s\\\"></span> </div> </div> </div> <div class=\\\"config-actions\\\"> <button id=\\\"btn-enable-filter\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--FilterSolid\\\" aria-hidden=\\\"true\\\"></i></span> <span class=\\\"ms-Button-label\\\"></span> </button> </div> </div> </section> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--Filter section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <div id=\\\"filter-panel\\\" class=\\\"filter-panel\\\"> <div class=\\\"filter-panel-hint ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--Info\\\" aria-hidden=\\\"true\\\"></i> \\\"\\\" </div> </div> <div class=\\\"filter-actions\\\"> <button id=\\\"btn-reset-filter\\\" class=\\\"ms-Button ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Refresh\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-apply-filter\\\" class=\\\"ms-Button ms-Button--primary ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Filter\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-generate\\\" class=\\\"ms-Button ms-Button--icon btn-success\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--DocumentSet\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-save-filter\\\" class=\\\"ms-Button ms-Button--icon\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Save\\\" aria-hidden=\\\"true\\\"></i></span> </button> <button id=\\\"btn-clear-filter\\\" class=\\\"ms-Button ms-Button--icon btn-danger\\\" title=\\\"\\\" disabled=\\\"disabled\\\"> <span class=\\\"ms-Button-icon\\\"><i class=\\\"ms-Icon ms-Icon--Cancel\\\" aria-hidden=\\\"true\\\"></i></span> </button> </div> <div id=\\\"current-filter-display\\\" class=\\\"current-filter-display\\\"> <div class=\\\"no-filters ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--Info\\\" aria-hidden=\\\"true\\\"></i>  </div> </div> <div class=\\\"subsection-header\\\"> <i class=\\\"ms-Icon ms-Icon--FavoriteList\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> </div> <div id=\\\"filter-conditions-list\\\" class=\\\"filter-conditions-list\\\"> <div class=\\\"no-filters ms-font-s\\\"></div> </div> </div> </section> <section class=\\\"ms-Grid-row section-card\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"section-header\\\"> <i class=\\\"ms-Icon ms-Icon--ReportDocument section-icon\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-m-plus ms-fontWeight-semibold\\\"></span> </div> <div class=\\\"ms-Table\\\" id=\\\"reports-table-container\\\"> <table id=\\\"reports-table\\\" class=\\\"reports-table\\\"> <thead> <tr> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> <th class=\\\"ms-font-s ms-fontWeight-semibold\\\"></th> </tr> </thead> <tbody id=\\\"reports-table-body\\\"> <tr> <td colspan=\\\"3\\\" class=\\\"no-reports ms-font-s\\\"> <i class=\\\"ms-Icon ms-Icon--DocumentSearch\\\" aria-hidden=\\\"true\\\"></i>  </td> </tr> </tbody> </table> </div> </div> </section> <div id=\\\"message-area\\\" class=\\\"message-area ms-font-s\\\"></div> <div id=\\\"filter-text-container\\\" class=\\\"filter-text-container\\\" style=\\\"display:none\\\"> <div class=\\\"filter-text-header\\\"> <i class=\\\"ms-Icon ms-Icon--Copy\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"ms-font-s ms-fontWeight-semibold\\\"></span> <span id=\\\"copy-success-hint\\\" class=\\\"copy-success-hint ms-font-xs\\\">!</span> </div> <div id=\\\"filter-text-content\\\" class=\\\"filter-text-content ms-font-s\\\" title=\\\"\\\"></div> </div> <div id=\\\"debug-log\\\" class=\\\"debug-log ms-font-xs\\\"></div> </div> </main> </div> <div id=\\\"confirm-dialog\\\" class=\\\"ms-Dialog confirm-dialog-overlay\\\"> <div class=\\\"ms-Dialog-main confirm-dialog\\\"> <div class=\\\"ms-Dialog-header confirm-dialog-header\\\"> <p class=\\\"ms-Dialog-title ms-font-l ms-fontWeight-semibold\\\"> <i class=\\\"ms-Icon ms-Icon--Warning\\\" aria-hidden=\\\"true\\\"></i>  </p> </div> <div class=\\\"ms-Dialog-inner\\\"> <div class=\\\"ms-Dialog-content confirm-dialog-body\\\"> <p id=\\\"confirm-dialog-message\\\" class=\\\"ms-font-m\\\"></p> </div> <div class=\\\"ms-Dialog-actions confirm-dialog-footer\\\"> <button id=\\\"confirm-dialog-cancel\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\"></span> </button> <button id=\\\"confirm-dialog-ok\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\"></span> </button> </div> </div> </div> </div> <div id=\\\"progress-overlay\\\" class=\\\"ms-Dialog progress-overlay\\\"> <div class=\\\"ms-Dialog-main progress-dialog\\\"> <div class=\\\"ms-Dialog-header progress-header\\\"> <i class=\\\"ms-Icon ms-Icon--Processing spinning-icon\\\" aria-hidden=\\\"true\\\"></i> <span id=\\\"progress-title\\\" class=\\\"ms-font-l ms-fontWeight-semibold\\\">...</span> </div> <div class=\\\"ms-Dialog-inner progress-body\\\"> <p id=\\\"progress-message\\\" class=\\\"ms-font-m\\\">...</p> <div class=\\\"progress-bar-container\\\"> <div id=\\\"progress-bar\\\" class=\\\"progress-bar\\\"></div> </div> <p id=\\\"progress-detail\\\" class=\\\"progress-detail ms-font-s\\\">0 / 0</p> </div> </div> </div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CFG_SN_COL_NAME","CFG_AMT_COL_NAME","CFG_DATA_RANGE_NAME","CFG_HEADER_ROW_NAME","getColumnName","columnIndex","result","index","String","fromCharCode","Math","floor","getColumnIndexFromName","columnName","charCodeAt","parseColumnFromFormula","formula","match","reportsList","filterConditionsList","currentMainReportConfig","filterPanelFields","currentFilterStatistics","filteredRowCount","totalAmount","isValid","showMessage","message","isError","messageArea","getElementById","textContent","className","console","log","showProgress","title","overlay","titleEl","messageEl","barEl","detailEl","style","width","classList","add","updateProgress","current","total","detail","percent","round","concat","hideProgress","remove","appendDebugLog","debugLog","logEntry","createElement","marginBottom","appendChild","scrollTop","scrollHeight","generateFilterText","filterItems","push","toFixed","hasFilter","_i","_filterPanelFields","field","selectedValues","size","allValues","valuesArray","Array","from","valuesText","slice","join","headerText","updateFilterTextDisplay","autoHide","container","content","filterText","display","htmlContent","split","map","line","trim","startsWith","innerHTML","copyFilterTextToClipboard","_copyFilterTextToClipboard","_callee2","textArea","_t","_t2","_context2","navigator","clipboard","writeText","showCopySuccessHint","error","position","left","body","select","execCommand","removeChild","hint","setTimeout","clearDebugLog","cleanAmount","isNaN","str","isNegative","substring","dotIndex","indexOf","num","parseFloat","_setDataRange","_callee4","_t5","_context4","Excel","run","_ref2","_callee3","context","sheet","selection","address","parts","startRow","startCol","endRow","endCol","startColName","endColName","currentSheetName","sheetNameEscaped","fullAddress","namedItems","existingItem","debugInfo","errorMsg","_t3","_t4","_context3","workbook","worksheets","getActiveWorksheet","load","getSelectedRange","sync","includes","rowIndex","rowCount","columnCount","name","names","getItem","delete","code","JSON","stringify","getOwnPropertyNames","dataRange","sheetName","headerRow","snColumn","amtColumn","updateMainReportConfigDisplay","_x15","_setHeaderRow","_callee6","_t8","_context6","_ref3","_callee5","rowAddress","_t6","_t7","_context5","_x16","_setColumnConfig","_callee8","_t1","_context8","_ref4","_callee7","columnNameStr","cellAddress","_t9","_t0","_context7","_x17","_setSnColumnWithMergeCheck","_callee0","_t13","_context1","_ref5","_callee9","usedRange","totalColumns","columnRange","values","mergedCellInfos","mergedAreas","areas","j","_j","_area","currentValue","consecutiveEmpty","k","nextValue","cellRowIndex","mergeRowCount","endRowIndex","_iterator5","_step5","info","sortedInfos","deletedRows","totalInfos","minRow","maxRow","_iterator6","_step6","_info2","allDataRange","allData","mergeResults","idx","_info","rowsToMerge","firstRowIndex","dataOffset","mergedValues","rowOffset","currentDataOffset","currentRowValues","col","firstVal","currentVal","BATCH_SIZE","batchStart","batchEnd","batchResults","_iterator7","_step7","_loop","_iterator8","_step8","firstRowRange","_iterator9","_step9","_result","_i5","columnAddress","mergeInfo","_t10","_t11","_context0","getUsedRange","getRangeByIndexes","getMergedAreasOrNullObject","isNullObject","areaCount","items","area","showConfirmDialog","_createForOfIteratorHelper","s","getRange","format","fill","color","err","sort","Infinity","min","max","rowsToDelete","_context9","find","unmerge","_regeneratorValues","wrapText","DeleteShiftDirection","up","_x18","dataRangeEl","headerRowEl","snColEl","colName","amtColEl","enableFilterBtn","isConfigComplete","disabled","updateReportsTable","_currentMainReportCon","tbody","html","report","createTime","Date","toLocaleString","month","day","hour","minute","querySelectorAll","forEach","link","addEventListener","goToMainReport","span","target","getAttribute","_x5","_navigateToSheet","navigateToSheet","_displaySpan$parentEl","displaySpan","querySelector","editContainer","parentElement","input","focus","startEditReportName","parseInt","keyEvent","key","_x3","_x4","_confirmEditReportName","confirmEditReportName","cancelEditReportName","button","btn","currentTarget","_x6","_x7","_deleteReport","deleteReport","_displaySpan$parentEl2","_callee12","newName","oldName","_t17","_context13","_ref7","_callee11","_context12","_x20","_callee14","_context15","_ref8","_callee13","_context14","activate","_x21","okButton","cancelButton","cleanup","removeEventListener","onOk","onCancel","_callee16","_t20","_context17","_ref9","_callee15","_context16","splice","_x22","addReportToList","toISOString","unshift","updateFilterConditionsList","filter","filterSummary","filterSettings","_displaySpan$parentEl3","startEditFilterName","cancelEditFilterName","confirmEditFilterName","_x8","_x9","_applyFilterCondition","applyFilterCondition","_displaySpan$parentEl4","_callee18","filterCondition","_t22","_context20","_ref0","_callee17","_loop2","colIdx","applyBtn","clearBtn","saveBtn","generateBtn","resetBtn","excelRow","filterEntries","_i6","_filterPanelFields4","hiddenCount","visibleCount","valueIdx","rowData","excelRowNum","shouldHide","_iterator0","_step0","cellValue","cellStr","_t21","_context19","config","rowIdx","_cellValue","valueStr","sortedValues","savedFilter","_context18","Set","localeCompare","isFiltered","filterValues","has","isTimeField","timeDimension","renderFilterPanel","rowHidden","allowedValues","updateCurrentFilterDisplay","filterType","_x23","activeFilters","filterItemsHtml","totalCount","displayValues","remainingCount","filterId","refreshCurrentFilterDisplay","columnFilterSettings","_i2","_filterPanelFields2","selectedValuesArray","_enableFilter","_callee20","_t23","_context22","_ref1","_callee19","_currentMainReportCon3","_currentMainReportCon4","activeSheet","_context21","_x24","expandFilterValues","_filterIndex","collapsedEl","expandedEl","collapseFilterValues","activeFilterFieldIndex","panel","tagsHtml","selectedCount","tagClass","escapeHtml","dropdownHtml","fieldId","timeDimensionHtml","timeValues","isSelected","displayValue","text","div","_toggleTimeField","_callee21","fieldIndex","_context23","checkTimeFieldFormat","_x1","_checkTimeFieldFormat","_callee23","_t24","_context25","_ref10","_callee22","colIndex","standardCount","nonStandardCount","nonStandardRows","nonStandardValues","examples","confirmMsg","_context24","isStandardDateFormat","calculateTimeValues","confirm","convertTimeFormat","_x25","_i3","_standardPatterns","date","getTime","_x10","_x11","_x12","_x13","_convertTimeFormat","_callee24","convertedCount","converted","cell","_context26","tryConvertToDate","font","recalculateTimeValues","dmyMatch","_dmyMatch","_slicedToArray","year","padStart","cnMatch","_cnMatch","enMatch","toLowerCase","_enMatch","monthStr","getFullYear","getMonth","getDate","years","months","days","dateInfo","extractDateInfo","yearMonth","excelDate","excelEpoch","_x14","_recalculateTimeValues","_callee26","_t25","_context28","_ref11","_callee25","_context27","_x26","filterPanelEventsBound","updateTagCount","tag","toggle","countSpan","_applyFilterFromPanel","_callee28","_t27","_context30","_ref12","_callee27","_currentMainReportCon5","_currentMainReportCon6","targetSheet","_iterator1","_step1","rowVisibility","amtColIndex","shouldShow","_iterator10","_step10","amountValue","allDataRowsStart","allDataRowsEnd","hiddenRangeCount","endIdx","rangeStartRow","rangeEndRow","_t26","_context29","rowHeight","count","_x27","_clearFilterFromPanel","_callee30","_iterator11","_step11","_t28","_context32","_ref13","_callee29","startRowNum","endRowNum","allDataRows","filterTextContainer","_context31","_x28","saveCurrentFilterCondition","_saveCurrentFilterCondition","_callee31","_currentMainReportCon7","_iterator12","_step12","filterCount","_context33","id","now","_objectSpread","_goToMainReport","_callee33","_t29","_context35","_ref14","_callee32","_context34","_x29","_resetFilterAndGoToMainReport","_callee35","_t30","_context37","_ref15","_callee34","_iterator13","_step13","_context36","_x30","_generateReport","_callee37","_t37","_context39","_ref16","_callee36","_currentMainReportCon8","sourceSheet","usingMainReport","snColIndex","sourceSheetName","snNamedItem","snRange","snColIndexFromRange","snColumnName","snColIndexFromFormula","amtNamedItem","amtRange","amtColIndexFromRange","amtColumnName","amtColIndexFromFormula","_iterator14","_step14","_field3","_i7","_filterEntries","filteredRows","normalizeRow","visibleRowCount","hiddenRowCount","shouldInclude","_iterator15","_step15","_filter","filteredCount","amountValues","_i8","_rowData","excelRowNumber","snValue","cleanedAmount","rawValueStr","timestamp","newSheetName","newSheet","counter","currentFilterText","filterDisplayItems","_iterator16","_step16","filterRowCount","dashboardEndRow","dataStartRow","dashboardRange","dashboardBaseData","titleCell","labelRange","dataRangeDashboard","sourceSheetLinkCell","configHeaderRow","linkAddress","_i9","rowNum","item","labelCell","fieldNameCell","valueCell","noFilterLabelCell","noFilterValueCell","lastColumnName","_i0","rowLen","targetRowCount","targetColCount","headerRange","dataRowsRange","dataRowStart","_i1","_t33","_t36","_context38","isArray","_toConsumableArray","fieldName","warn","verticalAlignment","VerticalAlignment","center","horizontalAlignment","HorizontalAlignment","toString","merge","bold","hyperlink","documentReference","screenTip","textToDisplay","underline","RangeUnderlineStyle","single","italic","borders","BorderLineStyle","continuous","autofitColumns","_x31","_loadMainReportConfig","_callee39","_t42","_context41","_ref17","_callee38","dataRangeItem","rangeMatch","headerRowItem","rowMatch","snItem","amtItem","_context40","_x32","Office","onReady","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB0","_document$getElementB1","host","HostType","setDataRange","setHeaderRow","setSnColumnWithMergeCheck","_x","_x2","setColumnConfig","enableFilter","generateReport","applyFilterFromPanel","clearFilterFromPanel","_currentMainReportCon2","_i4","_filterPanelFields3","saveFilterFromPanel","resetFilterAndGoToMainReport","contains","preventDefault","stopPropagation","_x0","toggleTimeField","tagElement","closest","actionButton","action","searchInput","searchText","isSearchMode","optionsContainer","visibleValues","option","valueIndexStr","valueIndex","_step","_iterator","_step2","_iterator2","_step3","_iterator3","_step4","newSelected","_iterator4","options","checkbox","checked","updateFieldOptions","optionDiv","newChecked","actionsContainer","searchHint","searchLower","hasSearchText","matches","hintSpan","filterSearchOptions","type","dimension","getDimensionLabel","changeTimeDimension","_callee","_context","loadMainReportConfig","URL"],"ignoreList":[],"sourceRoot":""}